var config=jivo_config=window.parent.window.jivo_config;(function(e,t){var i,n,o=typeof t,a=e.location,s=e.document,r=s.documentElement,l=e.jQuery,c=e.$,d={},u=[],f="1.10.2",h=u.concat,g=u.push,p=u.slice,m=u.indexOf,v=d.toString,_=d.hasOwnProperty,w=f.trim,b=function(e,t){return new b.fn.init(e,t,n)},y=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,C=/\S+/g,j=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,x=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,E=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,k=/^[\],:{}\s]*$/,T=/(?:^|:|,)(?:\s*\[)+/g,I=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,S=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,M=/^-ms-/,N=/-([\da-z])/gi,A=function(e,t){return t.toUpperCase()},O=function(e){if(s.addEventListener||e.type==="load"||s.readyState==="complete"){L();b.ready()}},L=function(){if(s.addEventListener){s.removeEventListener("DOMContentLoaded",O,false);e.removeEventListener("load",O,false)}else{s.detachEvent("onreadystatechange",O);e.detachEvent("onload",O)}};b.fn=b.prototype={jquery:f,constructor:b,init:function(e,i,n){var o,a;if(!e){return this}if(typeof e==="string"){if(e.charAt(0)==="<"&&e.charAt(e.length-1)===">"&&e.length>=3){o=[null,e,null]}else{o=x.exec(e)}if(o&&(o[1]||!i)){if(o[1]){i=i instanceof b?i[0]:i;b.merge(this,b.parseHTML(o[1],i&&i.nodeType?i.ownerDocument||i:s,true));if(E.test(o[1])&&b.isPlainObject(i)){for(o in i){if(b.isFunction(this[o])){this[o](i[o])}else{this.attr(o,i[o])}}}return this}else{a=s.getElementById(o[2]);if(a&&a.parentNode){if(a.id!==o[2]){return n.find(e)}this.length=1;this[0]=a}this.context=s;this.selector=e;return this}}else if(!i||i.jquery){return(i||n).find(e)}else{return this.constructor(i).find(e)}}else if(e.nodeType){this.context=this[0]=e;this.length=1;return this}else if(b.isFunction(e)){return n.ready(e)}if(e.selector!==t){this.selector=e.selector;this.context=e.context}return b.makeArray(e,this)},selector:"",length:0,toArray:function(){return p.call(this)},get:function(e){return e==null?this.toArray():e<0?this[this.length+e]:this[e]},pushStack:function(e){var t=b.merge(this.constructor(),e);t.prevObject=this;t.context=this.context;return t},each:function(e,t){return b.each(this,e,t)},ready:function(e){b.ready.promise().done(e);return this},slice:function(){return this.pushStack(p.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(e<0?t:0);return this.pushStack(i>=0&&i<t?[this[i]]:[])},map:function(e){return this.pushStack(b.map(this,function(t,i){return e.call(t,i,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:g,sort:[].sort,splice:[].splice};b.fn.init.prototype=b.fn;b.extend=b.fn.extend=function(){var e,i,n,o,a,s,r=arguments[0]||{},l=1,c=arguments.length,d=false;if(typeof r==="boolean"){d=r;r=arguments[1]||{};l=2}if(typeof r!=="object"&&!b.isFunction(r)){r={}}if(c===l){r=this;--l}for(;l<c;l++){if((a=arguments[l])!=null){for(o in a){e=r[o];n=a[o];if(r===n){continue}if(d&&n&&(b.isPlainObject(n)||(i=b.isArray(n)))){if(i){i=false;s=e&&b.isArray(e)?e:[]}else{s=e&&b.isPlainObject(e)?e:{}}r[o]=b.extend(d,s,n)}else if(n!==t){r[o]=n}}}}return r};b.extend({expando:"jQuery"+(f+Math.random()).replace(/\D/g,""),noConflict:function(t){if(e.$===b){e.$=c}if(t&&e.jQuery===b){e.jQuery=l}return b},isReady:false,readyWait:1,holdReady:function(e){if(e){b.readyWait++}else{b.ready(true)}},ready:function(e){if(e===true?--b.readyWait:b.isReady){return}if(!s.body){return setTimeout(b.ready)}b.isReady=true;if(e!==true&&--b.readyWait>0){return}i.resolveWith(s,[b]);if(b.fn.trigger){b(s).trigger("ready").off("ready")}},isFunction:function(e){return b.type(e)==="function"},isArray:Array.isArray||function(e){return b.type(e)==="array"},isWindow:function(e){return e!=null&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){if(e==null){return String(e)}return typeof e==="object"||typeof e==="function"?d[v.call(e)]||"object":typeof e},isPlainObject:function(e){var i;if(!e||b.type(e)!=="object"||e.nodeType||b.isWindow(e)){return false}try{if(e.constructor&&!_.call(e,"constructor")&&!_.call(e.constructor.prototype,"isPrototypeOf")){return false}}catch(n){return false}if(b.support.ownLast){for(i in e){return _.call(e,i)}}for(i in e){}return i===t||_.call(e,i)},isEmptyObject:function(e){var t;for(t in e){return false}return true},error:function(e){throw new Error(e)},parseHTML:function(e,t,i){if(!e||typeof e!=="string"){return null}if(typeof t==="boolean"){i=t;t=false}t=t||s;var n=E.exec(e),o=!i&&[];if(n){return[t.createElement(n[1])]}n=b.buildFragment([e],t,o);if(o){b(o).remove()}return b.merge([],n.childNodes)},parseJSON:function(t){if(e.JSON&&e.JSON.parse){return e.JSON.parse(t)}if(t===null){return t}if(typeof t==="string"){t=b.trim(t);if(t){if(k.test(t.replace(I,"@").replace(S,"]").replace(T,""))){return new Function("return "+t)()}}}b.error("Invalid JSON: "+t)},parseXML:function(i){var n,o;if(!i||typeof i!=="string"){return null}try{if(e.DOMParser){o=new DOMParser;n=o.parseFromString(i,"text/xml")}else{n=new ActiveXObject("Microsoft.XMLDOM");n.async="false";n.loadXML(i)}}catch(a){n=t}if(!n||!n.documentElement||n.getElementsByTagName("parsererror").length){b.error("Invalid XML: "+i)}return n},noop:function(){},globalEval:function(t){if(t&&b.trim(t)){(e.execScript||function(t){e["eval"].call(e,t)})(t)}},camelCase:function(e){return e.replace(M,"ms-").replace(N,A)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,i){var n,o=0,a=e.length,s=D(e);if(i){if(s){for(;o<a;o++){n=t.apply(e[o],i);if(n===false){break}}}else{for(o in e){n=t.apply(e[o],i);if(n===false){break}}}}else{if(s){for(;o<a;o++){n=t.call(e[o],o,e[o]);if(n===false){break}}}else{for(o in e){n=t.call(e[o],o,e[o]);if(n===false){break}}}}return e},trim:w&&!w.call("﻿ ")?function(e){return e==null?"":w.call(e)}:function(e){return e==null?"":(e+"").replace(j,"")},makeArray:function(e,t){var i=t||[];if(e!=null){if(D(Object(e))){b.merge(i,typeof e==="string"?[e]:e)}else{g.call(i,e)}}return i},inArray:function(e,t,i){var n;if(t){if(m){return m.call(t,e,i)}n=t.length;i=i?i<0?Math.max(0,n+i):i:0;for(;i<n;i++){if(i in t&&t[i]===e){return i}}}return-1},merge:function(e,i){var n=i.length,o=e.length,a=0;if(typeof n==="number"){for(;a<n;a++){e[o++]=i[a]}}else{while(i[a]!==t){e[o++]=i[a++]}}e.length=o;return e},grep:function(e,t,i){var n,o=[],a=0,s=e.length;i=!!i;for(;a<s;a++){n=!!t(e[a],a);if(i!==n){o.push(e[a])}}return o},map:function(e,t,i){var n,o=0,a=e.length,s=D(e),r=[];if(s){for(;o<a;o++){n=t(e[o],o,i);if(n!=null){r[r.length]=n}}}else{for(o in e){n=t(e[o],o,i);if(n!=null){r[r.length]=n}}}return h.apply([],r)},guid:1,proxy:function(e,i){var n,o,a;if(typeof i==="string"){a=e[i];i=e;e=a}if(!b.isFunction(e)){return t}n=p.call(arguments,2);o=function(){return e.apply(i||this,n.concat(p.call(arguments)))};o.guid=e.guid=e.guid||b.guid++;return o},access:function(e,i,n,o,a,s,r){var l=0,c=e.length,d=n==null;if(b.type(n)==="object"){a=true;for(l in n){b.access(e,i,l,n[l],true,s,r)}}else if(o!==t){a=true;if(!b.isFunction(o)){r=true}if(d){if(r){i.call(e,o);i=null}else{d=i;i=function(e,t,i){return d.call(b(e),i)}}}if(i){for(;l<c;l++){i(e[l],n,r?o:o.call(e[l],l,i(e[l],n)))}}}return a?e:d?i.call(e):c?i(e[0],n):s},now:function(){return(new Date).getTime()},swap:function(e,t,i,n){var o,a,s={};for(a in t){s[a]=e.style[a];e.style[a]=t[a]}o=i.apply(e,n||[]);for(a in t){e.style[a]=s[a]}return o}});b.ready.promise=function(t){if(!i){i=b.Deferred();if(s.readyState==="complete"){setTimeout(b.ready)}else if(s.addEventListener){s.addEventListener("DOMContentLoaded",O,false);e.addEventListener("load",O,false)}else{s.attachEvent("onreadystatechange",O);e.attachEvent("onload",O);var n=false;try{n=e.frameElement==null&&s.documentElement}catch(o){}if(n&&n.doScroll){(function a(){if(!b.isReady){try{n.doScroll("left")}catch(e){return setTimeout(a,50)}L();b.ready()}})()}}}return i.promise(t)};b.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){d["[object "+t+"]"]=t.toLowerCase()});function D(e){var t=e.length,i=b.type(e);if(b.isWindow(e)){return false}if(e.nodeType===1&&t){return true}return i==="array"||i!=="function"&&(t===0||typeof t==="number"&&t>0&&t-1 in e)}n=b(s);(function(e,t){var i,n,o,a,s,r,l,c,d,u,f,h,g,p,m,v,_,w="sizzle"+-new Date,y=e.document,C=0,j=0,x=rt(),E=rt(),k=rt(),T=false,I=function(e,t){if(e===t){T=true;return 0}return 0},S=typeof t,M=1<<31,N={}.hasOwnProperty,A=[],O=A.pop,L=A.push,D=A.push,H=A.slice,P=A.indexOf||function(e){var t=0,i=this.length;for(;t<i;t++){if(this[t]===e){return t}}return-1},F="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",B="[\\x20\\t\\r\\n\\f]",W="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",R=W.replace("w","w#"),$="\\["+B+"*("+W+")"+B+"*(?:([*^$|!~]?=)"+B+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+R+")|)|)"+B+"*\\]",V=":("+W+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+$.replace(3,8)+")*)|.*)\\)|)",z=new RegExp("^"+B+"+|((?:^|[^\\\\])(?:\\\\.)*)"+B+"+$","g"),q=new RegExp("^"+B+"*,"+B+"*"),G=new RegExp("^"+B+"*([>+~]|"+B+")"+B+"*"),U=new RegExp(B+"*[+~]"),J=new RegExp("="+B+"*([^\\]'\"]*)"+B+"*\\]","g"),Y=new RegExp(V),X=new RegExp("^"+R+"$"),Q={ID:new RegExp("^#("+W+")"),CLASS:new RegExp("^\\.("+W+")"),TAG:new RegExp("^("+W.replace("w","w*")+")"),ATTR:new RegExp("^"+$),PSEUDO:new RegExp("^"+V),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+B+"*(even|odd|(([+-]|)(\\d*)n|)"+B+"*(?:([+-]|)"+B+"*(\\d+)|))"+B+"*\\)|)","i"),bool:new RegExp("^(?:"+F+")$","i"),needsContext:new RegExp("^"+B+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+B+"*((?:-\\d)?\\d*)"+B+"*\\)|)(?=[^-]|$)","i")},Z=/^[^{]+\{\s*\[native \w/,K=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,et=/^(?:input|select|textarea|button)$/i,tt=/^h\d$/i,it=/'|\\/g,nt=new RegExp("\\\\([\\da-f]{1,6}"+B+"?|("+B+")|.)","ig"),ot=function(e,t,i){var n="0x"+t-65536;return n!==n||i?t:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,n&1023|56320)};try{D.apply(A=H.call(y.childNodes),y.childNodes);A[y.childNodes.length].nodeType}catch(at){D={apply:A.length?function(e,t){L.apply(e,H.call(t))}:function(e,t){var i=e.length,n=0;while(e[i++]=t[n++]){}e.length=i-1}}}function st(e,t,i,o){var a,s,r,l,c,d,h,m,v,b;if((t?t.ownerDocument||t:y)!==f){u(t)}t=t||f;i=i||[];if(!e||typeof e!=="string"){return i}if((l=t.nodeType)!==1&&l!==9){return[]}if(g&&!o){if(a=K.exec(e)){if(r=a[1]){if(l===9){s=t.getElementById(r);if(s&&s.parentNode){if(s.id===r){i.push(s);return i}}else{return i}}else{if(t.ownerDocument&&(s=t.ownerDocument.getElementById(r))&&_(t,s)&&s.id===r){i.push(s);return i}}}else if(a[2]){D.apply(i,t.getElementsByTagName(e));return i}else if((r=a[3])&&n.getElementsByClassName&&t.getElementsByClassName){D.apply(i,t.getElementsByClassName(r));return i}}if(n.qsa&&(!p||!p.test(e))){m=h=w;v=t;b=l===9&&e;if(l===1&&t.nodeName.toLowerCase()!=="object"){d=mt(e);if(h=t.getAttribute("id")){m=h.replace(it,"\\$&")}else{t.setAttribute("id",m)}m="[id='"+m+"'] ";c=d.length;while(c--){d[c]=m+vt(d[c])}v=U.test(e)&&t.parentNode||t;b=d.join(",")}if(b){try{D.apply(i,v.querySelectorAll(b));return i}catch(C){}finally{if(!h){t.removeAttribute("id")}}}}}return Et(e.replace(z,"$1"),t,i,o)}function rt(){var e=[];function t(i,n){if(e.push(i+=" ")>a.cacheLength){delete t[e.shift()]}return t[i]=n}return t}function lt(e){e[w]=true;return e}function ct(e){var t=f.createElement("div");try{return!!e(t)}catch(i){return false}finally{if(t.parentNode){t.parentNode.removeChild(t)}t=null}}function dt(e,t){var i=e.split("|"),n=e.length;while(n--){a.attrHandle[i[n]]=t}}function ut(e,t){var i=t&&e,n=i&&e.nodeType===1&&t.nodeType===1&&(~t.sourceIndex||M)-(~e.sourceIndex||M);if(n){return n}if(i){while(i=i.nextSibling){if(i===t){return-1}}}return e?1:-1}function ft(e){return function(t){var i=t.nodeName.toLowerCase();return i==="input"&&t.type===e}}function ht(e){return function(t){var i=t.nodeName.toLowerCase();return(i==="input"||i==="button")&&t.type===e}}function gt(e){return lt(function(t){t=+t;return lt(function(i,n){var o,a=e([],i.length,t),s=a.length;while(s--){if(i[o=a[s]]){i[o]=!(n[o]=i[o])}}})})}r=st.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?t.nodeName!=="HTML":false};n=st.support={};u=st.setDocument=function(e){var t=e?e.ownerDocument||e:y,i=t.defaultView;if(t===f||t.nodeType!==9||!t.documentElement){return f}f=t;h=t.documentElement;g=!r(t);if(i&&i.attachEvent&&i!==i.top){i.attachEvent("onbeforeunload",function(){u()})}n.attributes=ct(function(e){e.className="i";return!e.getAttribute("className")});n.getElementsByTagName=ct(function(e){e.appendChild(t.createComment(""));return!e.getElementsByTagName("*").length});n.getElementsByClassName=ct(function(e){e.innerHTML="<div class='a'></div><div class='a i'></div>";e.firstChild.className="i";return e.getElementsByClassName("i").length===2});n.getById=ct(function(e){h.appendChild(e).id=w;return!t.getElementsByName||!t.getElementsByName(w).length});if(n.getById){a.find["ID"]=function(e,t){if(typeof t.getElementById!==S&&g){var i=t.getElementById(e);return i&&i.parentNode?[i]:[]}};a.filter["ID"]=function(e){var t=e.replace(nt,ot);return function(e){return e.getAttribute("id")===t}}}else{delete a.find["ID"];a.filter["ID"]=function(e){var t=e.replace(nt,ot);return function(e){var i=typeof e.getAttributeNode!==S&&e.getAttributeNode("id");return i&&i.value===t}}}a.find["TAG"]=n.getElementsByTagName?function(e,t){if(typeof t.getElementsByTagName!==S){return t.getElementsByTagName(e)}}:function(e,t){var i,n=[],o=0,a=t.getElementsByTagName(e);if(e==="*"){while(i=a[o++]){if(i.nodeType===1){n.push(i)}}return n}return a};a.find["CLASS"]=n.getElementsByClassName&&function(e,t){if(typeof t.getElementsByClassName!==S&&g){return t.getElementsByClassName(e)}};m=[];p=[];if(n.qsa=Z.test(t.querySelectorAll)){ct(function(e){e.innerHTML="<select><option selected=''></option></select>";if(!e.querySelectorAll("[selected]").length){p.push("\\["+B+"*(?:value|"+F+")")}if(!e.querySelectorAll(":checked").length){p.push(":checked")}});ct(function(e){var i=t.createElement("input");i.setAttribute("type","hidden");e.appendChild(i).setAttribute("t","");if(e.querySelectorAll("[t^='']").length){p.push("[*^$]="+B+"*(?:''|\"\")")}if(!e.querySelectorAll(":enabled").length){p.push(":enabled",":disabled")}e.querySelectorAll("*,:x");p.push(",.*:")})}if(n.matchesSelector=Z.test(v=h.webkitMatchesSelector||h.mozMatchesSelector||h.oMatchesSelector||h.msMatchesSelector)){ct(function(e){n.disconnectedMatch=v.call(e,"div");v.call(e,"[s!='']:x");m.push("!=",V)})}p=p.length&&new RegExp(p.join("|"));m=m.length&&new RegExp(m.join("|"));_=Z.test(h.contains)||h.compareDocumentPosition?function(e,t){var i=e.nodeType===9?e.documentElement:e,n=t&&t.parentNode;return e===n||!!(n&&n.nodeType===1&&(i.contains?i.contains(n):e.compareDocumentPosition&&e.compareDocumentPosition(n)&16))}:function(e,t){if(t){while(t=t.parentNode){if(t===e){return true}}}return false};I=h.compareDocumentPosition?function(e,i){if(e===i){T=true;return 0}var o=i.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(i);if(o){if(o&1||!n.sortDetached&&i.compareDocumentPosition(e)===o){if(e===t||_(y,e)){return-1}if(i===t||_(y,i)){return 1}return d?P.call(d,e)-P.call(d,i):0}return o&4?-1:1}return e.compareDocumentPosition?-1:1}:function(e,i){var n,o=0,a=e.parentNode,s=i.parentNode,r=[e],l=[i];if(e===i){T=true;return 0}else if(!a||!s){return e===t?-1:i===t?1:a?-1:s?1:d?P.call(d,e)-P.call(d,i):0}else if(a===s){return ut(e,i)}n=e;while(n=n.parentNode){r.unshift(n)}n=i;while(n=n.parentNode){l.unshift(n)}while(r[o]===l[o]){o++}return o?ut(r[o],l[o]):r[o]===y?-1:l[o]===y?1:0};return t};st.matches=function(e,t){return st(e,null,null,t)};st.matchesSelector=function(e,t){if((e.ownerDocument||e)!==f){u(e)}t=t.replace(J,"='$1']");if(n.matchesSelector&&g&&(!m||!m.test(t))&&(!p||!p.test(t))){try{var i=v.call(e,t);if(i||n.disconnectedMatch||e.document&&e.document.nodeType!==11){return i}}catch(o){}}return st(t,f,null,[e]).length>0};st.contains=function(e,t){if((e.ownerDocument||e)!==f){u(e)}return _(e,t)};st.attr=function(e,i){if((e.ownerDocument||e)!==f){u(e)}var o=a.attrHandle[i.toLowerCase()],s=o&&N.call(a.attrHandle,i.toLowerCase())?o(e,i,!g):t;return s===t?n.attributes||!g?e.getAttribute(i):(s=e.getAttributeNode(i))&&s.specified?s.value:null:s};st.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)};st.uniqueSort=function(e){var t,i=[],o=0,a=0;T=!n.detectDuplicates;d=!n.sortStable&&e.slice(0);e.sort(I);if(T){while(t=e[a++]){if(t===e[a]){o=i.push(a)}}while(o--){e.splice(i[o],1)}}return e};s=st.getText=function(e){var t,i="",n=0,o=e.nodeType;if(!o){for(;t=e[n];n++){i+=s(t)}}else if(o===1||o===9||o===11){if(typeof e.textContent==="string"){return e.textContent}else{for(e=e.firstChild;e;e=e.nextSibling){i+=s(e)}}}else if(o===3||o===4){return e.nodeValue}return i};a=st.selectors={cacheLength:50,createPseudo:lt,match:Q,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){e[1]=e[1].replace(nt,ot);e[3]=(e[4]||e[5]||"").replace(nt,ot);if(e[2]==="~="){e[3]=" "+e[3]+" "}return e.slice(0,4)},CHILD:function(e){e[1]=e[1].toLowerCase();if(e[1].slice(0,3)==="nth"){if(!e[3]){st.error(e[0])}e[4]=+(e[4]?e[5]+(e[6]||1):2*(e[3]==="even"||e[3]==="odd"));e[5]=+(e[7]+e[8]||e[3]==="odd")}else if(e[3]){st.error(e[0])}return e},PSEUDO:function(e){var i,n=!e[5]&&e[2];if(Q["CHILD"].test(e[0])){return null}if(e[3]&&e[4]!==t){e[2]=e[4]}else if(n&&Y.test(n)&&(i=mt(n,true))&&(i=n.indexOf(")",n.length-i)-n.length)){e[0]=e[0].slice(0,i);e[2]=n.slice(0,i)}return e.slice(0,3)}},filter:{TAG:function(e){var t=e.replace(nt,ot).toLowerCase();return e==="*"?function(){return true}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=x[e+" "];return t||(t=new RegExp("(^|"+B+")"+e+"("+B+"|$)"))&&x(e,function(e){return t.test(typeof e.className==="string"&&e.className||typeof e.getAttribute!==S&&e.getAttribute("class")||"")})},ATTR:function(e,t,i){return function(n){var o=st.attr(n,e);if(o==null){return t==="!="}if(!t){return true}o+="";return t==="="?o===i:t==="!="?o!==i:t==="^="?i&&o.indexOf(i)===0:t==="*="?i&&o.indexOf(i)>-1:t==="$="?i&&o.slice(-i.length)===i:t==="~="?(" "+o+" ").indexOf(i)>-1:t==="|="?o===i||o.slice(0,i.length+1)===i+"-":false}},CHILD:function(e,t,i,n,o){var a=e.slice(0,3)!=="nth",s=e.slice(-4)!=="last",r=t==="of-type";return n===1&&o===0?function(e){return!!e.parentNode}:function(t,i,l){var c,d,u,f,h,g,p=a!==s?"nextSibling":"previousSibling",m=t.parentNode,v=r&&t.nodeName.toLowerCase(),_=!l&&!r;if(m){if(a){while(p){u=t;while(u=u[p]){if(r?u.nodeName.toLowerCase()===v:u.nodeType===1){return false}}g=p=e==="only"&&!g&&"nextSibling"}return true}g=[s?m.firstChild:m.lastChild];if(s&&_){d=m[w]||(m[w]={});c=d[e]||[];h=c[0]===C&&c[1];f=c[0]===C&&c[2];u=h&&m.childNodes[h];while(u=++h&&u&&u[p]||(f=h=0)||g.pop()){if(u.nodeType===1&&++f&&u===t){d[e]=[C,h,f];break}}}else if(_&&(c=(t[w]||(t[w]={}))[e])&&c[0]===C){f=c[1]}else{while(u=++h&&u&&u[p]||(f=h=0)||g.pop()){if((r?u.nodeName.toLowerCase()===v:u.nodeType===1)&&++f){if(_){(u[w]||(u[w]={}))[e]=[C,f]}if(u===t){break}}}}f-=o;return f===n||f%n===0&&f/n>=0}}},PSEUDO:function(e,t){var i,n=a.pseudos[e]||a.setFilters[e.toLowerCase()]||st.error("unsupported pseudo: "+e);if(n[w]){return n(t)}if(n.length>1){i=[e,e,"",t];return a.setFilters.hasOwnProperty(e.toLowerCase())?lt(function(e,i){var o,a=n(e,t),s=a.length;while(s--){o=P.call(e,a[s]);e[o]=!(i[o]=a[s])}}):function(e){return n(e,0,i)}}return n}},pseudos:{not:lt(function(e){var t=[],i=[],n=l(e.replace(z,"$1"));return n[w]?lt(function(e,t,i,o){var a,s=n(e,null,o,[]),r=e.length;while(r--){if(a=s[r]){e[r]=!(t[r]=a)}}}):function(e,o,a){t[0]=e;n(t,null,a,i);return!i.pop()}}),has:lt(function(e){return function(t){return st(e,t).length>0}}),contains:lt(function(e){return function(t){return(t.textContent||t.innerText||s(t)).indexOf(e)>-1}}),lang:lt(function(e){if(!X.test(e||"")){st.error("unsupported lang: "+e)}e=e.replace(nt,ot).toLowerCase();return function(t){var i;do{if(i=g?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang")){i=i.toLowerCase();return i===e||i.indexOf(e+"-")===0}}while((t=t.parentNode)&&t.nodeType===1);return false}}),target:function(t){var i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:function(e){return e===h},focus:function(e){return e===f.activeElement&&(!f.hasFocus||f.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===false},disabled:function(e){return e.disabled===true},checked:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&!!e.checked||t==="option"&&!!e.selected},selected:function(e){if(e.parentNode){e.parentNode.selectedIndex}return e.selected===true},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling){if(e.nodeName>"@"||e.nodeType===3||e.nodeType===4){return false}}return true},parent:function(e){return!a.pseudos["empty"](e)},header:function(e){return tt.test(e.nodeName)},input:function(e){return et.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type==="button"||t==="button"},text:function(e){var t;return e.nodeName.toLowerCase()==="input"&&e.type==="text"&&((t=e.getAttribute("type"))==null||t.toLowerCase()===e.type)},first:gt(function(){return[0]}),last:gt(function(e,t){return[t-1]}),eq:gt(function(e,t,i){return[i<0?i+t:i]}),even:gt(function(e,t){var i=0;for(;i<t;i+=2){e.push(i)}return e}),odd:gt(function(e,t){var i=1;for(;i<t;i+=2){e.push(i)}return e}),lt:gt(function(e,t,i){var n=i<0?i+t:i;for(;--n>=0;){e.push(n)}return e}),gt:gt(function(e,t,i){var n=i<0?i+t:i;for(;++n<t;){e.push(n)}return e})}};a.pseudos["nth"]=a.pseudos["eq"];for(i in{radio:true,checkbox:true,file:true,password:true,image:true}){a.pseudos[i]=ft(i)}for(i in{submit:true,reset:true}){a.pseudos[i]=ht(i)}function pt(){}pt.prototype=a.filters=a.pseudos;a.setFilters=new pt;function mt(e,t){var i,n,o,s,r,l,c,d=E[e+" "];if(d){return t?0:d.slice(0)}r=e;l=[];c=a.preFilter;while(r){if(!i||(n=q.exec(r))){if(n){r=r.slice(n[0].length)||r}l.push(o=[])}i=false;if(n=G.exec(r)){i=n.shift();o.push({value:i,type:n[0].replace(z," ")});r=r.slice(i.length)}for(s in a.filter){if((n=Q[s].exec(r))&&(!c[s]||(n=c[s](n)))){i=n.shift();o.push({value:i,type:s,matches:n});r=r.slice(i.length)}}if(!i){break}}return t?r.length:r?st.error(e):E(e,l).slice(0)}function vt(e){var t=0,i=e.length,n="";for(;t<i;t++){n+=e[t].value}return n}function _t(e,t,i){var n=t.dir,a=i&&n==="parentNode",s=j++;return t.first?function(t,i,o){while(t=t[n]){if(t.nodeType===1||a){return e(t,i,o)}}}:function(t,i,r){var l,c,d,u=C+" "+s;if(r){while(t=t[n]){if(t.nodeType===1||a){if(e(t,i,r)){return true}}}}else{while(t=t[n]){if(t.nodeType===1||a){d=t[w]||(t[w]={});if((c=d[n])&&c[0]===u){if((l=c[1])===true||l===o){return l===true}}else{c=d[n]=[u];c[1]=e(t,i,r)||o;if(c[1]===true){return true}}}}}}}function wt(e){return e.length>1?function(t,i,n){var o=e.length;while(o--){if(!e[o](t,i,n)){return false}}return true}:e[0]}function bt(e,t,i,n,o){var a,s=[],r=0,l=e.length,c=t!=null;for(;r<l;r++){if(a=e[r]){if(!i||i(a,n,o)){s.push(a);if(c){t.push(r)}}}}return s}function yt(e,t,i,n,o,a){if(n&&!n[w]){n=yt(n)}if(o&&!o[w]){o=yt(o,a)}return lt(function(a,s,r,l){var c,d,u,f=[],h=[],g=s.length,p=a||xt(t||"*",r.nodeType?[r]:r,[]),m=e&&(a||!t)?bt(p,f,e,r,l):p,v=i?o||(a?e:g||n)?[]:s:m;if(i){i(m,v,r,l)}if(n){c=bt(v,h);n(c,[],r,l);d=c.length;while(d--){if(u=c[d]){v[h[d]]=!(m[h[d]]=u)}}}if(a){if(o||e){if(o){c=[];d=v.length;while(d--){if(u=v[d]){c.push(m[d]=u)}}o(null,v=[],c,l)}d=v.length;while(d--){if((u=v[d])&&(c=o?P.call(a,u):f[d])>-1){a[c]=!(s[c]=u)}}}}else{v=bt(v===s?v.splice(g,v.length):v);if(o){o(null,s,v,l)}else{D.apply(s,v)}}})}function Ct(e){var t,i,n,o=e.length,s=a.relative[e[0].type],r=s||a.relative[" "],l=s?1:0,d=_t(function(e){return e===t},r,true),u=_t(function(e){return P.call(t,e)>-1},r,true),f=[function(e,i,n){return!s&&(n||i!==c)||((t=i).nodeType?d(e,i,n):u(e,i,n))}];for(;l<o;l++){if(i=a.relative[e[l].type]){f=[_t(wt(f),i)]}else{i=a.filter[e[l].type].apply(null,e[l].matches);if(i[w]){n=++l;for(;n<o;n++){if(a.relative[e[n].type]){break}}return yt(l>1&&wt(f),l>1&&vt(e.slice(0,l-1).concat({value:e[l-2].type===" "?"*":""})).replace(z,"$1"),i,l<n&&Ct(e.slice(l,n)),n<o&&Ct(e=e.slice(n)),n<o&&vt(e))}f.push(i)}}return wt(f)}function jt(e,t){var i=0,n=t.length>0,s=e.length>0,r=function(r,l,d,u,h){var g,p,m,v=[],_=0,w="0",b=r&&[],y=h!=null,j=c,x=r||s&&a.find["TAG"]("*",h&&l.parentNode||l),E=C+=j==null?1:Math.random()||.1;if(y){c=l!==f&&l;o=i}for(;(g=x[w])!=null;w++){if(s&&g){p=0;while(m=e[p++]){if(m(g,l,d)){u.push(g);break}}if(y){C=E;o=++i}}if(n){if(g=!m&&g){_--}if(r){b.push(g)}}}_+=w;if(n&&w!==_){p=0;while(m=t[p++]){m(b,v,l,d)}if(r){if(_>0){while(w--){if(!(b[w]||v[w])){v[w]=O.call(u)}}}v=bt(v)}D.apply(u,v);if(y&&!r&&v.length>0&&_+t.length>1){st.uniqueSort(u)}}if(y){C=E;c=j}return b};return n?lt(r):r}l=st.compile=function(e,t){var i,n=[],o=[],a=k[e+" "];if(!a){if(!t){t=mt(e)}i=t.length;while(i--){a=Ct(t[i]);if(a[w]){n.push(a)}else{o.push(a)}}a=k(e,jt(o,n))}return a};function xt(e,t,i){var n=0,o=t.length;for(;n<o;n++){st(e,t[n],i)}return i}function Et(e,t,i,o){var s,r,c,d,u,f=mt(e);if(!o){if(f.length===1){r=f[0]=f[0].slice(0);if(r.length>2&&(c=r[0]).type==="ID"&&n.getById&&t.nodeType===9&&g&&a.relative[r[1].type]){t=(a.find["ID"](c.matches[0].replace(nt,ot),t)||[])[0];if(!t){return i}e=e.slice(r.shift().value.length)}s=Q["needsContext"].test(e)?0:r.length;while(s--){c=r[s];if(a.relative[d=c.type]){break}if(u=a.find[d]){if(o=u(c.matches[0].replace(nt,ot),U.test(r[0].type)&&t.parentNode||t)){r.splice(s,1);e=o.length&&vt(r);if(!e){D.apply(i,o);return i}break}}}}}l(e,f)(o,t,!g,i,U.test(e));return i}n.sortStable=w.split("").sort(I).join("")===w;n.detectDuplicates=T;u();n.sortDetached=ct(function(e){return e.compareDocumentPosition(f.createElement("div"))&1});if(!ct(function(e){e.innerHTML="<a href='#'></a>";return e.firstChild.getAttribute("href")==="#"})){dt("type|href|height|width",function(e,t,i){if(!i){return e.getAttribute(t,t.toLowerCase()==="type"?1:2)}})}if(!n.attributes||!ct(function(e){e.innerHTML="<input/>";e.firstChild.setAttribute("value","");return e.firstChild.getAttribute("value")===""})){dt("value",function(e,t,i){if(!i&&e.nodeName.toLowerCase()==="input"){return e.defaultValue}})}if(!ct(function(e){return e.getAttribute("disabled")==null})){dt(F,function(e,t,i){var n;if(!i){return(n=e.getAttributeNode(t))&&n.specified?n.value:e[t]===true?t.toLowerCase():null}})}b.find=st;b.expr=st.selectors;b.expr[":"]=b.expr.pseudos;b.unique=st.uniqueSort;b.text=st.getText;b.isXMLDoc=st.isXML;b.contains=st.contains})(e);var H={};function P(e){var t=H[e]={};b.each(e.match(C)||[],function(e,i){t[i]=true});return t}b.Callbacks=function(e){e=typeof e==="string"?H[e]||P(e):b.extend({},e);var i,n,o,a,s,r,l=[],c=!e.once&&[],d=function(t){n=e.memory&&t;o=true;s=r||0;r=0;a=l.length;i=true;for(;l&&s<a;s++){if(l[s].apply(t[0],t[1])===false&&e.stopOnFalse){n=false;break}}i=false;if(l){if(c){if(c.length){d(c.shift())}}else if(n){l=[]}else{u.disable()}}},u={add:function(){if(l){var t=l.length;(function o(t){b.each(t,function(t,i){var n=b.type(i);if(n==="function"){if(!e.unique||!u.has(i)){l.push(i)}}else if(i&&i.length&&n!=="string"){o(i)}})})(arguments);if(i){a=l.length}else if(n){r=t;d(n)}}return this},remove:function(){if(l){b.each(arguments,function(e,t){var n;while((n=b.inArray(t,l,n))>-1){l.splice(n,1);if(i){if(n<=a){a--}if(n<=s){s--}}}})}return this},has:function(e){return e?b.inArray(e,l)>-1:!!(l&&l.length)},empty:function(){l=[];a=0;return this},disable:function(){l=c=n=t;return this},disabled:function(){return!l},lock:function(){c=t;if(!n){u.disable()}return this},locked:function(){return!c},fireWith:function(e,t){if(l&&(!o||c)){t=t||[];t=[e,t.slice?t.slice():t];if(i){c.push(t)}else{d(t)}}return this},fire:function(){u.fireWith(this,arguments);return this},fired:function(){return!!o}};return u};b.extend({Deferred:function(e){var t=[["resolve","done",b.Callbacks("once memory"),"resolved"],["reject","fail",b.Callbacks("once memory"),"rejected"],["notify","progress",b.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){o.done(arguments).fail(arguments);return this},then:function(){var e=arguments;return b.Deferred(function(i){b.each(t,function(t,a){var s=a[0],r=b.isFunction(e[t])&&e[t];o[a[1]](function(){var e=r&&r.apply(this,arguments);if(e&&b.isFunction(e.promise)){e.promise().done(i.resolve).fail(i.reject).progress(i.notify)}else{i[s+"With"](this===n?i.promise():this,r?[e]:arguments)}})});e=null}).promise()},promise:function(e){return e!=null?b.extend(e,n):n}},o={};n.pipe=n.then;b.each(t,function(e,a){var s=a[2],r=a[3];n[a[1]]=s.add;if(r){s.add(function(){i=r},t[e^1][2].disable,t[2][2].lock)}o[a[0]]=function(){o[a[0]+"With"](this===o?n:this,arguments);return this};o[a[0]+"With"]=s.fireWith});n.promise(o);if(e){e.call(o,o)}return o},when:function(e){var t=0,i=p.call(arguments),n=i.length,o=n!==1||e&&b.isFunction(e.promise)?n:0,a=o===1?e:b.Deferred(),s=function(e,t,i){return function(n){t[e]=this;i[e]=arguments.length>1?p.call(arguments):n;if(i===r){a.notifyWith(t,i)}else if(!--o){a.resolveWith(t,i)}}},r,l,c;if(n>1){r=new Array(n);l=new Array(n);c=new Array(n);for(;t<n;t++){if(i[t]&&b.isFunction(i[t].promise)){i[t].promise().done(s(t,c,i)).fail(a.reject).progress(s(t,l,r))}else{--o}}}if(!o){a.resolveWith(c,i)}return a.promise()}});b.support=function(t){var i,n,a,r,l,c,d,u,f,h=s.createElement("div");h.setAttribute("className","t");h.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";i=h.getElementsByTagName("*")||[];n=h.getElementsByTagName("a")[0];if(!n||!n.style||!i.length){return t}r=s.createElement("select");c=r.appendChild(s.createElement("option"));a=h.getElementsByTagName("input")[0];n.style.cssText="top:1px;float:left;opacity:.5";t.getSetAttribute=h.className!=="t";t.leadingWhitespace=h.firstChild.nodeType===3;t.tbody=!h.getElementsByTagName("tbody").length;t.htmlSerialize=!!h.getElementsByTagName("link").length;t.style=/top/.test(n.getAttribute("style"));t.hrefNormalized=n.getAttribute("href")==="/a";t.opacity=/^0.5/.test(n.style.opacity);t.cssFloat=!!n.style.cssFloat;t.checkOn=!!a.value;t.optSelected=c.selected;t.enctype=!!s.createElement("form").enctype;t.html5Clone=s.createElement("nav").cloneNode(true).outerHTML!=="<:nav></:nav>";t.inlineBlockNeedsLayout=false;t.shrinkWrapBlocks=false;t.pixelPosition=false;t.deleteExpando=true;t.noCloneEvent=true;t.reliableMarginRight=true;t.boxSizingReliable=true;a.checked=true;t.noCloneChecked=a.cloneNode(true).checked;r.disabled=true;t.optDisabled=!c.disabled;try{delete h.test}catch(g){t.deleteExpando=false}a=s.createElement("input");a.setAttribute("value","");t.input=a.getAttribute("value")==="";a.value="t";a.setAttribute("type","radio");t.radioValue=a.value==="t";a.setAttribute("checked","t");a.setAttribute("name","t");l=s.createDocumentFragment();l.appendChild(a);t.appendChecked=a.checked;t.checkClone=l.cloneNode(true).cloneNode(true).lastChild.checked;if(h.attachEvent){h.attachEvent("onclick",function(){t.noCloneEvent=false});h.cloneNode(true).click()}for(f in{submit:true,change:true,focusin:true}){h.setAttribute(d="on"+f,"t");t[f+"Bubbles"]=d in e||h.attributes[d].expando===false}h.style.backgroundClip="content-box";h.cloneNode(true).style.backgroundClip="";t.clearCloneStyle=h.style.backgroundClip==="content-box";for(f in b(t)){break}t.ownLast=f!=="0";b(function(){var i,n,a,r="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",l=s.getElementsByTagName("body")[0];if(!l){return}i=s.createElement("div");
i.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px";l.appendChild(i).appendChild(h);h.innerHTML="<table><tr><td></td><td>t</td></tr></table>";a=h.getElementsByTagName("td");a[0].style.cssText="padding:0;margin:0;border:0;display:none";u=a[0].offsetHeight===0;a[0].style.display="";a[1].style.display="none";t.reliableHiddenOffsets=u&&a[0].offsetHeight===0;h.innerHTML="";h.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;";b.swap(l,l.style.zoom!=null?{zoom:1}:{},function(){t.boxSizing=h.offsetWidth===4});if(e.getComputedStyle){t.pixelPosition=(e.getComputedStyle(h,null)||{}).top!=="1%";t.boxSizingReliable=(e.getComputedStyle(h,null)||{width:"4px"}).width==="4px";n=h.appendChild(s.createElement("div"));n.style.cssText=h.style.cssText=r;n.style.marginRight=n.style.width="0";h.style.width="1px";t.reliableMarginRight=!parseFloat((e.getComputedStyle(n,null)||{}).marginRight)}if(typeof h.style.zoom!==o){h.innerHTML="";h.style.cssText=r+"width:1px;padding:1px;display:inline;zoom:1";t.inlineBlockNeedsLayout=h.offsetWidth===3;h.style.display="block";h.innerHTML="<div></div>";h.firstChild.style.width="5px";t.shrinkWrapBlocks=h.offsetWidth!==3}l.removeChild(i);i=h=a=n=null});i=r=l=c=n=a=null;return t}({});var F=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,B=/([A-Z])/g;function W(e,i,n,o){if(!b.acceptData(e)){return}var a,s,r=b.expando,l=e.nodeType,c=l?b.cache:e,d=l?e[r]:e[r]&&r;if((!d||!c[d]||!o&&!c[d].data)&&n===t&&typeof i==="string"){return}if(!d){if(l){d=e[r]=u.pop()||b.guid++}else{d=r}}if(!c[d]){c[d]=l?{}:{toJSON:b.noop}}if(typeof i==="object"||typeof i==="function"){if(o){c[d]=b.extend(c[d],i)}else{c[d].data=b.extend(c[d].data,i)}}s=c[d];if(!o){if(!s.data){s.data={}}s=s.data}if(n!==t){s[b.camelCase(i)]=n}if(typeof i==="string"){a=s[i];if(a==null){a=s[b.camelCase(i)]}}else{a=s}return a}function R(e,t,i){if(!b.acceptData(e)){return}var n,o,a=e.nodeType,s=a?b.cache:e,r=a?e[b.expando]:b.expando;if(!s[r]){return}if(t){n=i?s[r]:s[r].data;if(n){if(!b.isArray(t)){if(t in n){t=[t]}else{t=b.camelCase(t);if(t in n){t=[t]}else{t=t.split(" ")}}}else{t=t.concat(b.map(t,b.camelCase))}o=t.length;while(o--){delete n[t[o]]}if(i?!V(n):!b.isEmptyObject(n)){return}}}if(!i){delete s[r].data;if(!V(s[r])){return}}if(a){b.cleanData([e],true)}else if(b.support.deleteExpando||s!=s.window){delete s[r]}else{s[r]=null}}b.extend({cache:{},noData:{applet:true,embed:true,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){e=e.nodeType?b.cache[e[b.expando]]:e[b.expando];return!!e&&!V(e)},data:function(e,t,i){return W(e,t,i)},removeData:function(e,t){return R(e,t)},_data:function(e,t,i){return W(e,t,i,true)},_removeData:function(e,t){return R(e,t,true)},acceptData:function(e){if(e.nodeType&&e.nodeType!==1&&e.nodeType!==9){return false}var t=e.nodeName&&b.noData[e.nodeName.toLowerCase()];return!t||t!==true&&e.getAttribute("classid")===t}});b.fn.extend({data:function(e,i){var n,o,a=null,s=0,r=this[0];if(e===t){if(this.length){a=b.data(r);if(r.nodeType===1&&!b._data(r,"parsedAttrs")){n=r.attributes;for(;s<n.length;s++){o=n[s].name;if(o.indexOf("data-")===0){o=b.camelCase(o.slice(5));$(r,o,a[o])}}b._data(r,"parsedAttrs",true)}}return a}if(typeof e==="object"){return this.each(function(){b.data(this,e)})}return arguments.length>1?this.each(function(){b.data(this,e,i)}):r?$(r,e,b.data(r,e)):null},removeData:function(e){return this.each(function(){b.removeData(this,e)})}});function $(e,i,n){if(n===t&&e.nodeType===1){var o="data-"+i.replace(B,"-$1").toLowerCase();n=e.getAttribute(o);if(typeof n==="string"){try{n=n==="true"?true:n==="false"?false:n==="null"?null:+n+""===n?+n:F.test(n)?b.parseJSON(n):n}catch(a){}b.data(e,i,n)}else{n=t}}return n}function V(e){var t;for(t in e){if(t==="data"&&b.isEmptyObject(e[t])){continue}if(t!=="toJSON"){return false}}return true}b.extend({queue:function(e,t,i){var n;if(e){t=(t||"fx")+"queue";n=b._data(e,t);if(i){if(!n||b.isArray(i)){n=b._data(e,t,b.makeArray(i))}else{n.push(i)}}return n||[]}},dequeue:function(e,t){t=t||"fx";var i=b.queue(e,t),n=i.length,o=i.shift(),a=b._queueHooks(e,t),s=function(){b.dequeue(e,t)};if(o==="inprogress"){o=i.shift();n--}if(o){if(t==="fx"){i.unshift("inprogress")}delete a.stop;o.call(e,s,a)}if(!n&&a){a.empty.fire()}},_queueHooks:function(e,t){var i=t+"queueHooks";return b._data(e,i)||b._data(e,i,{empty:b.Callbacks("once memory").add(function(){b._removeData(e,t+"queue");b._removeData(e,i)})})}});b.fn.extend({queue:function(e,i){var n=2;if(typeof e!=="string"){i=e;e="fx";n--}if(arguments.length<n){return b.queue(this[0],e)}return i===t?this:this.each(function(){var t=b.queue(this,e,i);b._queueHooks(this,e);if(e==="fx"&&t[0]!=="inprogress"){b.dequeue(this,e)}})},dequeue:function(e){return this.each(function(){b.dequeue(this,e)})},delay:function(e,t){e=b.fx?b.fx.speeds[e]||e:e;t=t||"fx";return this.queue(t,function(t,i){var n=setTimeout(t,e);i.stop=function(){clearTimeout(n)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,i){var n,o=1,a=b.Deferred(),s=this,r=this.length,l=function(){if(!--o){a.resolveWith(s,[s])}};if(typeof e!=="string"){i=e;e=t}e=e||"fx";while(r--){n=b._data(s[r],e+"queueHooks");if(n&&n.empty){o++;n.empty.add(l)}}l();return a.promise(i)}});var z,q,G=/[\t\r\n\f]/g,U=/\r/g,J=/^(?:input|select|textarea|button|object)$/i,Y=/^(?:a|area)$/i,X=/^(?:checked|selected)$/i,Q=b.support.getSetAttribute,Z=b.support.input;b.fn.extend({attr:function(e,t){return b.access(this,b.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){b.removeAttr(this,e)})},prop:function(e,t){return b.access(this,b.prop,e,t,arguments.length>1)},removeProp:function(e){e=b.propFix[e]||e;return this.each(function(){try{this[e]=t;delete this[e]}catch(i){}})},addClass:function(e){var t,i,n,o,a,s=0,r=this.length,l=typeof e==="string"&&e;if(b.isFunction(e)){return this.each(function(t){b(this).addClass(e.call(this,t,this.className))})}if(l){t=(e||"").match(C)||[];for(;s<r;s++){i=this[s];n=i.nodeType===1&&(i.className?(" "+i.className+" ").replace(G," "):" ");if(n){a=0;while(o=t[a++]){if(n.indexOf(" "+o+" ")<0){n+=o+" "}}i.className=b.trim(n)}}}return this},removeClass:function(e){var t,i,n,o,a,s=0,r=this.length,l=arguments.length===0||typeof e==="string"&&e;if(b.isFunction(e)){return this.each(function(t){b(this).removeClass(e.call(this,t,this.className))})}if(l){t=(e||"").match(C)||[];for(;s<r;s++){i=this[s];n=i.nodeType===1&&(i.className?(" "+i.className+" ").replace(G," "):"");if(n){a=0;while(o=t[a++]){while(n.indexOf(" "+o+" ")>=0){n=n.replace(" "+o+" "," ")}}i.className=e?b.trim(n):""}}}return this},toggleClass:function(e,t){var i=typeof e;if(typeof t==="boolean"&&i==="string"){return t?this.addClass(e):this.removeClass(e)}if(b.isFunction(e)){return this.each(function(i){b(this).toggleClass(e.call(this,i,this.className,t),t)})}return this.each(function(){if(i==="string"){var t,n=0,a=b(this),s=e.match(C)||[];while(t=s[n++]){if(a.hasClass(t)){a.removeClass(t)}else{a.addClass(t)}}}else if(i===o||i==="boolean"){if(this.className){b._data(this,"__className__",this.className)}this.className=this.className||e===false?"":b._data(this,"__className__")||""}})},hasClass:function(e){var t=" "+e+" ",i=0,n=this.length;for(;i<n;i++){if(this[i].nodeType===1&&(" "+this[i].className+" ").replace(G," ").indexOf(t)>=0){return true}}return false},val:function(e){var i,n,o,a=this[0];if(!arguments.length){if(a){n=b.valHooks[a.type]||b.valHooks[a.nodeName.toLowerCase()];if(n&&"get"in n&&(i=n.get(a,"value"))!==t){return i}i=a.value;return typeof i==="string"?i.replace(U,""):i==null?"":i}return}o=b.isFunction(e);return this.each(function(i){var a;if(this.nodeType!==1){return}if(o){a=e.call(this,i,b(this).val())}else{a=e}if(a==null){a=""}else if(typeof a==="number"){a+=""}else if(b.isArray(a)){a=b.map(a,function(e){return e==null?"":e+""})}n=b.valHooks[this.type]||b.valHooks[this.nodeName.toLowerCase()];if(!n||!("set"in n)||n.set(this,a,"value")===t){this.value=a}})}});b.extend({valHooks:{option:{get:function(e){var t=b.find.attr(e,"value");return t!=null?t:e.text}},select:{get:function(e){var t,i,n=e.options,o=e.selectedIndex,a=e.type==="select-one"||o<0,s=a?null:[],r=a?o+1:n.length,l=o<0?r:a?o:0;for(;l<r;l++){i=n[l];if((i.selected||l===o)&&(b.support.optDisabled?!i.disabled:i.getAttribute("disabled")===null)&&(!i.parentNode.disabled||!b.nodeName(i.parentNode,"optgroup"))){t=b(i).val();if(a){return t}s.push(t)}}return s},set:function(e,t){var i,n,o=e.options,a=b.makeArray(t),s=o.length;while(s--){n=o[s];if(n.selected=b.inArray(b(n).val(),a)>=0){i=true}}if(!i){e.selectedIndex=-1}return a}}},attr:function(e,i,n){var a,s,r=e.nodeType;if(!e||r===3||r===8||r===2){return}if(typeof e.getAttribute===o){return b.prop(e,i,n)}if(r!==1||!b.isXMLDoc(e)){i=i.toLowerCase();a=b.attrHooks[i]||(b.expr.match.bool.test(i)?q:z)}if(n!==t){if(n===null){b.removeAttr(e,i)}else if(a&&"set"in a&&(s=a.set(e,n,i))!==t){return s}else{e.setAttribute(i,n+"");return n}}else if(a&&"get"in a&&(s=a.get(e,i))!==null){return s}else{s=b.find.attr(e,i);return s==null?t:s}},removeAttr:function(e,t){var i,n,o=0,a=t&&t.match(C);if(a&&e.nodeType===1){while(i=a[o++]){n=b.propFix[i]||i;if(b.expr.match.bool.test(i)){if(Z&&Q||!X.test(i)){e[n]=false}else{e[b.camelCase("default-"+i)]=e[n]=false}}else{b.attr(e,i,"")}e.removeAttribute(Q?i:n)}}},attrHooks:{type:{set:function(e,t){if(!b.support.radioValue&&t==="radio"&&b.nodeName(e,"input")){var i=e.value;e.setAttribute("type",t);if(i){e.value=i}return t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,i,n){var o,a,s,r=e.nodeType;if(!e||r===3||r===8||r===2){return}s=r!==1||!b.isXMLDoc(e);if(s){i=b.propFix[i]||i;a=b.propHooks[i]}if(n!==t){return a&&"set"in a&&(o=a.set(e,n,i))!==t?o:e[i]=n}else{return a&&"get"in a&&(o=a.get(e,i))!==null?o:e[i]}},propHooks:{tabIndex:{get:function(e){var t=b.find.attr(e,"tabindex");return t?parseInt(t,10):J.test(e.nodeName)||Y.test(e.nodeName)&&e.href?0:-1}}}});q={set:function(e,t,i){if(t===false){b.removeAttr(e,i)}else if(Z&&Q||!X.test(i)){e.setAttribute(!Q&&b.propFix[i]||i,i)}else{e[b.camelCase("default-"+i)]=e[i]=true}return i}};b.each(b.expr.match.bool.source.match(/\w+/g),function(e,i){var n=b.expr.attrHandle[i]||b.find.attr;b.expr.attrHandle[i]=Z&&Q||!X.test(i)?function(e,i,o){var a=b.expr.attrHandle[i],s=o?t:(b.expr.attrHandle[i]=t)!=n(e,i,o)?i.toLowerCase():null;b.expr.attrHandle[i]=a;return s}:function(e,i,n){return n?t:e[b.camelCase("default-"+i)]?i.toLowerCase():null}});if(!Z||!Q){b.attrHooks.value={set:function(e,t,i){if(b.nodeName(e,"input")){e.defaultValue=t}else{return z&&z.set(e,t,i)}}}}if(!Q){z={set:function(e,i,n){var o=e.getAttributeNode(n);if(!o){e.setAttributeNode(o=e.ownerDocument.createAttribute(n))}o.value=i+="";return n==="value"||i===e.getAttribute(n)?i:t}};b.expr.attrHandle.id=b.expr.attrHandle.name=b.expr.attrHandle.coords=function(e,i,n){var o;return n?t:(o=e.getAttributeNode(i))&&o.value!==""?o.value:null};b.valHooks.button={get:function(e,i){var n=e.getAttributeNode(i);return n&&n.specified?n.value:t},set:z.set};b.attrHooks.contenteditable={set:function(e,t,i){z.set(e,t===""?false:t,i)}};b.each(["width","height"],function(e,t){b.attrHooks[t]={set:function(e,i){if(i===""){e.setAttribute(t,"auto");return i}}}})}if(!b.support.hrefNormalized){b.each(["href","src"],function(e,t){b.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}})}if(!b.support.style){b.attrHooks.style={get:function(e){return e.style.cssText||t},set:function(e,t){return e.style.cssText=t+""}}}if(!b.support.optSelected){b.propHooks.selected={get:function(e){var t=e.parentNode;if(t){t.selectedIndex;if(t.parentNode){t.parentNode.selectedIndex}}return null}}}b.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){b.propFix[this.toLowerCase()]=this});if(!b.support.enctype){b.propFix.enctype="encoding"}b.each(["radio","checkbox"],function(){b.valHooks[this]={set:function(e,t){if(b.isArray(t)){return e.checked=b.inArray(b(e).val(),t)>=0}}};if(!b.support.checkOn){b.valHooks[this].get=function(e){return e.getAttribute("value")===null?"on":e.value}}});var K=/^(?:input|select|textarea)$/i,et=/^key/,tt=/^(?:mouse|contextmenu)|click/,it=/^(?:focusinfocus|focusoutblur)$/,nt=/^([^.]*)(?:\.(.+)|)$/;function ot(){return true}function at(){return false}function st(){try{return s.activeElement}catch(e){}}b.event={global:{},add:function(e,i,n,a,s){var r,l,c,d,u,f,h,g,p,m,v,_=b._data(e);if(!_){return}if(n.handler){d=n;n=d.handler;s=d.selector}if(!n.guid){n.guid=b.guid++}if(!(l=_.events)){l=_.events={}}if(!(f=_.handle)){f=_.handle=function(e){return typeof b!==o&&(!e||b.event.triggered!==e.type)?b.event.dispatch.apply(f.elem,arguments):t};f.elem=e}i=(i||"").match(C)||[""];c=i.length;while(c--){r=nt.exec(i[c])||[];p=v=r[1];m=(r[2]||"").split(".").sort();if(!p){continue}u=b.event.special[p]||{};p=(s?u.delegateType:u.bindType)||p;u=b.event.special[p]||{};h=b.extend({type:p,origType:v,data:a,handler:n,guid:n.guid,selector:s,needsContext:s&&b.expr.match.needsContext.test(s),namespace:m.join(".")},d);if(!(g=l[p])){g=l[p]=[];g.delegateCount=0;if(!u.setup||u.setup.call(e,a,m,f)===false){if(e.addEventListener){e.addEventListener(p,f,false)}else if(e.attachEvent){e.attachEvent("on"+p,f)}}}if(u.add){u.add.call(e,h);if(!h.handler.guid){h.handler.guid=n.guid}}if(s){g.splice(g.delegateCount++,0,h)}else{g.push(h)}b.event.global[p]=true}e=null},remove:function(e,t,i,n,o){var a,s,r,l,c,d,u,f,h,g,p,m=b.hasData(e)&&b._data(e);if(!m||!(d=m.events)){return}t=(t||"").match(C)||[""];c=t.length;while(c--){r=nt.exec(t[c])||[];h=p=r[1];g=(r[2]||"").split(".").sort();if(!h){for(h in d){b.event.remove(e,h+t[c],i,n,true)}continue}u=b.event.special[h]||{};h=(n?u.delegateType:u.bindType)||h;f=d[h]||[];r=r[2]&&new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)");l=a=f.length;while(a--){s=f[a];if((o||p===s.origType)&&(!i||i.guid===s.guid)&&(!r||r.test(s.namespace))&&(!n||n===s.selector||n==="**"&&s.selector)){f.splice(a,1);if(s.selector){f.delegateCount--}if(u.remove){u.remove.call(e,s)}}}if(l&&!f.length){if(!u.teardown||u.teardown.call(e,g,m.handle)===false){b.removeEvent(e,h,m.handle)}delete d[h]}}if(b.isEmptyObject(d)){delete m.handle;b._removeData(e,"events")}},trigger:function(i,n,o,a){var r,l,c,d,u,f,h,g=[o||s],p=_.call(i,"type")?i.type:i,m=_.call(i,"namespace")?i.namespace.split("."):[];c=f=o=o||s;if(o.nodeType===3||o.nodeType===8){return}if(it.test(p+b.event.triggered)){return}if(p.indexOf(".")>=0){m=p.split(".");p=m.shift();m.sort()}l=p.indexOf(":")<0&&"on"+p;i=i[b.expando]?i:new b.Event(p,typeof i==="object"&&i);i.isTrigger=a?2:3;i.namespace=m.join(".");i.namespace_re=i.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;i.result=t;if(!i.target){i.target=o}n=n==null?[i]:b.makeArray(n,[i]);u=b.event.special[p]||{};if(!a&&u.trigger&&u.trigger.apply(o,n)===false){return}if(!a&&!u.noBubble&&!b.isWindow(o)){d=u.delegateType||p;if(!it.test(d+p)){c=c.parentNode}for(;c;c=c.parentNode){g.push(c);f=c}if(f===(o.ownerDocument||s)){g.push(f.defaultView||f.parentWindow||e)}}h=0;while((c=g[h++])&&!i.isPropagationStopped()){i.type=h>1?d:u.bindType||p;r=(b._data(c,"events")||{})[i.type]&&b._data(c,"handle");if(r){r.apply(c,n)}r=l&&c[l];if(r&&b.acceptData(c)&&r.apply&&r.apply(c,n)===false){i.preventDefault()}}i.type=p;if(!a&&!i.isDefaultPrevented()){if((!u._default||u._default.apply(g.pop(),n)===false)&&b.acceptData(o)){if(l&&o[p]&&!b.isWindow(o)){f=o[l];if(f){o[l]=null}b.event.triggered=p;try{o[p]()}catch(v){}b.event.triggered=t;if(f){o[l]=f}}}}return i.result},dispatch:function(e){e=b.event.fix(e);var i,n,o,a,s,r=[],l=p.call(arguments),c=(b._data(this,"events")||{})[e.type]||[],d=b.event.special[e.type]||{};l[0]=e;e.delegateTarget=this;if(d.preDispatch&&d.preDispatch.call(this,e)===false){return}r=b.event.handlers.call(this,e,c);i=0;while((a=r[i++])&&!e.isPropagationStopped()){e.currentTarget=a.elem;s=0;while((o=a.handlers[s++])&&!e.isImmediatePropagationStopped()){if(!e.namespace_re||e.namespace_re.test(o.namespace)){e.handleObj=o;e.data=o.data;n=((b.event.special[o.origType]||{}).handle||o.handler).apply(a.elem,l);if(n!==t){if((e.result=n)===false){e.preventDefault();e.stopPropagation()}}}}}if(d.postDispatch){d.postDispatch.call(this,e)}return e.result},handlers:function(e,i){var n,o,a,s,r=[],l=i.delegateCount,c=e.target;if(l&&c.nodeType&&(!e.button||e.type!=="click")){for(;c!=this;c=c.parentNode||this){if(c.nodeType===1&&(c.disabled!==true||e.type!=="click")){a=[];for(s=0;s<l;s++){o=i[s];n=o.selector+" ";if(a[n]===t){a[n]=o.needsContext?b(n,this).index(c)>=0:b.find(n,this,null,[c]).length}if(a[n]){a.push(o)}}if(a.length){r.push({elem:c,handlers:a})}}}}if(l<i.length){r.push({elem:this,handlers:i.slice(l)})}return r},fix:function(e){if(e[b.expando]){return e}var t,i,n,o=e.type,a=e,r=this.fixHooks[o];if(!r){this.fixHooks[o]=r=tt.test(o)?this.mouseHooks:et.test(o)?this.keyHooks:{}}n=r.props?this.props.concat(r.props):this.props;e=new b.Event(a);t=n.length;while(t--){i=n[t];e[i]=a[i]}if(!e.target){e.target=a.srcElement||s}if(e.target.nodeType===3){e.target=e.target.parentNode}e.metaKey=!!e.metaKey;return r.filter?r.filter(e,a):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){if(e.which==null){e.which=t.charCode!=null?t.charCode:t.keyCode}return e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,i){var n,o,a,r=i.button,l=i.fromElement;if(e.pageX==null&&i.clientX!=null){o=e.target.ownerDocument||s;a=o.documentElement;n=o.body;e.pageX=i.clientX+(a&&a.scrollLeft||n&&n.scrollLeft||0)-(a&&a.clientLeft||n&&n.clientLeft||0);e.pageY=i.clientY+(a&&a.scrollTop||n&&n.scrollTop||0)-(a&&a.clientTop||n&&n.clientTop||0)}if(!e.relatedTarget&&l){e.relatedTarget=l===e.target?i.toElement:l}if(!e.which&&r!==t){e.which=r&1?1:r&2?3:r&4?2:0}return e}},special:{load:{noBubble:true},focus:{trigger:function(){if(this!==st()&&this.focus){try{this.focus();return false}catch(e){}}},delegateType:"focusin"},blur:{trigger:function(){if(this===st()&&this.blur){this.blur();return false}},delegateType:"focusout"},click:{trigger:function(){if(b.nodeName(this,"input")&&this.type==="checkbox"&&this.click){this.click();return false}},_default:function(e){return b.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){if(e.result!==t){e.originalEvent.returnValue=e.result}}}},simulate:function(e,t,i,n){var o=b.extend(new b.Event,i,{type:e,isSimulated:true,originalEvent:{}});if(n){b.event.trigger(o,null,t)}else{b.event.dispatch.call(t,o)}if(o.isDefaultPrevented()){i.preventDefault()}}};b.removeEvent=s.removeEventListener?function(e,t,i){if(e.removeEventListener){e.removeEventListener(t,i,false)}}:function(e,t,i){var n="on"+t;if(e.detachEvent){if(typeof e[n]===o){e[n]=null}e.detachEvent(n,i)}};b.Event=function(e,t){if(!(this instanceof b.Event)){return new b.Event(e,t)}if(e&&e.type){this.originalEvent=e;this.type=e.type;this.isDefaultPrevented=e.defaultPrevented||e.returnValue===false||e.getPreventDefault&&e.getPreventDefault()?ot:at}else{this.type=e}if(t){b.extend(this,t)}this.timeStamp=e&&e.timeStamp||b.now();this[b.expando]=true};b.Event.prototype={isDefaultPrevented:at,isPropagationStopped:at,isImmediatePropagationStopped:at,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=ot;if(!e){return}if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=ot;if(!e){return}if(e.stopPropagation){e.stopPropagation()}e.cancelBubble=true},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=ot;this.stopPropagation()}};b.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){b.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,n=this,o=e.relatedTarget,a=e.handleObj;if(!o||o!==n&&!b.contains(n,o)){e.type=a.origType;i=a.handler.apply(this,arguments);e.type=t}return i}}});if(!b.support.submitBubbles){b.event.special.submit={setup:function(){if(b.nodeName(this,"form")){return false}b.event.add(this,"click._submit keypress._submit",function(e){var i=e.target,n=b.nodeName(i,"input")||b.nodeName(i,"button")?i.form:t;if(n&&!b._data(n,"submitBubbles")){b.event.add(n,"submit._submit",function(e){e._submit_bubble=true});b._data(n,"submitBubbles",true)}})},postDispatch:function(e){if(e._submit_bubble){delete e._submit_bubble;if(this.parentNode&&!e.isTrigger){b.event.simulate("submit",this.parentNode,e,true)}}},teardown:function(){if(b.nodeName(this,"form")){return false}b.event.remove(this,"._submit")}}}if(!b.support.changeBubbles){b.event.special.change={setup:function(){if(K.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio"){b.event.add(this,"propertychange._change",function(e){if(e.originalEvent.propertyName==="checked"){this._just_changed=true}});b.event.add(this,"click._change",function(e){if(this._just_changed&&!e.isTrigger){this._just_changed=false}b.event.simulate("change",this,e,true)})}return false}b.event.add(this,"beforeactivate._change",function(e){var t=e.target;if(K.test(t.nodeName)&&!b._data(t,"changeBubbles")){b.event.add(t,"change._change",function(e){if(this.parentNode&&!e.isSimulated&&!e.isTrigger){b.event.simulate("change",this.parentNode,e,true)}});b._data(t,"changeBubbles",true)}})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||t.type!=="radio"&&t.type!=="checkbox"){return e.handleObj.handler.apply(this,arguments)}},teardown:function(){b.event.remove(this,"._change");return!K.test(this.nodeName)}}}if(!b.support.focusinBubbles){b.each({focus:"focusin",blur:"focusout"},function(e,t){var i=0,n=function(e){b.event.simulate(t,e.target,b.event.fix(e),true)};b.event.special[t]={setup:function(){if(i++===0){s.addEventListener(e,n,true)}},teardown:function(){if(--i===0){s.removeEventListener(e,n,true)}}}})}b.fn.extend({on:function(e,i,n,o,a){var s,r;if(typeof e==="object"){if(typeof i!=="string"){n=n||i;i=t}for(s in e){this.on(s,i,n,e[s],a)}return this}if(n==null&&o==null){o=i;n=i=t}else if(o==null){if(typeof i==="string"){o=n;n=t}else{o=n;n=i;i=t}}if(o===false){o=at}else if(!o){return this}if(a===1){r=o;o=function(e){b().off(e);return r.apply(this,arguments)};o.guid=r.guid||(r.guid=b.guid++)}return this.each(function(){b.event.add(this,e,o,n,i)})},one:function(e,t,i,n){return this.on(e,t,i,n,1)},off:function(e,i,n){var o,a;if(e&&e.preventDefault&&e.handleObj){o=e.handleObj;b(e.delegateTarget).off(o.namespace?o.origType+"."+o.namespace:o.origType,o.selector,o.handler);return this}if(typeof e==="object"){for(a in e){this.off(a,i,e[a])}return this}if(i===false||typeof i==="function"){n=i;i=t}if(n===false){n=at}return this.each(function(){b.event.remove(this,e,n,i)})},trigger:function(e,t){return this.each(function(){b.event.trigger(e,t,this)})},triggerHandler:function(e,t){var i=this[0];if(i){return b.event.trigger(e,t,i,true)}}});var rt=/^.[^:#\[\.,]*$/,lt=/^(?:parents|prev(?:Until|All))/,ct=b.expr.match.needsContext,dt={children:true,contents:true,next:true,prev:true};b.fn.extend({find:function(e){var t,i=[],n=this,o=n.length;if(typeof e!=="string"){return this.pushStack(b(e).filter(function(){for(t=0;t<o;t++){if(b.contains(n[t],this)){return true}}}))}for(t=0;t<o;t++){b.find(e,n[t],i)}i=this.pushStack(o>1?b.unique(i):i);i.selector=this.selector?this.selector+" "+e:e;return i},has:function(e){var t,i=b(e,this),n=i.length;return this.filter(function(){for(t=0;t<n;t++){if(b.contains(this,i[t])){return true}}})},not:function(e){return this.pushStack(ft(this,e||[],true))},filter:function(e){return this.pushStack(ft(this,e||[],false))},is:function(e){return!!ft(this,typeof e==="string"&&ct.test(e)?b(e):e||[],false).length},closest:function(e,t){var i,n=0,o=this.length,a=[],s=ct.test(e)||typeof e!=="string"?b(e,t||this.context):0;for(;n<o;n++){for(i=this[n];i&&i!==t;i=i.parentNode){if(i.nodeType<11&&(s?s.index(i)>-1:i.nodeType===1&&b.find.matchesSelector(i,e))){i=a.push(i);break}}}return this.pushStack(a.length>1?b.unique(a):a)},index:function(e){if(!e){return this[0]&&this[0].parentNode?this.first().prevAll().length:-1}if(typeof e==="string"){return b.inArray(this[0],b(e))}return b.inArray(e.jquery?e[0]:e,this)},add:function(e,t){var i=typeof e==="string"?b(e,t):b.makeArray(e&&e.nodeType?[e]:e),n=b.merge(this.get(),i);return this.pushStack(b.unique(n))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}});function ut(e,t){do{e=e[t]}while(e&&e.nodeType!==1);return e}b.each({parent:function(e){var t=e.parentNode;return t&&t.nodeType!==11?t:null},parents:function(e){return b.dir(e,"parentNode")},parentsUntil:function(e,t,i){return b.dir(e,"parentNode",i)},next:function(e){return ut(e,"nextSibling")},prev:function(e){return ut(e,"previousSibling")},nextAll:function(e){return b.dir(e,"nextSibling")},prevAll:function(e){return b.dir(e,"previousSibling")},nextUntil:function(e,t,i){return b.dir(e,"nextSibling",i)},prevUntil:function(e,t,i){return b.dir(e,"previousSibling",i)},siblings:function(e){return b.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return b.sibling(e.firstChild)},contents:function(e){return b.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:b.merge([],e.childNodes)}},function(e,t){b.fn[e]=function(i,n){var o=b.map(this,t,i);if(e.slice(-5)!=="Until"){n=i}if(n&&typeof n==="string"){o=b.filter(n,o)}if(this.length>1){if(!dt[e]){o=b.unique(o)}if(lt.test(e)){o=o.reverse()}}return this.pushStack(o)}});b.extend({filter:function(e,t,i){var n=t[0];if(i){e=":not("+e+")"}return t.length===1&&n.nodeType===1?b.find.matchesSelector(n,e)?[n]:[]:b.find.matches(e,b.grep(t,function(e){return e.nodeType===1}))},dir:function(e,i,n){var o=[],a=e[i];while(a&&a.nodeType!==9&&(n===t||a.nodeType!==1||!b(a).is(n))){if(a.nodeType===1){o.push(a)}a=a[i]}return o},sibling:function(e,t){var i=[];for(;e;e=e.nextSibling){if(e.nodeType===1&&e!==t){i.push(e)}}return i}});function ft(e,t,i){if(b.isFunction(t)){return b.grep(e,function(e,n){return!!t.call(e,n,e)!==i})}if(t.nodeType){return b.grep(e,function(e){return e===t!==i})}if(typeof t==="string"){if(rt.test(t)){return b.filter(t,e,i)}t=b.filter(t,e)}return b.grep(e,function(e){return b.inArray(e,t)>=0!==i})}function ht(e){var t=gt.split("|"),i=e.createDocumentFragment();if(i.createElement){while(t.length){i.createElement(t.pop())}}return i}var gt="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|"+"header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",pt=/ jQuery\d+="(?:null|\d+)"/g,mt=new RegExp("<(?:"+gt+")[\\s/>]","i"),vt=/^\s+/,_t=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,wt=/<([\w:]+)/,bt=/<tbody/i,yt=/<|&#?\w+;/,Ct=/<(?:script|style|link)/i,jt=/^(?:checkbox|radio)$/i,xt=/checked\s*(?:[^=]|=\s*.checked.)/i,Et=/^$|\/(?:java|ecma)script/i,kt=/^true\/(.*)/,Tt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,It={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:b.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},St=ht(s),Mt=St.appendChild(s.createElement("div"));It.optgroup=It.option;It.tbody=It.tfoot=It.colgroup=It.caption=It.thead;It.th=It.td;b.fn.extend({text:function(e){return b.access(this,function(e){return e===t?b.text(this):this.empty().append((this[0]&&this[0].ownerDocument||s).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=Nt(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=Nt(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){if(this.parentNode){this.parentNode.insertBefore(e,this)}})},after:function(){return this.domManip(arguments,function(e){if(this.parentNode){this.parentNode.insertBefore(e,this.nextSibling)}})},remove:function(e,t){var i,n=e?b.filter(e,this):this,o=0;for(;(i=n[o])!=null;o++){if(!t&&i.nodeType===1){b.cleanData(Pt(i))}if(i.parentNode){if(t&&b.contains(i.ownerDocument,i)){Lt(Pt(i,"script"))}i.parentNode.removeChild(i)}}return this},empty:function(){var e,t=0;for(;(e=this[t])!=null;t++){if(e.nodeType===1){b.cleanData(Pt(e,false))}while(e.firstChild){e.removeChild(e.firstChild)}if(e.options&&b.nodeName(e,"select")){e.options.length=0}}return this},clone:function(e,t){e=e==null?false:e;t=t==null?e:t;return this.map(function(){return b.clone(this,e,t)})},html:function(e){return b.access(this,function(e){var i=this[0]||{},n=0,o=this.length;if(e===t){return i.nodeType===1?i.innerHTML.replace(pt,""):t}if(typeof e==="string"&&!Ct.test(e)&&(b.support.htmlSerialize||!mt.test(e))&&(b.support.leadingWhitespace||!vt.test(e))&&!It[(wt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(_t,"<$1></$2>");try{for(;n<o;n++){i=this[n]||{};if(i.nodeType===1){b.cleanData(Pt(i,false));i.innerHTML=e}}i=0}catch(a){}}if(i){this.empty().append(e)}},null,e,arguments.length)},replaceWith:function(){var e=b.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;this.domManip(arguments,function(i){var n=e[t++],o=e[t++];if(o){if(n&&n.parentNode!==o){n=this.nextSibling}b(this).remove();o.insertBefore(i,n)}},true);return t?this:this.remove()},detach:function(e){return this.remove(e,true)},domManip:function(e,t,i){e=h.apply([],e);var n,o,a,s,r,l,c=0,d=this.length,u=this,f=d-1,g=e[0],p=b.isFunction(g);if(p||!(d<=1||typeof g!=="string"||b.support.checkClone||!xt.test(g))){return this.each(function(n){var o=u.eq(n);if(p){e[0]=g.call(this,n,o.html())}o.domManip(e,t,i)})}if(d){l=b.buildFragment(e,this[0].ownerDocument,false,!i&&this);n=l.firstChild;if(l.childNodes.length===1){l=n}if(n){s=b.map(Pt(l,"script"),At);a=s.length;for(;c<d;c++){o=l;if(c!==f){o=b.clone(o,true,true);if(a){b.merge(s,Pt(o,"script"))}}t.call(this[c],o,c)}if(a){r=s[s.length-1].ownerDocument;b.map(s,Ot);for(c=0;c<a;c++){o=s[c];if(Et.test(o.type||"")&&!b._data(o,"globalEval")&&b.contains(r,o)){if(o.src){b._evalUrl(o.src)}else{b.globalEval((o.text||o.textContent||o.innerHTML||"").replace(Tt,""))}}}}l=n=null}}return this}});function Nt(e,t){return b.nodeName(e,"table")&&b.nodeName(t.nodeType===1?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function At(e){e.type=(b.find.attr(e,"type")!==null)+"/"+e.type;return e}function Ot(e){var t=kt.exec(e.type);if(t){e.type=t[1]}else{e.removeAttribute("type")}return e}function Lt(e,t){var i,n=0;for(;(i=e[n])!=null;n++){b._data(i,"globalEval",!t||b._data(t[n],"globalEval"))}}function Dt(e,t){if(t.nodeType!==1||!b.hasData(e)){return}var i,n,o,a=b._data(e),s=b._data(t,a),r=a.events;if(r){delete s.handle;s.events={};for(i in r){for(n=0,o=r[i].length;n<o;n++){b.event.add(t,i,r[i][n])}}}if(s.data){s.data=b.extend({},s.data)}}function Ht(e,t){var i,n,o;if(t.nodeType!==1){return}i=t.nodeName.toLowerCase();if(!b.support.noCloneEvent&&t[b.expando]){o=b._data(t);for(n in o.events){b.removeEvent(t,n,o.handle)}t.removeAttribute(b.expando)}if(i==="script"&&t.text!==e.text){At(t).text=e.text;Ot(t)}else if(i==="object"){if(t.parentNode){t.outerHTML=e.outerHTML}if(b.support.html5Clone&&(e.innerHTML&&!b.trim(t.innerHTML))){t.innerHTML=e.innerHTML}}else if(i==="input"&&jt.test(e.type)){t.defaultChecked=t.checked=e.checked;
if(t.value!==e.value){t.value=e.value}}else if(i==="option"){t.defaultSelected=t.selected=e.defaultSelected}else if(i==="input"||i==="textarea"){t.defaultValue=e.defaultValue}}b.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){b.fn[e]=function(e){var i,n=0,o=[],a=b(e),s=a.length-1;for(;n<=s;n++){i=n===s?this:this.clone(true);b(a[n])[t](i);g.apply(o,i.get())}return this.pushStack(o)}});function Pt(e,i){var n,a,s=0,r=typeof e.getElementsByTagName!==o?e.getElementsByTagName(i||"*"):typeof e.querySelectorAll!==o?e.querySelectorAll(i||"*"):t;if(!r){for(r=[],n=e.childNodes||e;(a=n[s])!=null;s++){if(!i||b.nodeName(a,i)){r.push(a)}else{b.merge(r,Pt(a,i))}}}return i===t||i&&b.nodeName(e,i)?b.merge([e],r):r}function Ft(e){if(jt.test(e.type)){e.defaultChecked=e.checked}}b.extend({clone:function(e,t,i){var n,o,a,s,r,l=b.contains(e.ownerDocument,e);if(b.support.html5Clone||b.isXMLDoc(e)||!mt.test("<"+e.nodeName+">")){a=e.cloneNode(true)}else{Mt.innerHTML=e.outerHTML;Mt.removeChild(a=Mt.firstChild)}if((!b.support.noCloneEvent||!b.support.noCloneChecked)&&(e.nodeType===1||e.nodeType===11)&&!b.isXMLDoc(e)){n=Pt(a);r=Pt(e);for(s=0;(o=r[s])!=null;++s){if(n[s]){Ht(o,n[s])}}}if(t){if(i){r=r||Pt(e);n=n||Pt(a);for(s=0;(o=r[s])!=null;s++){Dt(o,n[s])}}else{Dt(e,a)}}n=Pt(a,"script");if(n.length>0){Lt(n,!l&&Pt(e,"script"))}n=r=o=null;return a},buildFragment:function(e,t,i,n){var o,a,s,r,l,c,d,u=e.length,f=ht(t),h=[],g=0;for(;g<u;g++){a=e[g];if(a||a===0){if(b.type(a)==="object"){b.merge(h,a.nodeType?[a]:a)}else if(!yt.test(a)){h.push(t.createTextNode(a))}else{r=r||f.appendChild(t.createElement("div"));l=(wt.exec(a)||["",""])[1].toLowerCase();d=It[l]||It._default;r.innerHTML=d[1]+a.replace(_t,"<$1></$2>")+d[2];o=d[0];while(o--){r=r.lastChild}if(!b.support.leadingWhitespace&&vt.test(a)){h.push(t.createTextNode(vt.exec(a)[0]))}if(!b.support.tbody){a=l==="table"&&!bt.test(a)?r.firstChild:d[1]==="<table>"&&!bt.test(a)?r:0;o=a&&a.childNodes.length;while(o--){if(b.nodeName(c=a.childNodes[o],"tbody")&&!c.childNodes.length){a.removeChild(c)}}}b.merge(h,r.childNodes);r.textContent="";while(r.firstChild){r.removeChild(r.firstChild)}r=f.lastChild}}}if(r){f.removeChild(r)}if(!b.support.appendChecked){b.grep(Pt(h,"input"),Ft)}g=0;while(a=h[g++]){if(n&&b.inArray(a,n)!==-1){continue}s=b.contains(a.ownerDocument,a);r=Pt(f.appendChild(a),"script");if(s){Lt(r)}if(i){o=0;while(a=r[o++]){if(Et.test(a.type||"")){i.push(a)}}}}r=null;return f},cleanData:function(e,t){var i,n,a,s,r=0,l=b.expando,c=b.cache,d=b.support.deleteExpando,f=b.event.special;for(;(i=e[r])!=null;r++){if(t||b.acceptData(i)){a=i[l];s=a&&c[a];if(s){if(s.events){for(n in s.events){if(f[n]){b.event.remove(i,n)}else{b.removeEvent(i,n,s.handle)}}}if(c[a]){delete c[a];if(d){delete i[l]}else if(typeof i.removeAttribute!==o){i.removeAttribute(l)}else{i[l]=null}u.push(a)}}}}},_evalUrl:function(e){return b.ajax({url:e,type:"GET",dataType:"script",async:false,global:false,"throws":true})}});b.fn.extend({wrapAll:function(e){if(b.isFunction(e)){return this.each(function(t){b(this).wrapAll(e.call(this,t))})}if(this[0]){var t=b(e,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){t.insertBefore(this[0])}t.map(function(){var e=this;while(e.firstChild&&e.firstChild.nodeType===1){e=e.firstChild}return e}).append(this)}return this},wrapInner:function(e){if(b.isFunction(e)){return this.each(function(t){b(this).wrapInner(e.call(this,t))})}return this.each(function(){var t=b(this),i=t.contents();if(i.length){i.wrapAll(e)}else{t.append(e)}})},wrap:function(e){var t=b.isFunction(e);return this.each(function(i){b(this).wrapAll(t?e.call(this,i):e)})},unwrap:function(){return this.parent().each(function(){if(!b.nodeName(this,"body")){b(this).replaceWith(this.childNodes)}}).end()}});var Bt,Wt,Rt,$t=/alpha\([^)]*\)/i,Vt=/opacity\s*=\s*([^)]*)/,zt=/^(top|right|bottom|left)$/,qt=/^(none|table(?!-c[ea]).+)/,Gt=/^margin/,Ut=new RegExp("^("+y+")(.*)$","i"),Jt=new RegExp("^("+y+")(?!px)[a-z%]+$","i"),Yt=new RegExp("^([+-])=("+y+")","i"),Xt={BODY:"block"},Qt={position:"absolute",visibility:"hidden",display:"block"},Zt={letterSpacing:0,fontWeight:400},Kt=["Top","Right","Bottom","Left"],ei=["Webkit","O","Moz","ms"];function ti(e,t){if(t in e){return t}var i=t.charAt(0).toUpperCase()+t.slice(1),n=t,o=ei.length;while(o--){t=ei[o]+i;if(t in e){return t}}return n}function ii(e,t){e=t||e;return b.css(e,"display")==="none"||!b.contains(e.ownerDocument,e)}function ni(e,t){var i,n,o,a=[],s=0,r=e.length;for(;s<r;s++){n=e[s];if(!n.style){continue}a[s]=b._data(n,"olddisplay");i=n.style.display;if(t){if(!a[s]&&i==="none"){n.style.display=""}if(n.style.display===""&&ii(n)){a[s]=b._data(n,"olddisplay",ri(n.nodeName))}}else{if(!a[s]){o=ii(n);if(i&&i!=="none"||!o){b._data(n,"olddisplay",o?i:b.css(n,"display"))}}}}for(s=0;s<r;s++){n=e[s];if(!n.style){continue}if(!t||n.style.display==="none"||n.style.display===""){n.style.display=t?a[s]||"":"none"}}return e}b.fn.extend({css:function(e,i){return b.access(this,function(e,i,n){var o,a,s={},r=0;if(b.isArray(i)){a=Wt(e);o=i.length;for(;r<o;r++){s[i[r]]=b.css(e,i[r],false,a)}return s}return n!==t?b.style(e,i,n):b.css(e,i)},e,i,arguments.length>1)},show:function(){return ni(this,true)},hide:function(){return ni(this)},toggle:function(e){if(typeof e==="boolean"){return e?this.show():this.hide()}return this.each(function(){if(ii(this)){b(this).show()}else{b(this).hide()}})}});b.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=Rt(e,"opacity");return i===""?"1":i}}}},cssNumber:{columnCount:true,fillOpacity:true,fontWeight:true,lineHeight:true,opacity:true,order:true,orphans:true,widows:true,zIndex:true,zoom:true},cssProps:{"float":b.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,i,n,o){if(!e||e.nodeType===3||e.nodeType===8||!e.style){return}var a,s,r,l=b.camelCase(i),c=e.style;i=b.cssProps[l]||(b.cssProps[l]=ti(c,l));r=b.cssHooks[i]||b.cssHooks[l];if(n!==t){s=typeof n;if(s==="string"&&(a=Yt.exec(n))){n=(a[1]+1)*a[2]+parseFloat(b.css(e,i));s="number"}if(n==null||s==="number"&&isNaN(n)){return}if(s==="number"&&!b.cssNumber[l]){n+="px"}if(!b.support.clearCloneStyle&&n===""&&i.indexOf("background")===0){c[i]="inherit"}if(!r||!("set"in r)||(n=r.set(e,n,o))!==t){try{c[i]=n}catch(d){}}}else{if(r&&"get"in r&&(a=r.get(e,false,o))!==t){return a}return c[i]}},css:function(e,i,n,o){var a,s,r,l=b.camelCase(i);i=b.cssProps[l]||(b.cssProps[l]=ti(e.style,l));r=b.cssHooks[i]||b.cssHooks[l];if(r&&"get"in r){s=r.get(e,true,n)}if(s===t){s=Rt(e,i,o)}if(s==="normal"&&i in Zt){s=Zt[i]}if(n===""||n){a=parseFloat(s);return n===true||b.isNumeric(a)?a||0:s}return s}});if(e.getComputedStyle){Wt=function(t){return e.getComputedStyle(t,null)};Rt=function(e,i,n){var o,a,s,r=n||Wt(e),l=r?r.getPropertyValue(i)||r[i]:t,c=e.style;if(r){if(l===""&&!b.contains(e.ownerDocument,e)){l=b.style(e,i)}if(Jt.test(l)&&Gt.test(i)){o=c.width;a=c.minWidth;s=c.maxWidth;c.minWidth=c.maxWidth=c.width=l;l=r.width;c.width=o;c.minWidth=a;c.maxWidth=s}}return l}}else if(s.documentElement.currentStyle){Wt=function(e){return e.currentStyle};Rt=function(e,i,n){var o,a,s,r=n||Wt(e),l=r?r[i]:t,c=e.style;if(l==null&&c&&c[i]){l=c[i]}if(Jt.test(l)&&!zt.test(i)){o=c.left;a=e.runtimeStyle;s=a&&a.left;if(s){a.left=e.currentStyle.left}c.left=i==="fontSize"?"1em":l;l=c.pixelLeft+"px";c.left=o;if(s){a.left=s}}return l===""?"auto":l}}function oi(e,t,i){var n=Ut.exec(t);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):t}function ai(e,t,i,n,o){var a=i===(n?"border":"content")?4:t==="width"?1:0,s=0;for(;a<4;a+=2){if(i==="margin"){s+=b.css(e,i+Kt[a],true,o)}if(n){if(i==="content"){s-=b.css(e,"padding"+Kt[a],true,o)}if(i!=="margin"){s-=b.css(e,"border"+Kt[a]+"Width",true,o)}}else{s+=b.css(e,"padding"+Kt[a],true,o);if(i!=="padding"){s+=b.css(e,"border"+Kt[a]+"Width",true,o)}}}return s}function si(e,t,i){var n=true,o=t==="width"?e.offsetWidth:e.offsetHeight,a=Wt(e),s=b.support.boxSizing&&b.css(e,"boxSizing",false,a)==="border-box";if(o<=0||o==null){o=Rt(e,t,a);if(o<0||o==null){o=e.style[t]}if(Jt.test(o)){return o}n=s&&(b.support.boxSizingReliable||o===e.style[t]);o=parseFloat(o)||0}return o+ai(e,t,i||(s?"border":"content"),n,a)+"px"}function ri(e){var t=s,i=Xt[e];if(!i){i=li(e,t);if(i==="none"||!i){Bt=(Bt||b("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement);t=(Bt[0].contentWindow||Bt[0].contentDocument).document;t.write("<!doctype html><html><body>");t.close();i=li(e,t);Bt.detach()}Xt[e]=i}return i}function li(e,t){var i=b(t.createElement(e)).appendTo(t.body),n=b.css(i[0],"display");i.remove();return n}b.each(["height","width"],function(e,t){b.cssHooks[t]={get:function(e,i,n){if(i){return e.offsetWidth===0&&qt.test(b.css(e,"display"))?b.swap(e,Qt,function(){return si(e,t,n)}):si(e,t,n)}},set:function(e,i,n){var o=n&&Wt(e);return oi(e,i,n?ai(e,t,n,b.support.boxSizing&&b.css(e,"boxSizing",false,o)==="border-box",o):0)}}});if(!b.support.opacity){b.cssHooks.opacity={get:function(e,t){return Vt.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var i=e.style,n=e.currentStyle,o=b.isNumeric(t)?"alpha(opacity="+t*100+")":"",a=n&&n.filter||i.filter||"";i.zoom=1;if((t>=1||t==="")&&b.trim(a.replace($t,""))===""&&i.removeAttribute){i.removeAttribute("filter");if(t===""||n&&!n.filter){return}}i.filter=$t.test(a)?a.replace($t,o):a+" "+o}}}b(function(){if(!b.support.reliableMarginRight){b.cssHooks.marginRight={get:function(e,t){if(t){return b.swap(e,{display:"inline-block"},Rt,[e,"marginRight"])}}}}if(!b.support.pixelPosition&&b.fn.position){b.each(["top","left"],function(e,t){b.cssHooks[t]={get:function(e,i){if(i){i=Rt(e,t);return Jt.test(i)?b(e).position()[t]+"px":i}}}})}});if(b.expr&&b.expr.filters){b.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0||!b.support.reliableHiddenOffsets&&(e.style&&e.style.display||b.css(e,"display"))==="none"};b.expr.filters.visible=function(e){return!b.expr.filters.hidden(e)}}b.each({margin:"",padding:"",border:"Width"},function(e,t){b.cssHooks[e+t]={expand:function(i){var n=0,o={},a=typeof i==="string"?i.split(" "):[i];for(;n<4;n++){o[e+Kt[n]+t]=a[n]||a[n-2]||a[0]}return o}};if(!Gt.test(e)){b.cssHooks[e+t].set=oi}});var ci=/%20/g,di=/\[\]$/,ui=/\r?\n/g,fi=/^(?:submit|button|image|reset|file)$/i,hi=/^(?:input|select|textarea|keygen)/i;b.fn.extend({serialize:function(){return b.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=b.prop(this,"elements");return e?b.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!b(this).is(":disabled")&&hi.test(this.nodeName)&&!fi.test(e)&&(this.checked||!jt.test(e))}).map(function(e,t){var i=b(this).val();return i==null?null:b.isArray(i)?b.map(i,function(e){return{name:t.name,value:e.replace(ui,"\r\n")}}):{name:t.name,value:i.replace(ui,"\r\n")}}).get()}});b.param=function(e,i){var n,o=[],a=function(e,t){t=b.isFunction(t)?t():t==null?"":t;o[o.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(i===t){i=b.ajaxSettings&&b.ajaxSettings.traditional}if(b.isArray(e)||e.jquery&&!b.isPlainObject(e)){b.each(e,function(){a(this.name,this.value)})}else{for(n in e){gi(n,e[n],i,a)}}return o.join("&").replace(ci,"+")};function gi(e,t,i,n){var o;if(b.isArray(t)){b.each(t,function(t,o){if(i||di.test(e)){n(e,o)}else{gi(e+"["+(typeof o==="object"?t:"")+"]",o,i,n)}})}else if(!i&&b.type(t)==="object"){for(o in t){gi(e+"["+o+"]",t[o],i,n)}}else{n(e,t)}}b.each(("blur focus focusin focusout load resize scroll unload click dblclick "+"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave "+"change select submit keydown keypress keyup error contextmenu").split(" "),function(e,t){b.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}});b.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,n){return this.on(t,e,i,n)},undelegate:function(e,t,i){return arguments.length===1?this.off(e,"**"):this.off(t,e||"**",i)}});var pi,mi,vi=b.now(),_i=/\?/,wi=/#.*$/,bi=/([?&])_=[^&]*/,yi=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Ci=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,ji=/^(?:GET|HEAD)$/,xi=/^\/\//,Ei=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,ki=b.fn.load,Ti={},Ii={},Si="*/".concat("*");try{mi=a.href}catch(Mi){mi=s.createElement("a");mi.href="";mi=mi.href}pi=Ei.exec(mi.toLowerCase())||[];function Ni(e){return function(t,i){if(typeof t!=="string"){i=t;t="*"}var n,o=0,a=t.toLowerCase().match(C)||[];if(b.isFunction(i)){while(n=a[o++]){if(n[0]==="+"){n=n.slice(1)||"*";(e[n]=e[n]||[]).unshift(i)}else{(e[n]=e[n]||[]).push(i)}}}}}function Ai(e,t,i,n){var o={},a=e===Ii;function s(r){var l;o[r]=true;b.each(e[r]||[],function(e,r){var c=r(t,i,n);if(typeof c==="string"&&!a&&!o[c]){t.dataTypes.unshift(c);s(c);return false}else if(a){return!(l=c)}});return l}return s(t.dataTypes[0])||!o["*"]&&s("*")}function Oi(e,i){var n,o,a=b.ajaxSettings.flatOptions||{};for(o in i){if(i[o]!==t){(a[o]?e:n||(n={}))[o]=i[o]}}if(n){b.extend(true,e,n)}return e}b.fn.load=function(e,i,n){if(typeof e!=="string"&&ki){return ki.apply(this,arguments)}var o,a,s,r=this,l=e.indexOf(" ");if(l>=0){o=e.slice(l,e.length);e=e.slice(0,l)}if(b.isFunction(i)){n=i;i=t}else if(i&&typeof i==="object"){s="POST"}if(r.length>0){b.ajax({url:e,type:s,dataType:"html",data:i}).done(function(e){a=arguments;r.html(o?b("<div>").append(b.parseHTML(e)).find(o):e)}).complete(n&&function(e,t){r.each(n,a||[e.responseText,t,e])})}return this};b.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){b.fn[t]=function(e){return this.on(t,e)}});b.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:mi,type:"GET",isLocal:Ci.test(pi[1]),global:true,processData:true,async:true,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Si,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":true,"text json":b.parseJSON,"text xml":b.parseXML},flatOptions:{url:true,context:true}},ajaxSetup:function(e,t){return t?Oi(Oi(e,b.ajaxSettings),t):Oi(b.ajaxSettings,e)},ajaxPrefilter:Ni(Ti),ajaxTransport:Ni(Ii),ajax:function(e,i){if(typeof e==="object"){i=e;e=t}i=i||{};var n,o,a,s,r,l,c,d,u=b.ajaxSetup({},i),f=u.context||u,h=u.context&&(f.nodeType||f.jquery)?b(f):b.event,g=b.Deferred(),p=b.Callbacks("once memory"),m=u.statusCode||{},v={},_={},w=0,y="canceled",j={readyState:0,getResponseHeader:function(e){var t;if(w===2){if(!d){d={};while(t=yi.exec(s)){d[t[1].toLowerCase()]=t[2]}}t=d[e.toLowerCase()]}return t==null?null:t},getAllResponseHeaders:function(){return w===2?s:null},setRequestHeader:function(e,t){var i=e.toLowerCase();if(!w){e=_[i]=_[i]||e;v[e]=t}return this},overrideMimeType:function(e){if(!w){u.mimeType=e}return this},statusCode:function(e){var t;if(e){if(w<2){for(t in e){m[t]=[m[t],e[t]]}}else{j.always(e[j.status])}}return this},abort:function(e){var t=e||y;if(c){c.abort(t)}E(0,t);return this}};g.promise(j).complete=p.add;j.success=j.done;j.error=j.fail;u.url=((e||u.url||mi)+"").replace(wi,"").replace(xi,pi[1]+"//");u.type=i.method||i.type||u.method||u.type;u.dataTypes=b.trim(u.dataType||"*").toLowerCase().match(C)||[""];if(u.crossDomain==null){n=Ei.exec(u.url.toLowerCase());u.crossDomain=!!(n&&(n[1]!==pi[1]||n[2]!==pi[2]||(n[3]||(n[1]==="http:"?"80":"443"))!==(pi[3]||(pi[1]==="http:"?"80":"443"))))}if(u.data&&u.processData&&typeof u.data!=="string"){u.data=b.param(u.data,u.traditional)}Ai(Ti,u,i,j);if(w===2){return j}l=u.global;if(l&&b.active++===0){b.event.trigger("ajaxStart")}u.type=u.type.toUpperCase();u.hasContent=!ji.test(u.type);a=u.url;if(!u.hasContent){if(u.data){a=u.url+=(_i.test(a)?"&":"?")+u.data;delete u.data}if(u.cache===false){u.url=bi.test(a)?a.replace(bi,"$1_="+vi++):a+(_i.test(a)?"&":"?")+"_="+vi++}}if(u.ifModified){if(b.lastModified[a]){j.setRequestHeader("If-Modified-Since",b.lastModified[a])}if(b.etag[a]){j.setRequestHeader("If-None-Match",b.etag[a])}}if(u.data&&u.hasContent&&u.contentType!==false||i.contentType){j.setRequestHeader("Content-Type",u.contentType)}j.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?u.accepts[u.dataTypes[0]]+(u.dataTypes[0]!=="*"?", "+Si+"; q=0.01":""):u.accepts["*"]);for(o in u.headers){j.setRequestHeader(o,u.headers[o])}if(u.beforeSend&&(u.beforeSend.call(f,j,u)===false||w===2)){return j.abort()}y="abort";for(o in{success:1,error:1,complete:1}){j[o](u[o])}c=Ai(Ii,u,i,j);if(!c){E(-1,"No Transport")}else{j.readyState=1;if(l){h.trigger("ajaxSend",[j,u])}if(u.async&&u.timeout>0){r=setTimeout(function(){j.abort("timeout")},u.timeout)}try{w=1;c.send(v,E)}catch(x){if(w<2){E(-1,x)}else{throw x}}}function E(e,i,n,o){var d,v,_,y,C,x=i;if(w===2){return}w=2;if(r){clearTimeout(r)}c=t;s=o||"";j.readyState=e>0?4:0;d=e>=200&&e<300||e===304;if(n){y=Li(u,j,n)}y=Di(u,y,j,d);if(d){if(u.ifModified){C=j.getResponseHeader("Last-Modified");if(C){b.lastModified[a]=C}C=j.getResponseHeader("etag");if(C){b.etag[a]=C}}if(e===204||u.type==="HEAD"){x="nocontent"}else if(e===304){x="notmodified"}else{x=y.state;v=y.data;_=y.error;d=!_}}else{_=x;if(e||!x){x="error";if(e<0){e=0}}}j.status=e;j.statusText=(i||x)+"";if(d){g.resolveWith(f,[v,x,j])}else{g.rejectWith(f,[j,x,_])}j.statusCode(m);m=t;if(l){h.trigger(d?"ajaxSuccess":"ajaxError",[j,u,d?v:_])}p.fireWith(f,[j,x]);if(l){h.trigger("ajaxComplete",[j,u]);if(!--b.active){b.event.trigger("ajaxStop")}}}return j},getJSON:function(e,t,i){return b.get(e,t,i,"json")},getScript:function(e,i){return b.get(e,t,i,"script")}});b.each(["get","post"],function(e,i){b[i]=function(e,n,o,a){if(b.isFunction(n)){a=a||o;o=n;n=t}return b.ajax({url:e,type:i,dataType:a,data:n,success:o})}});function Li(e,i,n){var o,a,s,r,l=e.contents,c=e.dataTypes;while(c[0]==="*"){c.shift();if(a===t){a=e.mimeType||i.getResponseHeader("Content-Type")}}if(a){for(r in l){if(l[r]&&l[r].test(a)){c.unshift(r);break}}}if(c[0]in n){s=c[0]}else{for(r in n){if(!c[0]||e.converters[r+" "+c[0]]){s=r;break}if(!o){o=r}}s=s||o}if(s){if(s!==c[0]){c.unshift(s)}return n[s]}}function Di(e,t,i,n){var o,a,s,r,l,c={},d=e.dataTypes.slice();if(d[1]){for(s in e.converters){c[s.toLowerCase()]=e.converters[s]}}a=d.shift();while(a){if(e.responseFields[a]){i[e.responseFields[a]]=t}if(!l&&n&&e.dataFilter){t=e.dataFilter(t,e.dataType)}l=a;a=d.shift();if(a){if(a==="*"){a=l}else if(l!=="*"&&l!==a){s=c[l+" "+a]||c["* "+a];if(!s){for(o in c){r=o.split(" ");if(r[1]===a){s=c[l+" "+r[0]]||c["* "+r[0]];if(s){if(s===true){s=c[o]}else if(c[o]!==true){a=r[0];d.unshift(r[1])}break}}}}if(s!==true){if(s&&e["throws"]){t=s(t)}else{try{t=s(t)}catch(u){return{state:"parsererror",error:s?u:"No conversion from "+l+" to "+a}}}}}}}return{state:"success",data:t}}b.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){b.globalEval(e);return e}}});b.ajaxPrefilter("script",function(e){if(e.cache===t){e.cache=false}if(e.crossDomain){e.type="GET";e.global=false}});b.ajaxTransport("script",function(e){if(e.crossDomain){var i,n=s.head||b("head")[0]||s.documentElement;return{send:function(t,o){i=s.createElement("script");i.async=true;if(e.scriptCharset){i.charset=e.scriptCharset}i.src=e.url;i.onload=i.onreadystatechange=function(e,t){if(t||!i.readyState||/loaded|complete/.test(i.readyState)){i.onload=i.onreadystatechange=null;if(i.parentNode){i.parentNode.removeChild(i)}i=null;if(!t){o(200,"success")}}};n.insertBefore(i,n.firstChild)},abort:function(){if(i){i.onload(t,true)}}}}});var Hi=[],Pi=/(=)\?(?=&|$)|\?\?/;b.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Hi.pop()||b.expando+"_"+vi++;this[e]=true;return e}});b.ajaxPrefilter("json jsonp",function(i,n,o){var a,s,r,l=i.jsonp!==false&&(Pi.test(i.url)?"url":typeof i.data==="string"&&!(i.contentType||"").indexOf("application/x-www-form-urlencoded")&&Pi.test(i.data)&&"data");if(l||i.dataTypes[0]==="jsonp"){a=i.jsonpCallback=b.isFunction(i.jsonpCallback)?i.jsonpCallback():i.jsonpCallback;if(l){i[l]=i[l].replace(Pi,"$1"+a)}else if(i.jsonp!==false){i.url+=(_i.test(i.url)?"&":"?")+i.jsonp+"="+a}i.converters["script json"]=function(){if(!r){b.error(a+" was not called")}return r[0]};i.dataTypes[0]="json";s=e[a];e[a]=function(){r=arguments};o.always(function(){e[a]=s;if(i[a]){i.jsonpCallback=n.jsonpCallback;Hi.push(a)}if(r&&b.isFunction(s)){s(r[0])}r=s=t});return"script"}});var Fi,Bi,Wi=0,Ri=e.ActiveXObject&&function(){var e;for(e in Fi){Fi[e](t,true)}};function $i(){try{return new e.XMLHttpRequest}catch(t){}}function Vi(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}b.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&$i()||Vi()}:$i;Bi=b.ajaxSettings.xhr();b.support.cors=!!Bi&&"withCredentials"in Bi;Bi=b.support.ajax=!!Bi;if(Bi){b.ajaxTransport(function(i){if(!i.crossDomain||b.support.cors){var n;return{send:function(o,a){var s,r,l=i.xhr();if(i.username){l.open(i.type,i.url,i.async,i.username,i.password)}else{l.open(i.type,i.url,i.async)}if(i.xhrFields){for(r in i.xhrFields){l[r]=i.xhrFields[r]}}if(i.mimeType&&l.overrideMimeType){l.overrideMimeType(i.mimeType)}if(!i.crossDomain&&!o["X-Requested-With"]){o["X-Requested-With"]="XMLHttpRequest"}try{for(r in o){l.setRequestHeader(r,o[r])}}catch(c){}l.send(i.hasContent&&i.data||null);n=function(e,o){var r,c,d,u;try{if(n&&(o||l.readyState===4)){n=t;if(s){l.onreadystatechange=b.noop;if(Ri){delete Fi[s]}}if(o){if(l.readyState!==4){l.abort()}}else{u={};r=l.status;c=l.getAllResponseHeaders();if(typeof l.responseText==="string"){u.text=l.responseText}try{d=l.statusText}catch(f){d=""}if(!r&&i.isLocal&&!i.crossDomain){r=u.text?200:404}else if(r===1223){r=204}}}}catch(h){if(!o){a(-1,h)}}if(u){a(r,d,u,c)}};if(!i.async){n()}else if(l.readyState===4){setTimeout(n)}else{s=++Wi;if(Ri){if(!Fi){Fi={};b(e).unload(Ri)}Fi[s]=n}l.onreadystatechange=n}},abort:function(){if(n){n(t,true)}}}}})}var zi,qi,Gi=/^(?:toggle|show|hide)$/,Ui=new RegExp("^(?:([+-])=|)("+y+")([a-z%]*)$","i"),Ji=/queueHooks$/,Yi=[tn],Xi={"*":[function(e,t){var i=this.createTween(e,t),n=i.cur(),o=Ui.exec(t),a=o&&o[3]||(b.cssNumber[e]?"":"px"),s=(b.cssNumber[e]||a!=="px"&&+n)&&Ui.exec(b.css(i.elem,e)),r=1,l=20;if(s&&s[3]!==a){a=a||s[3];o=o||[];s=+n||1;do{r=r||".5";s=s/r;b.style(i.elem,e,s+a)}while(r!==(r=i.cur()/n)&&r!==1&&--l)}if(o){s=i.start=+s||+n||0;i.unit=a;i.end=o[1]?s+(o[1]+1)*o[2]:+o[2]}return i}]};function Qi(){setTimeout(function(){zi=t});return zi=b.now()}function Zi(e,t,i){var n,o=(Xi[t]||[]).concat(Xi["*"]),a=0,s=o.length;for(;a<s;a++){if(n=o[a].call(i,t,e)){return n}}}function Ki(e,t,i){var n,o,a=0,s=Yi.length,r=b.Deferred().always(function(){delete l.elem}),l=function(){if(o){return false}var t=zi||Qi(),i=Math.max(0,c.startTime+c.duration-t),n=i/c.duration||0,a=1-n,s=0,l=c.tweens.length;for(;s<l;s++){c.tweens[s].run(a)}r.notifyWith(e,[c,a,i]);if(a<1&&l){return i}else{r.resolveWith(e,[c]);return false}},c=r.promise({elem:e,props:b.extend({},t),opts:b.extend(true,{specialEasing:{}},i),originalProperties:t,originalOptions:i,startTime:zi||Qi(),duration:i.duration,tweens:[],createTween:function(t,i){var n=b.Tween(e,c.opts,t,i,c.opts.specialEasing[t]||c.opts.easing);c.tweens.push(n);return n},stop:function(t){var i=0,n=t?c.tweens.length:0;if(o){return this}o=true;for(;i<n;i++){c.tweens[i].run(1)}if(t){r.resolveWith(e,[c,t])}else{r.rejectWith(e,[c,t])}return this}}),d=c.props;en(d,c.opts.specialEasing);for(;a<s;a++){n=Yi[a].call(c,e,d,c.opts);if(n){return n}}b.map(d,Zi,c);if(b.isFunction(c.opts.start)){c.opts.start.call(e,c)}b.fx.timer(b.extend(l,{elem:e,anim:c,queue:c.opts.queue}));return c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function en(e,t){var i,n,o,a,s;for(i in e){n=b.camelCase(i);o=t[n];a=e[i];if(b.isArray(a)){o=a[1];a=e[i]=a[0]}if(i!==n){e[n]=a;delete e[i]}s=b.cssHooks[n];if(s&&"expand"in s){a=s.expand(a);delete e[n];for(i in a){if(!(i in e)){e[i]=a[i];t[i]=o}}}else{t[n]=o}}}b.Animation=b.extend(Ki,{tweener:function(e,t){if(b.isFunction(e)){t=e;e=["*"]}else{e=e.split(" ")}var i,n=0,o=e.length;for(;n<o;n++){i=e[n];Xi[i]=Xi[i]||[];Xi[i].unshift(t)}},prefilter:function(e,t){if(t){Yi.unshift(e)}else{Yi.push(e)}}});function tn(e,t,i){var n,o,a,s,r,l,c=this,d={},u=e.style,f=e.nodeType&&ii(e),h=b._data(e,"fxshow");if(!i.queue){r=b._queueHooks(e,"fx");if(r.unqueued==null){r.unqueued=0;l=r.empty.fire;r.empty.fire=function(){if(!r.unqueued){l()}}}r.unqueued++;c.always(function(){c.always(function(){r.unqueued--;if(!b.queue(e,"fx").length){r.empty.fire()}})})}if(e.nodeType===1&&("height"in t||"width"in t)){i.overflow=[u.overflow,u.overflowX,u.overflowY];if(b.css(e,"display")==="inline"&&b.css(e,"float")==="none"){if(!b.support.inlineBlockNeedsLayout||ri(e.nodeName)==="inline"){u.display="inline-block"}else{u.zoom=1}}}if(i.overflow){u.overflow="hidden";if(!b.support.shrinkWrapBlocks){c.always(function(){u.overflow=i.overflow[0];u.overflowX=i.overflow[1];u.overflowY=i.overflow[2]})}}for(n in t){o=t[n];if(Gi.exec(o)){delete t[n];a=a||o==="toggle";if(o===(f?"hide":"show")){continue}d[n]=h&&h[n]||b.style(e,n)}}if(!b.isEmptyObject(d)){if(h){if("hidden"in h){f=h.hidden}}else{h=b._data(e,"fxshow",{})}if(a){h.hidden=!f}if(f){b(e).show()}else{c.done(function(){b(e).hide()})}c.done(function(){var t;b._removeData(e,"fxshow");for(t in d){b.style(e,t,d[t])}});for(n in d){s=Zi(f?h[n]:0,n,c);if(!(n in h)){h[n]=s.start;if(f){s.end=s.start;s.start=n==="width"||n==="height"?1:0}}}}}function nn(e,t,i,n,o){return new nn.prototype.init(e,t,i,n,o)}b.Tween=nn;nn.prototype={constructor:nn,init:function(e,t,i,n,o,a){this.elem=e;this.prop=i;this.easing=o||"swing";this.options=t;this.start=this.now=this.cur();this.end=n;this.unit=a||(b.cssNumber[i]?"":"px")},cur:function(){var e=nn.propHooks[this.prop];return e&&e.get?e.get(this):nn.propHooks._default.get(this)},run:function(e){var t,i=nn.propHooks[this.prop];if(this.options.duration){this.pos=t=b.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration)}else{this.pos=t=e}this.now=(this.end-this.start)*t+this.start;if(this.options.step){this.options.step.call(this.elem,this.now,this)}if(i&&i.set){i.set(this)}else{nn.propHooks._default.set(this)}return this}};nn.prototype.init.prototype=nn.prototype;nn.propHooks={_default:{get:function(e){var t;if(e.elem[e.prop]!=null&&(!e.elem.style||e.elem.style[e.prop]==null)){return e.elem[e.prop]}t=b.css(e.elem,e.prop,"");return!t||t==="auto"?0:t},set:function(e){if(b.fx.step[e.prop]){b.fx.step[e.prop](e)}else if(e.elem.style&&(e.elem.style[b.cssProps[e.prop]]!=null||b.cssHooks[e.prop])){b.style(e.elem,e.prop,e.now+e.unit)}else{e.elem[e.prop]=e.now}}}};nn.propHooks.scrollTop=nn.propHooks.scrollLeft={set:function(e){if(e.elem.nodeType&&e.elem.parentNode){e.elem[e.prop]=e.now}}};b.each(["toggle","show","hide"],function(e,t){var i=b.fn[t];b.fn[t]=function(e,n,o){return e==null||typeof e==="boolean"?i.apply(this,arguments):this.animate(on(t,true),e,n,o)}});b.fn.extend({fadeTo:function(e,t,i,n){return this.filter(ii).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate:function(e,t,i,n){var o=b.isEmptyObject(e),a=b.speed(t,i,n),s=function(){var t=Ki(this,b.extend({},e),a);if(o||b._data(this,"finish")){t.stop(true)}};s.finish=s;return o||a.queue===false?this.each(s):this.queue(a.queue,s)},stop:function(e,i,n){var o=function(e){var t=e.stop;delete e.stop;t(n)};if(typeof e!=="string"){n=i;i=e;e=t}if(i&&e!==false){this.queue(e||"fx",[])}return this.each(function(){var t=true,i=e!=null&&e+"queueHooks",a=b.timers,s=b._data(this);if(i){if(s[i]&&s[i].stop){o(s[i])}}else{for(i in s){if(s[i]&&s[i].stop&&Ji.test(i)){o(s[i])}}}for(i=a.length;i--;){if(a[i].elem===this&&(e==null||a[i].queue===e)){a[i].anim.stop(n);t=false;a.splice(i,1)}}if(t||!n){b.dequeue(this,e)}})},finish:function(e){if(e!==false){e=e||"fx"}return this.each(function(){var t,i=b._data(this),n=i[e+"queue"],o=i[e+"queueHooks"],a=b.timers,s=n?n.length:0;i.finish=true;b.queue(this,e,[]);if(o&&o.stop){o.stop.call(this,true)}for(t=a.length;t--;){if(a[t].elem===this&&a[t].queue===e){a[t].anim.stop(true);a.splice(t,1)}}for(t=0;t<s;t++){if(n[t]&&n[t].finish){n[t].finish.call(this)}}delete i.finish})}});function on(e,t){var i,n={height:e},o=0;t=t?1:0;for(;o<4;o+=2-t){i=Kt[o];n["margin"+i]=n["padding"+i]=e}if(t){n.opacity=n.width=e}return n}b.each({slideDown:on("show"),slideUp:on("hide"),slideToggle:on("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){b.fn[e]=function(e,i,n){return this.animate(t,e,i,n)}});b.speed=function(e,t,i){var n=e&&typeof e==="object"?b.extend({},e):{complete:i||!i&&t||b.isFunction(e)&&e,duration:e,easing:i&&t||t&&!b.isFunction(t)&&t};n.duration=b.fx.off?0:typeof n.duration==="number"?n.duration:n.duration in b.fx.speeds?b.fx.speeds[n.duration]:b.fx.speeds._default;if(n.queue==null||n.queue===true){n.queue="fx"}n.old=n.complete;n.complete=function(){if(b.isFunction(n.old)){n.old.call(this)}if(n.queue){b.dequeue(this,n.queue)}};return n};b.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}};b.timers=[];b.fx=nn.prototype.init;b.fx.tick=function(){var e,i=b.timers,n=0;zi=b.now();for(;n<i.length;n++){e=i[n];if(!e()&&i[n]===e){i.splice(n--,1)}}if(!i.length){b.fx.stop()}zi=t};b.fx.timer=function(e){if(e()&&b.timers.push(e)){b.fx.start()}};b.fx.interval=13;b.fx.start=function(){if(!qi){qi=setInterval(b.fx.tick,b.fx.interval)}};b.fx.stop=function(){clearInterval(qi);qi=null};b.fx.speeds={slow:600,fast:200,_default:400};b.fx.step={};if(b.expr&&b.expr.filters){b.expr.filters.animated=function(e){return b.grep(b.timers,function(t){return e===t.elem}).length}}b.fn.offset=function(e){if(arguments.length){return e===t?this:this.each(function(t){b.offset.setOffset(this,e,t)})}var i,n,a={top:0,left:0},s=this[0],r=s&&s.ownerDocument;if(!r){return}i=r.documentElement;if(!b.contains(i,s)){return a}if(typeof s.getBoundingClientRect!==o){a=s.getBoundingClientRect()}n=an(r);return{top:a.top+(n.pageYOffset||i.scrollTop)-(i.clientTop||0),left:a.left+(n.pageXOffset||i.scrollLeft)-(i.clientLeft||0)}};b.offset={setOffset:function(e,t,i){var n=b.css(e,"position");if(n==="static"){e.style.position="relative"}var o=b(e),a=o.offset(),s=b.css(e,"top"),r=b.css(e,"left"),l=(n==="absolute"||n==="fixed")&&b.inArray("auto",[s,r])>-1,c={},d={},u,f;if(l){d=o.position();u=d.top;f=d.left}else{u=parseFloat(s)||0;f=parseFloat(r)||0}if(b.isFunction(t)){t=t.call(e,i,a)}if(t.top!=null){c.top=t.top-a.top+u}if(t.left!=null){c.left=t.left-a.left+f}if("using"in t){t.using.call(e,c)}else{o.css(c)}}};b.fn.extend({position:function(){if(!this[0]){return}var e,t,i={top:0,left:0},n=this[0];if(b.css(n,"position")==="fixed"){t=n.getBoundingClientRect()}else{e=this.offsetParent();t=this.offset();if(!b.nodeName(e[0],"html")){i=e.offset()}i.top+=b.css(e[0],"borderTopWidth",true);i.left+=b.css(e[0],"borderLeftWidth",true)}return{top:t.top-i.top-b.css(n,"marginTop",true),left:t.left-i.left-b.css(n,"marginLeft",true)}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||r;while(e&&(!b.nodeName(e,"html")&&b.css(e,"position")==="static")){e=e.offsetParent}return e||r})}});b.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,i){var n=/Y/.test(i);b.fn[e]=function(o){return b.access(this,function(e,o,a){var s=an(e);if(a===t){return s?i in s?s[i]:s.document.documentElement[o]:e[o]}if(s){s.scrollTo(!n?a:b(s).scrollLeft(),n?a:b(s).scrollTop())}else{e[o]=a}},e,o,arguments.length,null)}});function an(e){return b.isWindow(e)?e:e.nodeType===9?e.defaultView||e.parentWindow:false
}b.each({Height:"height",Width:"width"},function(e,i){b.each({padding:"inner"+e,content:i,"":"outer"+e},function(n,o){b.fn[o]=function(o,a){var s=arguments.length&&(n||typeof o!=="boolean"),r=n||(o===true||a===true?"margin":"border");return b.access(this,function(i,n,o){var a;if(b.isWindow(i)){return i.document.documentElement["client"+e]}if(i.nodeType===9){a=i.documentElement;return Math.max(i.body["scroll"+e],a["scroll"+e],i.body["offset"+e],a["offset"+e],a["client"+e])}return o===t?b.css(i,n,r):b.style(i,n,o,r)},i,s?o:t,s,null)}})});b.fn.size=function(){return this.length};b.fn.andSelf=b.fn.addBack;if(typeof module==="object"&&module&&typeof module.exports==="object"){module.exports=b}else{e.jQuery=e.$=b;if(typeof define==="function"&&define.amd){define("jquery",[],function(){return b})}}})(window);jQuery.browser={};(function(){jQuery.browser.msie=false;jQuery.browser.version=0;if(navigator.userAgent.match(/MSIE ([0-9]+)\./)){jQuery.browser.msie=true;jQuery.browser.version=RegExp.$1}})();(function(e){var t="ar"+ +new Date,i=defaults={onResize:e.noop,onBeforeResize:e.noop,onAfterResize:e.noop,animate:{duration:200,complete:e.noop},extraSpace:50,minSize:"original",maxSize:500,delay:100},n=["lineHeight","textDecoration","letterSpacing","fontSize","fontFamily","fontStyle","fontWeight","textTransform","textAlign","direction","wordSpacing","fontSizeAdjust","paddingTop","paddingLeft","paddingBottom","paddingRight","width"],o=["textarea:not(textarea."+t+")","input:not(input[type])","input[type=text]","input[type=password]","input[type=email]","input[type=url]"].join(",");function a(t,i){if(t.data("AutoResizer")){t.data("AutoResizer").destroy()}t.data("AutoResizer",this);var n;this.$el=t;this.config=i=e.extend({},defaults,i);this.isTextArea=this.$el.is("textarea");n=this.isTextArea?t.height():t.width();if(i.maxSize==="original"){i.maxSize=n}if(i.minSize==="original"){i.minSize=n}if(this.isTextArea){t.css({resize:"none"})}if(i.animate){i.animate.complete=e.proxy(this.afterResize,this,i.animate.complete)}this.bind();if(!t.is(":hidden")){this.check(true)}}!function(){var i=".autoResize",o;this.unbind=function(){this.$el.unbind(i)};this.bind=function s(){var t=e.proxy(function(){this.check()},this);this.unbind();this.$el.bind("keyup"+i,t).bind("change"+i,t).bind("paste"+i,t)};function a(){if(!o){o=e('<div class="autoresize-clones"/>').appendTo("body").css({position:"absolute",top:-9999,left:-9999,width:0,height:0,padding:0,overflow:"hidden"})}return o}this.getClone=function(){var i,o;if(!this.$clone){i=this.$el;this.$clone=o=e(this.isTextArea?"<textarea/>":"<span/>");e.each(n,function(e,t){o.css(t,i.css(t))});o.addClass(t).attr("tabIndex",-1).css("overflow","hidden");if(this.isTextArea){o.height(0)}else{o.width("auto").css({whiteSpace:"nowrap"})}a().append(o)}return this.$clone};this.afterResize=function(e){var t=this.$el,i=this.config;if(this.isTextArea){if(t.height()===i.maxSize){t.css("overflowY","auto").scrollTop(1e4)}else{t.css("overflowY","hidden")}}i.onAfterResize.call(this.$el);if(e){e.apply(this,arguments)}};this.check=function r(e){var t=this.config,i=this.getClone(),n=this.$el,o=n.val()||"",a=n.width(),s=this.isTextArea?n.height():a,r,l;o=o.length?o:" ";if(o===this.prevValue&&this.prevWidth===a){return}if(this.isTextArea){if(a!==this.prevWidth){i.width(a)}i.val(o).scrollTop(0).scrollTop(1e4);r=i.scrollTop()+t.extraSpace}else{i.text(o);r=i.width()+t.extraSpace}r=Math.min(Math.max(r,t.minSize),t.maxSize);if(s!==r){l={};l[this.isTextArea?"height":"width"]=r}this.prevValue=o;this.prevWidth=a;if(l){t.onBeforeResize.call(n);t.onResize.call(n);if(t.animate&&!e){n.stop(true,true).animate(l,t.animate)}else{n.css(l);this.afterResize()}}};this.destroy=function l(){this.$el.removeData("AutoResizer");this.unbind();if(this.$clone){this.$clone.remove()}delete this.$el;delete this.$clone}}.call(a.prototype);e.fn.autoResize=function s(t){this.filter(o).each(function(){new a(e(this),t)});return this}})(jQuery);(function(e){if(typeof define==="function"&&define.amd){define(["jquery"],e)}else if(typeof exports==="object"){module.exports=e}else{e(jQuery)}})(function(e){var t=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],i="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],n=Array.prototype.slice,o,a;if(e.event.fixHooks){for(var s=t.length;s;){e.event.fixHooks[t[--s]]=e.event.mouseHooks}}var r=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener){for(var t=i.length;t;){this.addEventListener(i[--t],l,false)}}else{this.onmousewheel=l}e.data(this,"mousewheel-line-height",r.getLineHeight(this));e.data(this,"mousewheel-page-height",r.getPageHeight(this))},teardown:function(){if(this.removeEventListener){for(var t=i.length;t;){this.removeEventListener(i[--t],l,false)}}else{this.onmousewheel=null}e.removeData(this,"mousewheel-line-height");e.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var i=e(t),n=i["offsetParent"in e.fn?"offsetParent":"parent"]();if(!n.length){n=e("body")}return parseInt(n.css("fontSize"),10)||parseInt(i.css("fontSize"),10)||16},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:true,normalizeOffset:true}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}});function l(t){var i=t||window.event,s=n.call(arguments,1),l=0,u=0,f=0,h=0,g=0,p=0;t=e.event.fix(i);t.type="mousewheel";if("detail"in i){f=i.detail*-1}if("wheelDelta"in i){f=i.wheelDelta}if("wheelDeltaY"in i){f=i.wheelDeltaY}if("wheelDeltaX"in i){u=i.wheelDeltaX*-1}if("axis"in i&&i.axis===i.HORIZONTAL_AXIS){u=f*-1;f=0}l=f===0?u:f;if("deltaY"in i){f=i.deltaY*-1;l=f}if("deltaX"in i){u=i.deltaX;if(f===0){l=u*-1}}if(f===0&&u===0){return}if(i.deltaMode===1){var m=e.data(this,"mousewheel-line-height");l*=m;f*=m;u*=m}else if(i.deltaMode===2){var v=e.data(this,"mousewheel-page-height");l*=v;f*=v;u*=v}h=Math.max(Math.abs(f),Math.abs(u));if(!a||h<a){a=h;if(d(i,h)){a/=40}}if(d(i,h)){l/=40;u/=40;f/=40}l=Math[l>=1?"floor":"ceil"](l/a);u=Math[u>=1?"floor":"ceil"](u/a);f=Math[f>=1?"floor":"ceil"](f/a);if(r.settings.normalizeOffset&&this.getBoundingClientRect){var _=this.getBoundingClientRect();g=t.clientX-_.left;p=t.clientY-_.top}t.deltaX=u;t.deltaY=f;t.deltaFactor=a;t.offsetX=g;t.offsetY=p;t.deltaMode=0;s.unshift(t,l,u,f);if(o){clearTimeout(o)}o=setTimeout(c,200);return(e.event.dispatch||e.event.handle).apply(this,s)}function c(){a=null}function d(e,t){return r.settings.adjustOldDeltas&&e.type==="mousewheel"&&t%120===0}});"use strict";(function(e){if(typeof define==="function"&&define.amd){define(["jquery"],e)}else{e(jQuery)}})(function(e){var t={wheelSpeed:navigator.platform.toUpperCase().indexOf("WIN")!==-1?15:1,wheelPropagation:false,minScrollbarLength:null,useBothWheelAxes:false,useKeyboard:false,topMargin:0};e.fn.perfectScrollbar=function(i,n){return this.each(function(){var o=e.extend(true,{},t),a=e(this);if(typeof i==="object"){e.extend(true,o,i)}else{n=i}if(n==="update"){if(a.data("perfect-scrollbar-update")){a.data("perfect-scrollbar-update")()}return a}else if(n==="scroll"){if(a.data("perfect-scrollbar-scroll")){a.data("perfect-scrollbar-scroll")()}return a}else if(n==="destroy"){if(a.data("perfect-scrollbar-destroy")){a.data("perfect-scrollbar-destroy")()}return a}if(a.data("perfect-scrollbar")){return a.data("perfect-scrollbar")}a.addClass("ps-container");var s=e("<div class='ps-scrollbar-x-rail'></div>").appendTo(a),r=e("<div class='ps-scrollbar-y-rail'></div>").appendTo(a),l=e("<div class='ps-scrollbar-x'></div>").appendTo(s),c=e("<div class='ps-scrollbar-y'></div>").appendTo(r),d,u,f,h,g,p,m,v,_=parseInt(s.css("bottom"),10),w,b,y=parseInt(r.css("right"),10),C=a.find(".overview"),j,x,E,k=false;var T=function(){var e=parseInt(b*(p-h)/(h-w),10);s.css({bottom:_-e});a.bottomPositionCSS=parseInt(b*(p-h)/(h-w),10);L()};var I=function(){return parseInt(C.css("bottom"))};var S=function(){return parseInt(C.css("top"))};var M=function(){return parseInt(c.css("bottom"))};a.bottomPositionCSS=I();var N=function(){var e=parseInt(v*(g-f)/(f-m),10);a.scrollLeft(e);r.css({right:y-e})};var A=function(e){if(o.minScrollbarLength){e=Math.max(e,o.minScrollbarLength)}return e};var O=function(e){E=e;x=(j+E)*-1;if(E!==0){C.css({bottom:"auto",top:x});k=true}else{C.css({bottom:e,top:"auto"});k=false}};var L=function(){j=p-h+o.topMargin;if(a.bottomPositionCSS<j){if(a.bottomPositionCSS<=0){O(0);a.bottomPositionCSS=0}else{O(a.bottomPositionCSS*-1)}}else{O(j*-1);a.bottomPositionCSS=j}};var D=function(e){s.toggle(d);r.toggle(u);s.css({left:a.scrollLeft(),bottom:_-a.scrollTop(),width:f});r.css({top:a.scrollTop(),right:y-a.scrollLeft(),height:h});l.css({left:v,width:m});c.css({bottom:e?0:b,height:w})};var H=function(e){f=a.width();h=a.height()-o.topMargin;g=C.width();p=C.height()-o.topMargin;if(f<g){d=true;m=A(parseInt(f*f/g,10));v=parseInt(a.scrollLeft()*(f-m)/(g-f),10)}else{d=false;m=0;v=0;a.scrollLeft(0)}if(h<p&&!e){u=true;w=A(parseInt(h*h/p,10));L();b=parseInt(a.bottomPositionCSS*(h-w)/(p-h),10)}else{u=false;w=0;b=0;O(0)}if(b>=h-w){b=h-w}if(v>=f-m){v=f-m}D(e)};var P=function(e,t){var i=e+t,n=f-m;if(i<0){v=0}else if(i>n){v=n}else{v=i}s.css({left:a.scrollLeft()});l.css({left:v})};var F=function(e,t){var i=e-t,n=h-w;if(i<0){b=0}else if(i>n){b=n}else{b=i}r.css({top:a.scrollTop()});c.css({bottom:b})};var B=function(){var t,i;l.bind("mousedown.perfect-scrollbar",function(e){i=e.pageX;t=l.position().left;s.addClass("in-scrolling");e.stopPropagation();e.preventDefault()});e(document).bind("mousemove.perfect-scrollbar",function(e){if(s.hasClass("in-scrolling")){N();P(t,e.pageX-i);e.stopPropagation();e.preventDefault()}});e(document).bind("mouseup.perfect-scrollbar",function(e){if(s.hasClass("in-scrolling")){s.removeClass("in-scrolling")}});t=i=null};var W=function(){var t,i;c.bind("mousedown.perfect-scrollbar",function(e){i=e.pageY;t=M();r.addClass("in-scrolling");e.stopPropagation();e.preventDefault()});e(document).bind("mousemove.perfect-scrollbar",function(e){if(r.hasClass("in-scrolling")){T();F(M(),e.pageY-i);i=e.pageY;e.stopPropagation();e.preventDefault()}});e(document).bind("mouseup.perfect-scrollbar",function(){if(r.hasClass("in-scrolling")){r.removeClass("in-scrolling")}});t=i=null};var R=function(){var e=function(e,t){var i=a.bottomPositionCSS;if(i===0&&t>0&&e===0){return!o.wheelPropagation}else if(i>=p-h&&t<0&&e===0){return!o.wheelPropagation}var n=a.scrollLeft();if(n===0&&e<0&&t===0){return!o.wheelPropagation}else if(n>=g-f&&e>0&&t===0){return!o.wheelPropagation}return true};var t=false;try{var i="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],n;if(window.top&&window.top.addEventListener&&devicejs.safari()){for(n=i.length;n--;){window.top.addEventListener(i[n],function(){})}}}catch(s){}a.bind("mousewheel.perfect-scrollbar",function(i,n,s,r){if(!o.useBothWheelAxes){a.bottomPositionCSS=a.bottomPositionCSS+r*o.wheelSpeed;a.scrollLeft(a.scrollLeft()+s*o.wheelSpeed)}else if(u&&!d){if(r){a.bottomPositionCSS=a.bottomPositionCSS+r*o.wheelSpeed}else{a.bottomPositionCSS=a.bottomPositionCSS-s*o.wheelSpeed}}else if(d&&!u){if(s){a.scrollLeft(a.scrollLeft()+s*o.wheelSpeed)}else{a.scrollLeft(a.scrollLeft()-r*o.wheelSpeed)}}H();t=e(s,r);if(t){i.preventDefault()}});a.bind("MozMousePixelScroll.perfect-scrollbar",function(e){if(t){e.preventDefault()}})};var $=function(){var t=function(e,t){var i=a.bottomPositionCSS;if(i===0&&t>0&&e===0){return false}else if(i>=p-h&&t<0&&e===0){return false}var n=a.scrollLeft();if(n===0&&e<0&&t===0){return false}else if(n>=g-f&&e>0&&t===0){return false}return true};var i=false;a.bind("mouseenter.perfect-scrollbar",function(e){i=true});a.bind("mouseleave.perfect-scrollbar",function(e){i=false});var n=false;e(document).bind("keydown.perfect-scrollbar",function(e){if(!i){return}var s=0,r=0;switch(e.which){case 37:s=-3;break;case 38:r=3;break;case 39:s=3;break;case 40:r=-3;break;default:return}a.bottomPositionCSS=a.bottomPositionCSS+r*o.wheelSpeed;a.scrollLeft(a.scrollLeft()+s*o.wheelSpeed);H();n=t(s,r);if(n){e.preventDefault()}})};var V=function(){var e=function(e){e.stopPropagation()};c.bind("click.perfect-scrollbar",e);r.bind("click.perfect-scrollbar",function(e){var t=parseInt(w/2,10),i=e.pageY-r.offset().top-t,n=h-w,o=i/n;if(o<0){o=0}else if(o>1){o=1}a.bottomPositionCSS=(p-h)*o;H()});l.bind("click.perfect-scrollbar",e);s.bind("click.perfect-scrollbar",function(e){var t=parseInt(m/2,10),i=e.pageX-s.offset().left-t,n=f-m,o=i/n;if(o<0){o=0}else if(o>1){o=1}a.scrollLeft((g-f)*o);H()})};var z=function(){var t=function(e,t){a.bottomPositionCSS=a.bottomPositionCSS+t;a.scrollLeft(a.scrollLeft()-e);H()};var i={},n=0,o={},s=null,r=false,l=false;e(window).bind("touchstart.perfect-scrollbar",function(e){r=true});e(window).bind("touchend.perfect-scrollbar",function(e){r=false});a.bind("touchstart.perfect-scrollbar",function(e){var t=e.originalEvent.targetTouches[0];i.pageX=t.pageX;i.pageY=t.pageY;n=(new Date).getTime();if(s!==null){clearInterval(s)}e.stopPropagation()});a.bind("touchmove.perfect-scrollbar",function(e){if(!r&&e.originalEvent.targetTouches.length===1){var a=e.originalEvent.targetTouches[0];l=true;var s={};s.pageX=a.pageX;s.pageY=a.pageY;var c=s.pageX-i.pageX,d=s.pageY-i.pageY;t(c,d);i=s;var u=(new Date).getTime();o.x=c/(u-n);o.y=d/(u-n);n=u;if(document.documentElement.style.position==="fixed"){e.preventDefault()}}});a.bind("touchend.perfect-scrollbar",function(e){clearInterval(s);if(l){l=false;s=setInterval(function(){if(Math.abs(o.x)<.01&&Math.abs(o.y)<.01){clearInterval(s);return}t(o.x*30,o.y*30);o.x*=.8;o.y*=.8},10)}})};var q=function(){a.unbind(".perfect-scrollbar");e(window).unbind(".perfect-scrollbar");e(document).unbind(".perfect-scrollbar");a.data("perfect-scrollbar",null);a.data("perfect-scrollbar-update",null);a.data("perfect-scrollbar-scroll",null);a.data("perfect-scrollbar-destroy",null);l.remove();c.remove();s.remove();r.remove();l=c=f=h=g=p=m=v=_=w=b=y=null};var G=function(t){a.addClass("ie").addClass("ie"+t);var i=function(){var t=function(){e(this).addClass("hover")};var i=function(){e(this).removeClass("hover")};a.bind("mouseenter.perfect-scrollbar",t).bind("mouseleave.perfect-scrollbar",i);s.bind("mouseenter.perfect-scrollbar",t).bind("mouseleave.perfect-scrollbar",i);r.bind("mouseenter.perfect-scrollbar",t).bind("mouseleave.perfect-scrollbar",i);l.bind("mouseenter.perfect-scrollbar",t).bind("mouseleave.perfect-scrollbar",i);c.bind("mouseenter.perfect-scrollbar",t).bind("mouseleave.perfect-scrollbar",i)};var n=function(){D=function(){l.css({left:v+a.scrollLeft(),bottom:_,width:m});c.css({bottom:b+a.bottomPositionCSS,right:y,height:w});l.hide().show();c.hide().show()};T=function(){var e=parseInt(b*p/h,10);a.bottomPositionCSS=parseInt(b*p/h,10);l.css({bottom:_});l.hide().show()};N=function(){var e=parseInt(v*g/f,10);a.scrollLeft(e);c.hide().show()}};if(t===6){i();n()}};var U="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch;var J=function(){var e=navigator.userAgent.toLowerCase().match(/(msie) ([\w.]+)/);if(e&&e[1]==="msie"){G(parseInt(e[2],10))}H();B();W();V();if(U){z()}if(a.mousewheel){R()}if(o.useKeyboard){$()}a.data("perfect-scrollbar",a);a.data("perfect-scrollbar-update",H);a.data("perfect-scrollbar-scroll",function(){E=0;b=0;a.bottomPositionCSS=0;H(true)});a.data("perfect-scrollbar-destroy",q)};J();return a})}});(function(e){e.fn.typing=function(e){return this.each(function(i,n){t(n,e)})};function t(t,i){var n=e.extend({start:null,stop:null,delay:400},i);var o=e(t),a=false,s;function r(e){if(!a){a=true;if(n.start){n.start(e,o)}}}function l(e,t){if(a){clearTimeout(s);s=setTimeout(function(){a=false;if(n.stop){n.stop(e,o)}},t>=0?t:n.delay)}}o.keypress(r);o.keydown(function(e){if(e.keyCode===8||e.keyCode===46){r(e)}});o.keyup(l);o.blur(function(e){l(e,0)})}})(jQuery);(function(e){e.fn.jivoDragEvent=function(e){return this.each(function(i,n){t(n,e)})};function t(t,i){var n=e.extend({"min-height":300,"min-width":200,opacity:.8,"out-of-border":true,handler:e(),tracker:e(),console:false},i);var o=".jivo-drag",a=e(t),s=n.handler,r=n.tracker,l=e(s.prop("ownerDocument")),c=false,d=0,u=0;function f(e,t){a.trigger({type:e,dx:t.screenX-d,dy:t.screenY-u})}function h(e){c=false;r.hide();f("jivo.drag.stop",e);l.unbind(o)}function g(e){e.preventDefault();if(!c){h(e)}f("jivo.drag.move",e)}function p(e){c=true;d=e.screenX;u=e.screenY;e.preventDefault();l.bind("mouseup"+o,h).bind("mousemove"+o,g);r.show();f("jivo.drag.init",e)}s.mousedown(p);a.bind("jivo.drag.init",function(e){if(n.console)console.log("drag init",e)});a.bind("jivo.drag.move",function(e){if(n.console)console.log("drag move",e)});a.bind("jivo.drag.stop",function(e){if(n.console)console.log("drag stop",e)})}})(jQuery);(function(e,t,i){var n=Object.prototype.toString.call(e.operamini)=="[object OperaMini]";var o="placeholder"in t.createElement("input")&&!n;var a="placeholder"in t.createElement("textarea")&&!n;var s=i.fn;var r=i.valHooks;var l=i.propHooks;var c;var d;if(o&&a){d=s.placeholder=function(){return this};d.input=d.textarea=true}else{d=s.placeholder=function(){var e=this;e.filter((o?"textarea":":input")+"[placeholder]").not(".placeholder").bind({"focus.placeholder":f,"blur.placeholder":h}).data("placeholder-enabled",true).trigger("blur.placeholder");return e};d.input=o;d.textarea=a;c={get:function(e){var t=i(e);var n=t.data("placeholder-password");if(n){return n[0].value}return t.data("placeholder-enabled")&&t.hasClass("placeholder")?"":e.value},set:function(e,t){var n=i(e);var o=n.data("placeholder-password");if(o){return o[0].value=t}if(!n.data("placeholder-enabled")){return e.value=t}if(t==""){e.value=t;if(e!=g()){h.call(e)}}else if(n.hasClass("placeholder")){f.call(e,true,t)||(e.value=t)}else{e.value=t}return n}};if(!o){r.input=c;l.value=c}if(!a){r.textarea=c;l.value=c}i(function(){i(t).delegate("form","submit.placeholder",function(){var e=i(".placeholder",this).each(f);setTimeout(function(){e.each(h)},10)})});i(e).bind("beforeunload.placeholder",function(){i(".placeholder").each(function(){this.value=""})})}function u(e){var t={};var n=/^jQuery\d+$/;i.each(e.attributes,function(e,i){if(i.specified&&!n.test(i.name)){t[i.name]=i.value}});return t}function f(e,t){var n=this;var o=i(n);if(n.value==o.attr("placeholder")&&o.hasClass("placeholder")){if(o.data("placeholder-password")){o=o.hide().next().show().attr("id",o.removeAttr("id").data("placeholder-id"));if(e===true){return o[0].value=t}o.focus()}else{n.value="";o.removeClass("placeholder");n==g()&&n.select()}}}function h(){var e;var t=this;var n=i(t);var o=this.id;if(t.value==""){if(t.type=="password"){if(!n.data("placeholder-textinput")){try{e=n.clone().attr({type:"text"})}catch(a){e=i("<input>").attr(i.extend(u(this),{type:"text"}))}e.removeAttr("name").data({"placeholder-password":n,"placeholder-id":o}).bind("focus.placeholder",f);n.data({"placeholder-textinput":e,"placeholder-id":o}).before(e)}n=n.removeAttr("id").hide().prev().attr("id",o).show()}n.addClass("placeholder");n[0].value=n.attr("placeholder")}else{n.removeClass("placeholder")}}function g(){try{return t.activeElement}catch(e){}}})(this,document,jQuery);(function(){var e=this;var t=e._;var i={};var n=Array.prototype,o=Object.prototype,a=Function.prototype;var s=n.push,r=n.slice,l=n.concat,c=o.toString,d=o.hasOwnProperty;var u=n.forEach,f=n.map,h=n.reduce,g=n.reduceRight,p=n.filter,m=n.every,v=n.some,_=n.indexOf,w=n.lastIndexOf,b=Array.isArray,y=Object.keys,C=false;var j=function(e){if(e instanceof j)return e;if(!(this instanceof j))return new j(e);this._wrapped=e};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=j}exports._=j}else{e._=j}j.VERSION="1.4.4";var x=j.each=j.forEach=function(e,t,n){if(e==null)return;if(u&&e.forEach===u){e.forEach(t,n)}else if(e.length===+e.length){for(var o=0,a=e.length;o<a;o++){if(t.call(n,e[o],o,e)===i)return}}else{for(var s in e){if(j.has(e,s)){if(t.call(n,e[s],s,e)===i)return}}}};j.map=j.collect=function(e,t,i){var n=[];if(e==null)return n;if(f&&e.map===f)return e.map(t,i);x(e,function(e,o,a){n[n.length]=t.call(i,e,o,a)});return n};var E="Reduce of empty array with no initial value";j.reduce=j.foldl=j.inject=function(e,t,i,n){var o=arguments.length>2;if(e==null)e=[];if(h&&e.reduce===h){if(n)t=j.bind(t,n);return o?e.reduce(t,i):e.reduce(t)}x(e,function(e,a,s){if(!o){i=e;o=true}else{i=t.call(n,i,e,a,s)}});if(!o)throw new TypeError(E);return i};j.reduceRight=j.foldr=function(e,t,i,n){var o=arguments.length>2;if(e==null)e=[];if(g&&e.reduceRight===g){if(n)t=j.bind(t,n);return o?e.reduceRight(t,i):e.reduceRight(t)}var a=e.length;if(a!==+a){var s=j.keys(e);a=s.length}x(e,function(r,l,c){l=s?s[--a]:--a;if(!o){i=e[l];o=true}else{i=t.call(n,i,e[l],l,c)}});if(!o)throw new TypeError(E);return i};j.find=j.detect=function(e,t,i){var n;k(e,function(e,o,a){if(t.call(i,e,o,a)){n=e;return true}});return n};j.filter=j.select=function(e,t,i){var n=[];if(e==null)return n;if(p&&e.filter===p)return e.filter(t,i);x(e,function(e,o,a){if(t.call(i,e,o,a))n[n.length]=e});return n};j.reject=function(e,t,i){return j.filter(e,function(e,n,o){return!t.call(i,e,n,o)},i)};j.every=j.all=function(e,t,n){t||(t=j.identity);var o=true;if(e==null)return o;if(m&&e.every===m)return e.every(t,n);x(e,function(e,a,s){if(!(o=o&&t.call(n,e,a,s)))return i});return!!o};var k=j.some=j.any=function(e,t,n){t||(t=j.identity);var o=false;if(e==null)return o;if(v&&e.some===v)return e.some(t,n);x(e,function(e,a,s){if(o||(o=t.call(n,e,a,s)))return i});return!!o};j.contains=j.include=function(e,t){if(e==null)return false;if(_&&e.indexOf===_)return e.indexOf(t)!=-1;return k(e,function(e){return e===t})};j.invoke=function(e,t){var i=r.call(arguments,2);var n=j.isFunction(t);return j.map(e,function(e){return(n?t:e[t]).apply(e,i)})};j.pluck=function(e,t){return j.map(e,function(e){return e[t]})};j.where=function(e,t,i){if(j.isEmpty(t))return i?null:[];return j[i?"find":"filter"](e,function(e){for(var i in t){if(t[i]!==e[i])return false}return true})};j.findWhere=function(e,t){return j.where(e,t,true)};j.max=function(e,t,i){if(!t&&j.isArray(e)&&e[0]===+e[0]&&e.length<65535){return Math.max.apply(Math,e)}if(!t&&j.isEmpty(e))return-Infinity;var n={computed:-Infinity,value:-Infinity};x(e,function(e,o,a){var s=t?t.call(i,e,o,a):e;s>=n.computed&&(n={value:e,computed:s})});return n.value};j.min=function(e,t,i){if(!t&&j.isArray(e)&&e[0]===+e[0]&&e.length<65535){return Math.min.apply(Math,e)}if(!t&&j.isEmpty(e))return Infinity;var n={computed:Infinity,value:Infinity};x(e,function(e,o,a){var s=t?t.call(i,e,o,a):e;s<n.computed&&(n={value:e,computed:s})});return n.value};j.shuffle=function(e){var t;var i=0;var n=[];x(e,function(e){t=j.random(i++);n[i-1]=n[t];n[t]=e});return n};var T=function(e){return j.isFunction(e)?e:function(t){return t[e]}};j.sortBy=function(e,t,i){var n=T(t);return j.pluck(j.map(e,function(e,t,o){return{value:e,index:t,criteria:n.call(i,e,t,o)}}).sort(function(e,t){var i=e.criteria;var n=t.criteria;if(i!==n){if(i>n||i===void 0)return 1;if(i<n||n===void 0)return-1}return e.index<t.index?-1:1}),"value")};var I=function(e,t,i,n){var o={};var a=T(t||j.identity);x(e,function(t,s){var r=a.call(i,t,s,e);n(o,r,t)});return o};j.groupBy=function(e,t,i){return I(e,t,i,function(e,t,i){(j.has(e,t)?e[t]:e[t]=[]).push(i)})};j.countBy=function(e,t,i){return I(e,t,i,function(e,t){if(!j.has(e,t))e[t]=0;e[t]++})};j.sortedIndex=function(e,t,i,n){i=i==null?j.identity:T(i);var o=i.call(n,t);var a=0,s=e.length;while(a<s){var r=a+s>>>1;i.call(n,e[r])<o?a=r+1:s=r}return a};j.toArray=function(e){if(!e)return[];if(j.isArray(e))return r.call(e);if(e.length===+e.length)return j.map(e,j.identity);return j.values(e)};j.size=function(e){if(e==null)return 0;return e.length===+e.length?e.length:j.keys(e).length};j.first=j.head=j.take=function(e,t,i){if(e==null)return void 0;return t!=null&&!i?r.call(e,0,t):e[0]};j.initial=function(e,t,i){return r.call(e,0,e.length-(t==null||i?1:t))};j.last=function(e,t,i){if(e==null)return void 0;if(t!=null&&!i){return r.call(e,Math.max(e.length-t,0))}else{return e[e.length-1]}};j.rest=j.tail=j.drop=function(e,t,i){return r.call(e,t==null||i?1:t)};j.compact=function(e){return j.filter(e,j.identity)};var S=function(e,t,i){x(e,function(e){if(j.isArray(e)){t?s.apply(i,e):S(e,t,i)}else{i.push(e)}});return i};j.flatten=function(e,t){return S(e,t,[])};j.without=function(e){return j.difference(e,r.call(arguments,1))};j.uniq=j.unique=function(e,t,i,n){if(j.isFunction(t)){n=i;i=t;t=false}var o=i?j.map(e,i,n):e;var a=[];var s=[];x(o,function(i,n){if(t?!n||s[s.length-1]!==i:!j.contains(s,i)){s.push(i);a.push(e[n])}});return a};j.union=function(){return j.uniq(l.apply(n,arguments))};j.intersection=function(e){var t=r.call(arguments,1);return j.filter(j.uniq(e),function(e){return j.every(t,function(t){return j.indexOf(t,e)>=0})})};j.difference=function(e){var t=l.apply(n,r.call(arguments,1));return j.filter(e,function(e){return!j.contains(t,e)})};j.zip=function(){var e=r.call(arguments);var t=j.max(j.pluck(e,"length"));var i=new Array(t);for(var n=0;n<t;n++){i[n]=j.pluck(e,""+n)}return i};j.object=function(e,t){if(e==null)return{};var i={};for(var n=0,o=e.length;n<o;n++){if(t){i[e[n]]=t[n]}else{i[e[n][0]]=e[n][1]}}return i};j.indexOf=function(e,t,i){if(e==null)return-1;var n=0,o=e.length;if(i){if(typeof i=="number"){n=i<0?Math.max(0,o+i):i}else{n=j.sortedIndex(e,t);return e[n]===t?n:-1}}if(_&&e.indexOf===_)return e.indexOf(t,i);for(;n<o;n++)if(e[n]===t)return n;return-1};j.lastIndexOf=function(e,t,i){if(e==null)return-1;var n=i!=null;if(w&&e.lastIndexOf===w){return n?e.lastIndexOf(t,i):e.lastIndexOf(t)}var o=n?i:e.length;while(o--)if(e[o]===t)return o;return-1};j.range=function(e,t,i){if(arguments.length<=1){t=e||0;e=0}i=arguments[2]||1;var n=Math.max(Math.ceil((t-e)/i),0);var o=0;var a=new Array(n);while(o<n){a[o++]=e;e+=i}return a};j.bind=function(e,t){if(e.bind===C&&C)return C.apply(e,r.call(arguments,1));var i=r.call(arguments,2);return function(){return e.apply(t,i.concat(r.call(arguments)))}};j.partial=function(e){var t=r.call(arguments,1);return function(){return e.apply(this,t.concat(r.call(arguments)))}};j.bindAll=function(e){var t=r.call(arguments,1);if(t.length===0)t=j.functions(e);x(t,function(t){e[t]=j.bind(e[t],e)});return e};j.memoize=function(e,t){var i={};t||(t=j.identity);return function(){var n=t.apply(this,arguments);return j.has(i,n)?i[n]:i[n]=e.apply(this,arguments)}};j.delay=function(e,t){var i=r.call(arguments,2);return setTimeout(function(){return e.apply(null,i)},t)};j.defer=function(e){return j.delay.apply(j,[e,1].concat(r.call(arguments,1)))};j.throttle=function(e,t){var i,n,o,a;var s=0;var r=function(){s=new Date;o=null;a=e.apply(i,n)};return function(){var l=new Date;var c=t-(l-s);i=this;n=arguments;if(c<=0){clearTimeout(o);o=null;s=l;a=e.apply(i,n)}else if(!o){o=setTimeout(r,c)}return a}};j.debounce=function(e,t,i){var n,o;return function(){var a=this,s=arguments;var r=function(){n=null;if(!i)o=e.apply(a,s)};var l=i&&!n;clearTimeout(n);n=setTimeout(r,t);if(l)o=e.apply(a,s);return o}};j.once=function(e){var t=false,i;return function(){if(t)return i;t=true;i=e.apply(this,arguments);e=null;return i}};j.wrap=function(e,t){return function(){var i=[e];s.apply(i,arguments);return t.apply(this,i)}};j.compose=function(){var e=arguments;return function(){var t=arguments;for(var i=e.length-1;i>=0;i--){t=[e[i].apply(this,t)]}return t[0]}};j.after=function(e,t){if(e<=0)return t();return function(){if(--e<1){return t.apply(this,arguments)}}};j.keys=y||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var i in e)if(j.has(e,i))t[t.length]=i;return t};j.values=function(e){var t=[];for(var i in e)if(j.has(e,i))t.push(e[i]);return t};j.pairs=function(e){var t=[];for(var i in e)if(j.has(e,i))t.push([i,e[i]]);return t};j.invert=function(e){var t={};for(var i in e)if(j.has(e,i))t[e[i]]=i;return t};j.functions=j.methods=function(e){var t=[];for(var i in e){if(j.isFunction(e[i]))t.push(i)}return t.sort()};j.extend=function(e){x(r.call(arguments,1),function(t){if(t){for(var i in t){e[i]=t[i]}}});return e};j.pick=function(e){var t={};var i=l.apply(n,r.call(arguments,1));x(i,function(i){if(i in e)t[i]=e[i]});return t};j.omit=function(e){var t={};var i=l.apply(n,r.call(arguments,1));for(var o in e){if(!j.contains(i,o))t[o]=e[o]}return t};j.defaults=function(e){x(r.call(arguments,1),function(t){if(t){for(var i in t){if(e[i]==null)e[i]=t[i]}}});return e};j.clone=function(e){if(!j.isObject(e))return e;return j.isArray(e)?e.slice():j.extend({},e)};j.tap=function(e,t){t(e);return e};var M=function(e,t,i,n){if(e===t)return e!==0||1/e==1/t;if(e==null||t==null)return e===t;if(e instanceof j)e=e._wrapped;if(t instanceof j)t=t._wrapped;var o=c.call(e);if(o!=c.call(t))return false;switch(o){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if(typeof e!="object"||typeof t!="object")return false;var a=i.length;while(a--){if(i[a]==e)return n[a]==t}i.push(e);n.push(t);var s=0,r=true;if(o=="[object Array]"){s=e.length;r=s==t.length;if(r){while(s--){if(!(r=M(e[s],t[s],i,n)))break}}}else{var l=e.constructor,d=t.constructor;if(l!==d&&!(j.isFunction(l)&&l instanceof l&&j.isFunction(d)&&d instanceof d)){return false}for(var u in e){if(j.has(e,u)){s++;if(!(r=j.has(t,u)&&M(e[u],t[u],i,n)))break}}if(r){for(u in t){if(j.has(t,u)&&!s--)break}r=!s}}i.pop();n.pop();return r};j.isEqual=function(e,t){return M(e,t,[],[])};j.isEmpty=function(e){if(e==null)return true;if(j.isArray(e)||j.isString(e))return e.length===0;for(var t in e)if(j.has(e,t))return false;return true};j.isElement=function(e){return!!(e&&e.nodeType===1)};j.isArray=b||function(e){return c.call(e)=="[object Array]"};j.isObject=function(e){return e===Object(e)};x(["Arguments","Function","String","Number","Date","RegExp"],function(e){j["is"+e]=function(t){return c.call(t)=="[object "+e+"]"}});if(!j.isArguments(arguments)){j.isArguments=function(e){return!!(e&&j.has(e,"callee"))}}if(typeof/./!=="function"){j.isFunction=function(e){return typeof e==="function"}}j.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))};j.isNaN=function(e){return j.isNumber(e)&&e!=+e};j.isBoolean=function(e){return e===true||e===false||c.call(e)=="[object Boolean]"};j.isNull=function(e){return e===null};j.isUndefined=function(e){return e===void 0};j.has=function(e,t){return d.call(e,t)};j.noConflict=function(){e._=t;return this};j.identity=function(e){return e};j.times=function(e,t,i){var n=Array(e);for(var o=0;o<e;o++)n[o]=t.call(i,o);return n};j.random=function(e,t){if(t==null){t=e;e=0}return e+Math.floor(Math.random()*(t-e+1))};var N={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};N.unescape=j.invert(N.escape);var A={escape:new RegExp("["+j.keys(N.escape).join("")+"]","g"),unescape:new RegExp("("+j.keys(N.unescape).join("|")+")","g")};j.each(["escape","unescape"],function(e){j[e]=function(t){if(t==null)return"";return(""+t).replace(A[e],function(t){return N[e][t]})}});j.result=function(e,t){if(e==null)return null;var i=e[t];return j.isFunction(i)?i.call(e):i};j.mixin=function(e){x(j.functions(e),function(t){var i=j[t]=e[t];j.prototype[t]=function(){var e=[this._wrapped];s.apply(e,arguments);return P.call(this,i.apply(j,e))}})};var O=0;j.uniqueId=function(e){var t=++O+"";return e?e+t:t};j.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var L=/(.)^/;var D={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"};var H=/\\|'|\r|\n|\t|\u2028|\u2029/g;j.template=function(e,t,i){var n;
i=j.defaults({},i,j.templateSettings);var o=new RegExp([(i.escape||L).source,(i.interpolate||L).source,(i.evaluate||L).source].join("|")+"|$","g");var a=0;var s="__p+='";e.replace(o,function(t,i,n,o,r){s+=e.slice(a,r).replace(H,function(e){return"\\"+D[e]});if(i){s+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"}if(n){s+="'+\n((__t=("+n+"))==null?'':__t)+\n'"}if(o){s+="';\n"+o+"\n__p+='"}a=r+t.length;return t});s+="';\n";if(!i.variable)s="with(obj||{}){\n"+s+"}\n";s="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{n=new Function(i.variable||"obj","_",s)}catch(r){r.source=s;throw r}if(t)return n(t,j);var l=function(e){return n.call(this,e,j)};l.source="function("+(i.variable||"obj")+"){\n"+s+"}";return l};j.chain=function(e){return j(e).chain()};var P=function(e){return this._chain?j(e).chain():e};j.mixin(j);x(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=n[e];j.prototype[e]=function(){var i=this._wrapped;t.apply(i,arguments);if((e=="shift"||e=="splice")&&i.length===0)delete i[0];return P.call(this,i)}});x(["concat","join","slice"],function(e){var t=n[e];j.prototype[e]=function(){return P.call(this,t.apply(this._wrapped,arguments))}});j.extend(j.prototype,{chain:function(){this._chain=true;return this},value:function(){return this._wrapped}})}).call(this);(function(){var e=this;var t=e.Backbone;var i=[];var n=i.push;var o=i.slice;var a=i.splice;var s;if(typeof exports!=="undefined"){s=exports}else{s=e.Backbone={}}s.VERSION="1.0.0";var r=e._;if(!r&&typeof require!=="undefined")r=require("underscore");s.$=e.jQuery||e.Zepto||e.ender||e.$;s.noConflict=function(){e.Backbone=t;return this};s.emulateHTTP=false;s.emulateJSON=false;var l=s.Events={on:function(e,t,i){if(!d(this,"on",e,[t,i])||!t)return this;this._events||(this._events={});var n=this._events[e]||(this._events[e]=[]);n.push({callback:t,context:i,ctx:i||this});return this},once:function(e,t,i){if(!d(this,"once",e,[t,i])||!t)return this;var n=this;var o=r.once(function(){n.off(e,o);t.apply(this,arguments)});o._callback=t;return this.on(e,o,i)},off:function(e,t,i){var n,o,a,s,l,c,u,f;if(!this._events||!d(this,"off",e,[t,i]))return this;if(!e&&!t&&!i){this._events={};return this}s=e?[e]:r.keys(this._events);for(l=0,c=s.length;l<c;l++){e=s[l];if(a=this._events[e]){this._events[e]=n=[];if(t||i){for(u=0,f=a.length;u<f;u++){o=a[u];if(t&&t!==o.callback&&t!==o.callback._callback||i&&i!==o.context){n.push(o)}}}if(!n.length)delete this._events[e]}}return this},trigger:function(e){if(!this._events)return this;var t=o.call(arguments,1);if(!d(this,"trigger",e,t))return this;var i=this._events[e];var n=this._events.all;if(i)u(i,t);if(n)u(n,arguments);return this},stopListening:function(e,t,i){var n=this._listeners;if(!n)return this;var o=!t&&!i;if(typeof t==="object")i=this;if(e)(n={})[e._listenerId]=e;for(var a in n){n[a].off(t,i,this);if(o)delete this._listeners[a]}return this}};var c=/\s+/;var d=function(e,t,i,n){if(!i)return true;if(typeof i==="object"){for(var o in i){e[t].apply(e,[o,i[o]].concat(n))}return false}if(c.test(i)){var a=i.split(c);for(var s=0,r=a.length;s<r;s++){e[t].apply(e,[a[s]].concat(n))}return false}return true};var u=function(e,t){var i,n=-1,o=e.length,a=t[0],s=t[1],r=t[2];switch(t.length){case 0:while(++n<o)(i=e[n]).callback.call(i.ctx);return;case 1:while(++n<o)(i=e[n]).callback.call(i.ctx,a);return;case 2:while(++n<o)(i=e[n]).callback.call(i.ctx,a,s);return;case 3:while(++n<o)(i=e[n]).callback.call(i.ctx,a,s,r);return;default:while(++n<o)(i=e[n]).callback.apply(i.ctx,t)}};var f={listenTo:"on",listenToOnce:"once"};r.each(f,function(e,t){l[t]=function(t,i,n){var o=this._listeners||(this._listeners={});var a=t._listenerId||(t._listenerId=r.uniqueId("l"));o[a]=t;if(typeof i==="object")n=this;t[e](i,n,this);return this}});l.bind=l.on;l.unbind=l.off;r.extend(s,l);var h=s.Model=function(e,t){var i;var n=e||{};t||(t={});this.cid=r.uniqueId("c");this.attributes={};r.extend(this,r.pick(t,g));if(t.parse)n=this.parse(n,t)||{};if(i=r.result(this,"defaults")){n=r.defaults({},n,i)}this.set(n,t);this.changed={};this.initialize.apply(this,arguments)};var g=["url","urlRoot","collection"];r.extend(h.prototype,l,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return r.clone(this.attributes)},sync:function(){return s.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return r.escape(this.get(e))},has:function(e){return this.get(e)!=null},set:function(e,t,i){var n,o,a,s,l,c,d,u;if(e==null)return this;if(typeof e==="object"){o=e;i=t}else{(o={})[e]=t}i||(i={});if(!this._validate(o,i))return false;a=i.unset;l=i.silent;s=[];c=this._changing;this._changing=true;if(!c){this._previousAttributes=r.clone(this.attributes);this.changed={}}u=this.attributes,d=this._previousAttributes;if(this.idAttribute in o)this.id=o[this.idAttribute];for(n in o){t=o[n];if(!r.isEqual(u[n],t))s.push(n);if(!r.isEqual(d[n],t)){this.changed[n]=t}else{delete this.changed[n]}a?delete u[n]:u[n]=t}if(!l){if(s.length)this._pending=true;for(var f=0,h=s.length;f<h;f++){this.trigger("change:"+s[f],this,u[s[f]],i)}}if(c)return this;if(!l){while(this._pending){this._pending=false;this.trigger("change",this,i)}}this._pending=false;this._changing=false;return this},unset:function(e,t){return this.set(e,void 0,r.extend({},t,{unset:true}))},clear:function(e){var t={};for(var i in this.attributes)t[i]=void 0;return this.set(t,r.extend({},e,{unset:true}))},hasChanged:function(e){if(e==null)return!r.isEmpty(this.changed);return r.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?r.clone(this.changed):false;var t,i=false;var n=this._changing?this._previousAttributes:this.attributes;for(var o in e){if(r.isEqual(n[o],t=e[o]))continue;(i||(i={}))[o]=t}return i},previous:function(e){if(e==null||!this._previousAttributes)return null;return this._previousAttributes[e]},previousAttributes:function(){return r.clone(this._previousAttributes)},fetch:function(e){e=e?r.clone(e):{};if(e.parse===void 0)e.parse=true;var t=this;var i=e.success;e.success=function(n){if(!t.set(t.parse(n,e),e))return false;if(i)i(t,n,e);t.trigger("sync",t,n,e)};P(this,e);return this.sync("read",this,e)},save:function(e,t,i){var n,o,a,s=this.attributes;if(e==null||typeof e==="object"){n=e;i=t}else{(n={})[e]=t}if(n&&(!i||!i.wait)&&!this.set(n,i))return false;i=r.extend({validate:true},i);if(!this._validate(n,i))return false;if(n&&i.wait){this.attributes=r.extend({},s,n)}if(i.parse===void 0)i.parse=true;var l=this;var c=i.success;i.success=function(e){l.attributes=s;var t=l.parse(e,i);if(i.wait)t=r.extend(n||{},t);if(r.isObject(t)&&!l.set(t,i)){return false}if(c)c(l,e,i);l.trigger("sync",l,e,i)};P(this,i);o=this.isNew()?"create":i.patch?"patch":"update";if(o==="patch")i.attrs=n;a=this.sync(o,this,i);if(n&&i.wait)this.attributes=s;return a},destroy:function(e){e=e?r.clone(e):{};var t=this;var i=e.success;var n=function(){t.trigger("destroy",t,t.collection,e)};e.success=function(o){if(e.wait||t.isNew())n();if(i)i(t,o,e);if(!t.isNew())t.trigger("sync",t,o,e)};if(this.isNew()){e.success();return false}P(this,e);var o=this.sync("delete",this,e);if(!e.wait)n();return o},url:function(){var e=r.result(this,"urlRoot")||r.result(this.collection,"url")||H();if(this.isNew())return e;return e+(e.charAt(e.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(e){return this._validate({},r.extend(e||{},{validate:true}))},_validate:function(e,t){if(!t.validate||!this.validate)return true;e=r.extend({},this.attributes,e);var i=this.validationError=this.validate(e,t)||null;if(!i)return true;this.trigger("invalid",this,i,r.extend(t||{},{validationError:i}));return false}});var p=["keys","values","pairs","invert","pick","omit"];r.each(p,function(e){h.prototype[e]=function(){var t=o.call(arguments);t.unshift(this.attributes);return r[e].apply(r,t)}});var m=s.Collection=function(e,t){t||(t={});if(t.url)this.url=t.url;if(t.model)this.model=t.model;if(t.comparator!==void 0)this.comparator=t.comparator;this._reset();this.initialize.apply(this,arguments);if(e)this.reset(e,r.extend({silent:true},t))};var v={add:true,remove:true,merge:true};var _={add:true,merge:false,remove:false};r.extend(m.prototype,l,{model:h,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return s.sync.apply(this,arguments)},add:function(e,t){return this.set(e,r.defaults(t||{},_))},remove:function(e,t){e=r.isArray(e)?e.slice():[e];t||(t={});var i,n,o,a;for(i=0,n=e.length;i<n;i++){a=this.get(e[i]);if(!a)continue;delete this._byId[a.id];delete this._byId[a.cid];o=this.indexOf(a);this.models.splice(o,1);this.length--;if(!t.silent){t.index=o;a.trigger("remove",a,this,t)}this._removeReference(a)}return this},set:function(e,t){t=r.defaults(t||{},v);if(t.parse)e=this.parse(e,t);if(!r.isArray(e))e=e?[e]:[];var i,o,s,l,c,d;var u=t.at;var f=this.comparator&&u==null&&t.sort!==false;var h=r.isString(this.comparator)?this.comparator:null;var g=[],p=[],m={};for(i=0,o=e.length;i<o;i++){if(!(s=this._prepareModel(e[i],t)))continue;if(c=this.get(s)){if(t.remove)m[c.cid]=true;if(t.merge){c.set(s.attributes,t);if(f&&!d&&c.hasChanged(h))d=true}}else if(t.add){g.push(s);s.on("all",this._onModelEvent,this);this._byId[s.cid]=s;if(s.id!=null)this._byId[s.id]=s}}if(t.remove){for(i=0,o=this.length;i<o;++i){if(!m[(s=this.models[i]).cid])p.push(s)}if(p.length)this.remove(p,t)}if(g.length){if(f)d=true;this.length+=g.length;if(u!=null){a.apply(this.models,[u,0].concat(g))}else{n.apply(this.models,g)}}if(d)this.sort({silent:true});if(t.silent)return this;for(i=0,o=g.length;i<o;i++){(s=g[i]).trigger("add",s,this,t)}if(d)this.trigger("sort",this,t);return this},reset:function(e,t){t||(t={});for(var i=0,n=this.models.length;i<n;i++){this._removeReference(this.models[i])}t.previousModels=this.models;this._reset();this.add(e,r.extend({silent:true},t));if(!t.silent)this.trigger("reset",this,t);return this},push:function(e,t){e=this._prepareModel(e,t);this.add(e,r.extend({at:this.length},t));return e},pop:function(e){var t=this.at(this.length-1);this.remove(t,e);return t},unshift:function(e,t){e=this._prepareModel(e,t);this.add(e,r.extend({at:0},t));return e},shift:function(e){var t=this.at(0);this.remove(t,e);return t},slice:function(e,t){return this.models.slice(e,t)},get:function(e){if(e==null)return void 0;return this._byId[e.id!=null?e.id:e.cid||e]},at:function(e){return this.models[e]},where:function(e,t){if(r.isEmpty(e))return t?void 0:[];return this[t?"find":"filter"](function(t){for(var i in e){if(e[i]!==t.get(i))return false}return true})},findWhere:function(e){return this.where(e,true)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");e||(e={});if(r.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this)}else{this.models.sort(r.bind(this.comparator,this))}if(!e.silent)this.trigger("sort",this,e);return this},sortedIndex:function(e,t,i){t||(t=this.comparator);var n=r.isFunction(t)?t:function(e){return e.get(t)};return r.sortedIndex(this.models,e,n,i)},pluck:function(e){return r.invoke(this.models,"get",e)},fetch:function(e){e=e?r.clone(e):{};if(e.parse===void 0)e.parse=true;var t=e.success;var i=this;e.success=function(n){var o=e.reset?"reset":"set";i[o](n,e);if(t)t(i,n,e);i.trigger("sync",i,n,e)};P(this,e);return this.sync("read",this,e)},create:function(e,t){t=t?r.clone(t):{};if(!(e=this._prepareModel(e,t)))return false;if(!t.wait)this.add(e,t);var i=this;var n=t.success;t.success=function(o){if(t.wait)i.add(e,t);if(n)n(e,o,t)};e.save(null,t);return e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(e,t){if(e instanceof h){if(!e.collection)e.collection=this;return e}t||(t={});t.collection=this;var i=new this.model(e,t);if(!i._validate(e,t)){this.trigger("invalid",this,e,t);return false}return i},_removeReference:function(e){if(this===e.collection)delete e.collection;e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,i,n){if((e==="add"||e==="remove")&&i!==this)return;if(e==="destroy")this.remove(t,n);if(t&&e==="change:"+t.idAttribute){delete this._byId[t.previous(t.idAttribute)];if(t.id!=null)this._byId[t.id]=t}this.trigger.apply(this,arguments)}});var w=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];r.each(w,function(e){m.prototype[e]=function(){var t=o.call(arguments);t.unshift(this.models);return r[e].apply(r,t)}});var b=["groupBy","countBy","sortBy"];r.each(b,function(e){m.prototype[e]=function(t,i){var n=r.isFunction(t)?t:function(e){return e.get(t)};return r[e](this.models,n,i)}});var y=s.View=function(e){this.cid=r.uniqueId("view");this._configure(e||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var C=/^(\S+)\s*(.*)$/;var j=["model","collection","el","id","attributes","className","tagName","events"];r.extend(y.prototype,l,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();this.stopListening();return this},setElement:function(e,t){if(this.$el)this.undelegateEvents();this.$el=e instanceof s.$?e:s.$(e);this.el=this.$el[0];if(t!==false)this.delegateEvents();return this},delegateEvents:function(e){if(!(e||(e=r.result(this,"events"))))return this;this.undelegateEvents();for(var t in e){var i=e[t];if(!r.isFunction(i))i=this[e[t]];if(!i)continue;var n=t.match(C);var o=n[1],a=n[2];i=r.bind(i,this);o+=".delegateEvents"+this.cid;if(a===""){this.$el.on(o,i)}else{this.$el.on(o,a,i)}}return this},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid);return this},_configure:function(e){if(this.options)e=r.extend({},r.result(this,"options"),e);r.extend(this,r.pick(e,j));this.options=e},_ensureElement:function(){if(!this.el){var e=r.extend({},r.result(this,"attributes"));if(this.id)e.id=r.result(this,"id");if(this.className)e["class"]=r.result(this,"className");var t=s.$("<"+r.result(this,"tagName")+">").attr(e);this.setElement(t,false)}else{this.setElement(r.result(this,"el"),false)}}});s.sync=function(e,t,i){var n=x[e];r.defaults(i||(i={}),{emulateHTTP:s.emulateHTTP,emulateJSON:s.emulateJSON});var o={type:n,dataType:"json"};if(!i.url){o.url=r.result(t,"url")||H()}if(i.data==null&&t&&(e==="create"||e==="update"||e==="patch")){o.contentType="application/json";o.data=JSON.stringify(i.attrs||t.toJSON(i))}if(i.emulateJSON){o.contentType="application/x-www-form-urlencoded";o.data=o.data?{model:o.data}:{}}if(i.emulateHTTP&&(n==="PUT"||n==="DELETE"||n==="PATCH")){o.type="POST";if(i.emulateJSON)o.data._method=n;var a=i.beforeSend;i.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",n);if(a)return a.apply(this,arguments)}}if(o.type!=="GET"&&!i.emulateJSON){o.processData=false}if(o.type==="PATCH"&&window.ActiveXObject&&!(window.external&&window.external.msActiveXFilteringEnabled)){o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")}}var l=i.xhr=s.ajax(r.extend(o,i));t.trigger("request",t,l,i);return l};var x={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};s.ajax=function(){return s.$.ajax.apply(s.$,arguments)};var E=s.Router=function(e){e||(e={});if(e.routes)this.routes=e.routes;this._bindRoutes();this.initialize.apply(this,arguments)};var k=/\((.*?)\)/g;var T=/(\(\?)?:\w+/g;var I=/\*\w+/g;var S=/[\-{}\[\]+?.,\\\^$|#\s]/g;r.extend(E.prototype,l,{initialize:function(){},route:function(e,t,i){if(!r.isRegExp(e))e=this._routeToRegExp(e);if(r.isFunction(t)){i=t;t=""}if(!i)i=this[t];var n=this;s.history.route(e,function(o){var a=n._extractParameters(e,o);i&&i.apply(n,a);n.trigger.apply(n,["route:"+t].concat(a));n.trigger("route",t,a);s.history.trigger("route",n,t,a)});return this},navigate:function(e,t){s.history.navigate(e,t);return this},_bindRoutes:function(){if(!this.routes)return;this.routes=r.result(this,"routes");var e,t=r.keys(this.routes);while((e=t.pop())!=null){this.route(e,this.routes[e])}},_routeToRegExp:function(e){e=e.replace(S,"\\$&").replace(k,"(?:$1)?").replace(T,function(e,t){return t?e:"([^/]+)"}).replace(I,"(.*?)");return new RegExp("^"+e+"$")},_extractParameters:function(e,t){var i=e.exec(t).slice(1);return r.map(i,function(e){return e?decodeURIComponent(e):null})}});var M=s.History=function(){this.handlers=[];r.bindAll(this,"checkUrl");if(typeof window!=="undefined"){this.location=window.location;this.history=window.history}};var N=/^[#\/]|\s+$/g;var A=/^\/+|\/+$/g;var O=/msie [\w.]+/;var L=/\/$/;M.started=false;r.extend(M.prototype,l,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(e==null){if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var i=this.root.replace(L,"");if(!e.indexOf(i))e=e.substr(i.length)}else{e=this.getHash()}}return e.replace(N,"")},start:function(e){if(M.started)throw new Error("Backbone.history has already been started");M.started=true;this.options=r.extend({},{root:"/"},this.options,e);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var t=this.getFragment();var i=document.documentMode;var n=O.exec(navigator.userAgent.toLowerCase())&&(!i||i<=7);this.root=("/"+this.root+"/").replace(A,"/");if(n&&this._wantsHashChange){this.iframe=s.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;this.navigate(t)}if(this._hasPushState){s.$(window).on("popstate",this.checkUrl)}else if(this._wantsHashChange&&"onhashchange"in window&&!n){s.$(window).on("hashchange",this.checkUrl)}else if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval)}this.fragment=t;var o=this.location;var a=o.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!a){this.fragment=this.getFragment(null,true);this.location.replace(this.root+this.location.search+"#"+this.fragment);return true}else if(this._wantsPushState&&this._hasPushState&&a&&o.hash){this.fragment=this.getHash().replace(N,"");this.history.replaceState({},document.title,this.root+this.fragment+o.search)}if(!this.options.silent)return this.loadUrl()},stop:function(){s.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);M.started=false},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();if(t===this.fragment&&this.iframe){t=this.getFragment(this.getHash(this.iframe))}if(t===this.fragment)return false;if(this.iframe)this.navigate(t);this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(e){var t=this.fragment=this.getFragment(e);var i=r.any(this.handlers,function(e){if(e.route.test(t)){e.callback(t);return true}});return i},navigate:function(e,t){if(!M.started)return false;if(!t||t===true)t={trigger:t};e=this.getFragment(e||"");if(this.fragment===e)return;this.fragment=e;var i=this.root+e;if(this._hasPushState){this.history[t.replace?"replaceState":"pushState"]({},document.title,i)}else if(this._wantsHashChange){this._updateHash(this.location,e,t.replace);if(this.iframe&&e!==this.getFragment(this.getHash(this.iframe))){if(!t.replace)this.iframe.document.open().close();this._updateHash(this.iframe.location,e,t.replace)}}else{return this.location.assign(i)}if(t.trigger)this.loadUrl(e)},_updateHash:function(e,t,i){if(i){var n=e.href.replace(/(javascript:|#).*$/,"");e.replace(n+"#"+t)}else{e.hash="#"+t}}});s.history=new M;var D=function(e,t){var i=this;var n;if(e&&r.has(e,"constructor")){n=e.constructor}else{n=function(){return i.apply(this,arguments)}}r.extend(n,i,t);var o=function(){this.constructor=n};o.prototype=i.prototype;n.prototype=new o;if(e)r.extend(n.prototype,e);n.__super__=i.prototype;return n};h.extend=m.extend=E.extend=y.extend=M.extend=D;var H=function(){throw new Error('A "url" property or function must be specified')};var P=function(e,t){var i=t.error;t.error=function(n){if(i)i(e,n,t);e.trigger("error",e,n,t)}}}).call(this);(function(e){if(typeof define==="function"&&define.amd){define(["underscore","backbone"],e)}else{e(_,Backbone)}})(function(e,t){function i(t){var n={},o=s.keyPathSeparator;for(var a in t){var r=t[a];if(r&&r.constructor===Object&&!e.isEmpty(r)){var l=i(r);for(var c in l){var d=l[c];n[a+o+c]=d}}else{n[a]=r}}return n}function n(t,i,n){var o=s.keyPathSeparator;var a=i.split(o);var r=t;n||n===false;for(var l=0,c=a.length;l<c;l++){if(n&&!e.has(r,a[l])){return false}r=r[a[l]];if(r==null&&l<c-1){r={}}if(typeof r==="undefined"){if(n){return true}return r}}if(n){return true}return r}function o(t,i,n,o){o=o||{};var a=s.keyPathSeparator;var r=i.split(a);var l=t;for(var c=0,d=r.length;c<d&&l!==undefined;c++){var u=r[c];if(c===d-1){o.unset?delete l[u]:l[u]=n}else{if(typeof l[u]==="undefined"||!e.isObject(l[u])){l[u]={}}l=l[u]}}}function a(e,t){o(e,t,null,{unset:true})}var s=t.Model.extend({constructor:function(t,i){var n;var o=t||{};this.cid=e.uniqueId("c");this.attributes={};if(i&&i.collection)this.collection=i.collection;if(i&&i.parse)o=this.parse(o,i)||{};if(n=e.result(this,"defaults")){o=e.deepExtend({},n,o)}this.set(o,i);this.changed={};this.initialize.apply(this,arguments)},toJSON:function(t){return e.deepClone(this.attributes)},get:function(e){return n(this.attributes,e)},set:function(t,r,l){var c,d,u,f,h,g,p,m;if(t==null)return this;if(typeof t==="object"){d=t;l=r||{}}else{(d={})[t]=r}l||(l={});if(!this._validate(d,l))return false;u=l.unset;h=l.silent;f=[];g=this._changing;this._changing=true;if(!g){this._previousAttributes=e.deepClone(this.attributes);this.changed={}}m=this.attributes,p=this._previousAttributes;if(this.idAttribute in d)this.id=d[this.idAttribute];d=i(d);for(c in d){r=d[c];if(!e.isEqual(n(m,c),r))f.push(c);if(!e.isEqual(n(p,c),r)){o(this.changed,c,r)}else{a(this.changed,c)}u?a(m,c):o(m,c,r)}if(!h){if(f.length)this._pending=true;var v=s.keyPathSeparator;var _={};for(var w=0,b=f.length;w<b;w++){var t=f[w];if(!_.hasOwnProperty(t)||!_[t]){_[t]=true;this.trigger("change:"+t,this,n(m,t),l)}var y=t.split(v);for(var C=y.length-1;C>0;C--){var j=e.first(y,C).join(v),x=j+v+"*";if(!_.hasOwnProperty(x)||!_[x]){_[x]=true;this.trigger("change:"+x,this,n(m,j),l)}if(!_.hasOwnProperty(j)||!_[j]){_[j]=true;this.trigger("change:"+j,this,n(m,j),l)}}}}if(g)return this;if(!h){while(this._pending){this._pending=false;this.trigger("change",this,l)}}this._pending=false;this._changing=false;return this},clear:function(t){var n={};var o=i(this.attributes);for(var a in o)n[a]=void 0;return this.set(n,e.extend({},t,{unset:true}))},hasChanged:function(t){if(t==null)return!e.isEmpty(this.changed);return n(this.changed,t)!==undefined},changedAttributes:function(t){if(!t)return this.hasChanged()?i(this.changed):false;var n=this._changing?this._previousAttributes:this.attributes;t=i(t);n=i(n);var o,a=false;for(var s in t){if(e.isEqual(n[s],o=t[s]))continue;(a||(a={}))[s]=o}return a},previous:function(e){if(e==null||!this._previousAttributes)return null;return n(this._previousAttributes,e)},previousAttributes:function(){return e.deepClone(this._previousAttributes)}});s.keyPathSeparator=".";t.DeepModel=s;if(typeof module!="undefined")module.exports=s;return t});var machina=function(e,t){var i=[].slice;var n="transition";var o="handler";var a="handling";var s="handled";var r="nohandler";var l="transition";var c="invalidstate";var d="deferred";var u="newfsm";var f={makeFsmNamespace:function(){var e=0;return function(){return"fsm."+e++}}(),getDefaultOptions:function(){return{initialState:"uninitialized",eventListeners:{"*":[]},states:{},eventQueue:[],namespace:f.makeFsmNamespace(),targetReplayState:"",state:t,priorState:t,_priorAction:"",_currentAction:""}}};if(!e.deepExtend){var h={"*":function(e,t,i){e[t]=i},object:function(e,t,i){e[t]=m({},e[t]||{},i)},array:function(t,i,n){t[i]=[];e.each(n,function(e,n){h[p(e)](t[i],n,e)},this)}},g=function(t){if(e.isArray(t)){return"array"}if(e.isDate(t)){return"date"}if(e.isRegExp(t)){return"regex"}return typeof t},p=function(e){var t=g(e);return h[t]?t:"*"},m=function(t){e.each(i.call(arguments,1),function(i){e.each(i,function(e,i){h[p(e)](t,i,e)})});return t};e.mixin({deepExtend:m})}var v=function(t){e.extend(this,t);e.defaults(this,f.getDefaultOptions());this.initialize.apply(this,arguments);b.emit(u,this);if(this.initialState){this.transition(this.initialState)}};e.extend(v.prototype,{initialize:function(){},emit:function(t){var n=arguments;if(this.eventListeners["*"]){e.each(this.eventListeners["*"],function(e){try{e.apply(this,i.call(n,0))}catch(t){reportException(t);log(t.message)}},this)}if(this.eventListeners[t]){e.each(this.eventListeners[t],function(e){try{e.apply(this,i.call(n,1))}catch(t){reportException(t);log(t.message)}},this)}},handle:function(n){if(!this.inExitHandler){var l=this.states,c=this.state,d=i.call(arguments,0),u,f,h,g;this.currentActionArgs=d;if(l[c][n]||l[c]["*"]||this["*"]){u=l[c][n]?n:"*";h=u==="*";if(l[c][u]){f=l[c][u];g=c+"."+u}else{f=this["*"];g="*"}if(!this._currentAction)this._currentAction=g;this.emit.call(this,a,{inputType:n,args:d.slice(1)});if(e.isFunction(f))f=f.apply(this,h?d:d.slice(1));if(e.isString(f))this.transition(f);this.emit.call(this,s,{inputType:n,args:d.slice(1)});this._priorAction=this._currentAction;this._currentAction="";this.processQueue(o)}else{this.emit.call(this,r,{inputType:n,args:d.slice(1)})}this.currentActionArgs=t}},transition:function(e){if(!this.inExitHandler&&e!==this.state){var t;if(this.states[e]){this.targetReplayState=e;this.priorState=this.state;this.state=e;t=this.priorState;if(this.states[t]&&this.states[t]._onExit){this.inExitHandler=true;this.states[t]._onExit.call(this);this.inExitHandler=false}this.emit.call(this,l,{fromState:t,action:this._currentAction,toState:e});if(this.states[e]._onEnter){try{this.states[e]._onEnter.call(this)}catch(i){reportException(i);log(i.message)}}if(this.targetReplayState===e){this.processQueue(n)}return}this.emit.call(this,c,{state:this.state,attemptedState:e})}},processQueue:function(t){var i=t===n?function(e){return e.type===n&&(!e.untilState||e.untilState===this.state)}:function(e){return e.type===o};var a=e.filter(this.eventQueue,i,this);this.eventQueue=e.difference(this.eventQueue,a);e.each(a,function(e){this.handle.apply(this,e.args)},this)},clearQueue:function(t,i){if(!t){this.eventQueue=[]}else{var a;if(t===n){a=function(e){return e.type===n&&(i?e.untilState===i:true)}}else if(t===o){a=function(e){return e.type===o}}this.eventQueue=e.filter(this.eventQueue,a)}},deferUntilTransition:function(e){if(this.currentActionArgs){var t={type:n,untilState:e,args:this.currentActionArgs};this.eventQueue.push(t);this.emit.call(this,d,{state:this.state,queuedArgs:t})}},deferUntilNextHandler:function(){if(this.currentActionArgs){var e={type:n,args:this.currentActionArgs};this.eventQueue.push(e);this.emit.call(this,d,{state:this.state,queuedArgs:e})}},on:function(e,t){var i=this;if(!i.eventListeners[e]){i.eventListeners[e]=[]}i.eventListeners[e].push(t);return{eventName:e,callback:t,off:function(){i.off(e,t)}}},off:function(t,i){if(!t){this.eventListeners={}}else{if(this.eventListeners[t]){if(i){this.eventListeners[t]=e.without(this.eventListeners[t],i)}else{this.eventListeners[t]=[]}}}}});v.prototype.trigger=v.prototype.emit;var _=function(){};var w=function(t,i,n){var o;if(i&&i.hasOwnProperty("constructor")){o=i.constructor}else{o=function(){t.apply(this,arguments)}}e.deepExtend(o,t);_.prototype=t.prototype;o.prototype=new _;if(i){e.deepExtend(o.prototype,i)}if(n){e.deepExtend(o,n)}o.prototype.constructor=o;o.__super__=t.prototype;return o};v.extend=function(e,t){var i=w(this,e,t);i.extend=this.extend;return i};var b={Fsm:v,utils:f,on:function(e,t){if(!this.eventListeners[e]){this.eventListeners[e]=[]}this.eventListeners[e].push(t);return t},off:function(t,i){if(this.eventListeners[t]){this.eventListeners[t]=e.without(this.eventListeners[t],i)}},trigger:function(t){var n=0,o,a=arguments,s=this.eventListeners[t]||[];if(s&&s.length){e.each(s,function(e){e.apply(null,i.call(a,1))})}},eventListeners:{newFsm:[]}};b.emit=b.trigger;return b}(_);if(typeof JSON!=="object"){JSON={}}(function(){"use strict";function f(e){return e<10?"0"+e:e}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(e){escapable.lastIndex=0;return escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t==="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var i,n,o,a,s=gap,r,l=t[e];if(l&&typeof l==="object"&&typeof l.toJSON==="function"){l=l.toJSON(e)}if(typeof rep==="function"){l=rep.call(t,e,l)}switch(typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l){return"null"}gap+=indent;r=[];if(Object.prototype.toString.apply(l)==="[object Array]"){a=l.length;for(i=0;i<a;i+=1){r[i]=str(i,l)||"null"}o=r.length===0?"[]":gap?"[\n"+gap+r.join(",\n"+gap)+"\n"+s+"]":"["+r.join(",")+"]";gap=s;return o}if(rep&&typeof rep==="object"){a=rep.length;for(i=0;i<a;i+=1){if(typeof rep[i]==="string"){n=rep[i];o=str(n,l);if(o){r.push(quote(n)+(gap?": ":":")+o)}}}}else{for(n in l){if(Object.prototype.hasOwnProperty.call(l,n)){o=str(n,l);if(o){r.push(quote(n)+(gap?": ":":")+o)}}}}o=r.length===0?"{}":gap?"{\n"+gap+r.join(",\n"+gap)+"\n"+s+"}":"{"+r.join(",")+"}";gap=s;return o}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(e,t,i){var n;gap="";indent="";if(typeof i==="number"){for(n=0;n<i;n+=1){indent+=" "}}else if(typeof i==="string"){indent=i}rep=t;if(t&&typeof t!=="function"&&(typeof t!=="object"||typeof t.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":e})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(e,t){var i,n,o=e[t];if(o&&typeof o==="object"){for(i in o){if(Object.prototype.hasOwnProperty.call(o,i)){n=walk(o,i);if(n!==undefined){o[i]=n}else{delete o[i]}}}}return reviver.call(e,t,o)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}})();(function(){var e,t,i,n;t=window.device;e={};window.device=e;n=window.navigator.userAgent.toLowerCase();
e.safari=function(){return i("safari")&&!e.chrome()};e.chrome=function(){return i("chrome")};e.ios=function(){return e.iphone()||e.ipod()||e.ipad()};e.iphone=function(){return!e.windows()&&i("iphone")};e.ipod=function(){return i("ipod")};e.ipad=function(){return i("ipad")};e.chromeIOS=function(){return i("crios")};e.android=function(){return!e.windows()&&i("android")};e.androidPhone=function(){return e.android()&&i("mobile")};e.androidTablet=function(){return e.android()&&!i("mobile")};e.blackberry=function(){return i("blackberry")||i("bb10")||i("rim")};e.blackberryPhone=function(){return e.blackberry()&&!i("tablet")};e.blackberryTablet=function(){return e.blackberry()&&i("tablet")};e.windows=function(){return i("windows")};e.windowsPhone=function(){return e.windows()&&i("phone")};e.windowsTablet=function(){return e.windows()&&(i("touch")&&!e.windowsPhone())};e.fxos=function(){return(i("(mobile;")||i("(tablet;"))&&i("; rv:")};e.fxosPhone=function(){return e.fxos()&&i("mobile")};e.fxosTablet=function(){return e.fxos()&&i("tablet")};e.meego=function(){return i("meego")};e.cordova=function(){return window.cordova&&location.protocol==="file:"};e.nodeWebkit=function(){return typeof window.process==="object"};e.mobile=function(){return e.androidPhone()||e.iphone()||e.ipod()||e.windowsPhone()||e.blackberryPhone()||e.fxosPhone()||e.meego()};e.tablet=function(){return e.ipad()||e.androidTablet()||e.blackberryTablet()||e.windowsTablet()||e.fxosTablet()};e.desktop=function(){return!e.tablet()&&!e.mobile()};e.television=function(){var e;var t=["googletv","viera","smarttv","internet.tv","netcast","nettv","appletv","boxee","kylo","roku","dlnadoc","roku","pov_tv","hbbtv","ce-html"];e=0;while(e<t.length){if(i(t[e])){return true}e++}return false};e.portrait=function(){return window.innerHeight/window.innerWidth>1};e.landscape=function(){return window.innerHeight/window.innerWidth<1};e.noConflict=function(){window.device=t;return this};i=function(e){return n.indexOf(e)!==-1}}).call(this);(function(e){var t=e.setTimeout,i=e.document,n=0;e.jivoXHR=function(){var o,a,s,r=null;function l(){try{s.parentNode.removeChild(s)}catch(e){}}function c(){a=false;o="";l();s=null}function d(e){try{r.onerror.call(r,e,o)}catch(t){throw new Error(e)}}function u(){if(this.readyState&&this.readyState!=="complete"&&this.readyState!=="loaded"||a){return}this.onload=this.onreadystatechange=null;a=true;if(r.readyState!==4){d("Script failed to load ["+o+"].")}l()}function f(e){e=e||[];r.readyState=4;r.status=200;if(typeof r.onload==="function"){r.onload.apply(r,e)}}r={onerror:null,onload:null,readyState:0,open:function(t,i){c();var a="cb"+n++;(function(t){e.jivoXHR[t]=function(){try{f.call(r,arguments)}catch(i){r.readyState=-1;d(i.message)}e.jivoXHR[t]=null}})(a);o=i.replace(/=\?/,"=jivoXHR."+a)},send:function(){t(function(){s=i.createElement("script");s.setAttribute("type","text/javascript");s.charset="UTF-8";s.onload=s.onreadystatechange=function(){u.call(s)};s.setAttribute("src",o);i.getElementsByTagName("head")[0].appendChild(s)},0)},abort:function(){},setRequestHeader:function(){},getResponseHeader:function(){return""},getAllResponseHeaders:function(){return[]}};c();return r}})(window);function log(){if(!("logs"in config)){return}var e=Array.prototype.slice.call(arguments);if(typeof console!="undefined"&&typeof console.log=="function"){if(window&&window.opera){var t=0;while(t<arguments.length){console.log("Item "+(t+1)+": "+arguments[t]);t++}}else if(e.length==1&&typeof e[0]=="string"){console.log(e.toString())}else{console.log(e)}}else if(typeof console!="undefined"&&typeof console.log=="object"){Function.prototype.call.call(console.log,console,e)}}function hexToR(e){return parseInt(cutHex(e).substring(0,2),16)}function hexToG(e){return parseInt(cutHex(e).substring(2,4),16)}function hexToB(e){return parseInt(cutHex(e).substring(4,6),16)}function cutHex(e){return e.charAt(0)=="#"?e.substring(1,7):e}function rgbToHex(e,t,i){return toHex(e)+toHex(t)+toHex(i)}function toHex(e){e=parseInt(e,10);if(isNaN(e))return"00";e=Math.max(0,Math.min(e,255));return"0123456789ABCDEF".charAt((e-e%16)/16)+"0123456789ABCDEF".charAt(e%16)}function adjustLightness(e,t,i){var n=hexToR(e);var o=hexToG(e);var a=hexToB(e);log("r="+n+" g="+o+" b="+a);var s=ColorConverter.toHSV(new RGB(n,o,a));if(s.v>0)s.v=s.v*t;else s.v=100*(t-1);s.s=s.s*i;var r=ColorConverter.toRGB(s);var l=rgbToHex(r.r,r.g,r.b);return"#"+l}function getLightness(e){var t=hexToR(e);var i=hexToG(e);var n=hexToB(e);var o=ColorConverter.toHSV(new RGB(t,i,n));return o.v}function isLightColor(e){return getLightness(e)>65}function HSV(e,t,i){if(e<=0){e=0}if(t<=0){t=0}if(i<=0){i=0}if(e>360){e=360}if(t>100){t=100}if(i>100){i=100}this.h=e;this.s=t;this.v=i}function RGB(e,t,i){if(e<=0){e=0}if(t<=0){t=0}if(i<=0){i=0}if(e>255){e=255}if(t>255){t=255}if(i>255){i=255}this.r=e;this.g=t;this.b=i}function CMYK(e,t,i,n){if(e<=0){e=0}if(t<=0){t=0}if(i<=0){i=0}if(n<=0){n=0}if(e>100){e=100}if(t>100){t=100}if(i>100){i=100}if(n>100){n=100}this.c=e;this.m=t;this.y=i;this.k=n}var ColorConverter={_RGBtoHSV:function(e){var t=new HSV(0,0,0);var i=e.r/255;var n=e.g/255;var o=e.b/255;var a=Math.min(i,n,o);var s=Math.max(i,n,o);var r=s-a;t.v=s;if(r==0){t.h=0;t.s=0}else{t.s=r/s;var l=((s-i)/6+r/2)/r;var c=((s-n)/6+r/2)/r;var d=((s-o)/6+r/2)/r;if(i==s){t.h=d-c}else if(n==s){t.h=1/3+l-d}else if(o==s){t.h=2/3+c-l}if(t.h<0){t.h+=1}if(t.h>1){t.h-=1}}t.h=Math.round(t.h*360);t.s=Math.round(t.s*100);t.v=Math.round(t.v*100);return t},_HSVtoRGB:function(e){var t=new RGB(0,0,0);var i=e.h/360;var n=e.s/100;var o=e.v/100;if(n==0){t.r=o*255;t.g=o*255;t.b=o*255}else{var a=i*6;var s=Math.floor(a);var r=o*(1-n);var l=o*(1-n*(a-s));var c=o*(1-n*(1-(a-s)));var d,u,f;if(s==0){d=o;u=c;f=r}else if(s==1){d=l;u=o;f=r}else if(s==2){d=r;u=o;f=c}else if(s==3){d=r;u=l;f=o}else if(s==4){d=c;u=r;f=o}else{d=o;u=r;f=l}t.r=d*255;t.g=u*255;t.b=f*255;t.r=Math.round(t.r);t.g=Math.round(t.g);t.b=Math.round(t.b)}return t},_CMYKtoRGB:function(e){var t=new RGB(0,0,0);var i=e.c/100;var n=e.m/100;var o=e.y/100;var a=e.k/100;t.r=1-Math.min(1,i*(1-a)+a);t.g=1-Math.min(1,n*(1-a)+a);t.b=1-Math.min(1,o*(1-a)+a);t.r=Math.round(t.r*255);t.g=Math.round(t.g*255);t.b=Math.round(t.b*255);return t},_RGBtoCMYK:function(e){var t=new CMYK(0,0,0,0);var i=e.r/255;var n=e.g/255;var o=e.b/255;t.k=Math.min(1-i,1-n,1-o);t.c=(1-i-t.k)/(1-t.k);t.m=(1-n-t.k)/(1-t.k);t.y=(1-o-t.k)/(1-t.k);t.c=Math.round(t.c*100);t.m=Math.round(t.m*100);t.y=Math.round(t.y*100);t.k=Math.round(t.k*100);return t},toRGB:function(e){if(e instanceof RGB){return e}if(e instanceof HSV){return this._HSVtoRGB(e)}if(e instanceof CMYK){return this._CMYKtoRGB(e)}},toHSV:function(e){if(e instanceof HSV){return e}if(e instanceof RGB){return this._RGBtoHSV(e)}if(e instanceof CMYK){return this._RGBtoHSV(this._CMYKtoRGB(e))}},toCMYK:function(e){if(e instanceof CMYK){return e}if(e instanceof RGB){return this._RGBtoCMYK(e)}if(e instanceof HSV){return this._RGBtoCMYK(this._HSVtoRGB(e))}}};var underscore=_.noConflict(),devicejs=device.noConflict();underscore.templateSettings.interpolate=/\{\{(.+?)\}\}/g;var appVersion=navigator.appVersion;var ie8=appVersion.indexOf("MSIE 8.")!==-1;var ie9=appVersion.indexOf("MSIE 9.")!==-1;var ie=appVersion.indexOf("MSIE")!==-1;function addListener(e,t,i){if(e.addEventListener){e.addEventListener(t,i,false)}else if(e.attachEvent){e.attachEvent("on"+t,function(e){return function(){i.call(e,window.event)}}(e));e=null}}function removeEvent(e,t,i){if(window.removeEventListener){e.removeEventListener(t,i,false)}else if(window.detachEvent){var n=function(){i.call(e)};e.detachEvent("on"+t,n)}else{return false}}function loadScript(e,t,i){var n=document.createElement("script");n.type="text/javascript";if(n.readyState){n.onreadystatechange=function(){if(n.readyState=="loaded"||n.readyState=="complete"){n.onreadystatechange=null;t()}else{i({target:n,readyState:readyState})}}}else{n.onload=function(){t()};n.onerror=function(e){i(e)}}n.src=e;if(typeof log!="undefined")log("adding script "+e);document.getElementsByTagName("head")[0].appendChild(n)}function setIframeLoadCallback(e,t){if(e.readyState){log("Using readyState callback");e.onreadystatechange=function(){if(e.readyState=="loaded"||e.readyState=="complete"){e.onreadystatechange=null;t()}}}else{log("Using onload callback");e.onload=function(){if(e.contentWindow.location.href!="about:blank"){t();e.onload=null}}}}var dateFormat=function(){var e=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,t=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,i=/[^-+\dA-Z]/g,n=function(e,t){e=String(e);t=t||2;while(e.length<t)e="0"+e;return e};return function(o,a,s){var r=dateFormat;if(arguments.length==1&&Object.prototype.toString.call(o)=="[object String]"&&!/\d/.test(o)){a=o;o=undefined}if(typeof o==="string"&&isNaN(new Date(o))){o=o.replace(/-/g,"/").replace("T"," ").split(".").shift()+"Z"}o=o?new Date(o):new Date;if(isNaN(o))throw SyntaxError("invalid date");a=String(r.masks[a]||a||r.masks["default"]);if(a.slice(0,4)=="UTC:"){a=a.slice(4);s=true}var l=s?"getUTC":"get",c=o[l+"Date"](),d=o[l+"Day"](),u=o[l+"Month"](),f=o[l+"FullYear"](),h=o[l+"Hours"](),g=o[l+"Minutes"](),p=o[l+"Seconds"](),m=o[l+"Milliseconds"](),v=s?0:o.getTimezoneOffset(),_={d:c,dd:n(c),ddd:r.i18n.dayNames[d],dddd:r.i18n.dayNames[d+7],m:u+1,mm:n(u+1),mmm:r.i18n.monthNames[u],mmmm:r.i18n.monthNames[u+12],yy:String(f).slice(2),yyyy:f,h:h%12||12,hh:n(h%12||12),H:h,HH:n(h),M:g,MM:n(g),s:p,ss:n(p),l:n(m,3),L:n(m>99?Math.round(m/10):m),t:h<12?"a":"p",tt:h<12?"am":"pm",T:h<12?"A":"P",TT:h<12?"AM":"PM",Z:s?"UTC":(String(o).match(t)||[""]).pop().replace(i,""),o:(v>0?"-":"+")+n(Math.floor(Math.abs(v)/60)*100+Math.abs(v)%60,4),S:["th","st","nd","rd"][c%10>3?0:(c%100-c%10!=10)*c%10]};return a.replace(e,function(e){return e in _?_[e]:e.slice(1,e.length-1)})}}();dateFormat.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"};dateFormat.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]};var base_langpack={"b_onlineCallDefaultText":"\u041f\u043e\u0437\u0432\u043e\u043d\u0438\u0442\u044c \u043d\u0430\u043c \u0431\u0435\u0441\u043f\u043b\u0430\u0442\u043d\u043e!","cw_callAfter":"\u041f\u0435\u0440\u0435\u0437\u0432\u043e\u043d\u0438\u043c \u0432\u0430\u043c \u0447\u0435\u0440\u0435\u0437","cw_callButtonText":"\u041f\u0435\u0440\u0435\u0437\u0432\u043e\u043d\u0438\u0442\u0435 \u043c\u043d\u0435","cw_callFree":"\u0417\u0432\u043e\u043d\u043e\u043a \u0431\u0435\u0441\u043f\u043b\u0430\u0442\u043d\u044b\u0439. \u0421\u0435\u0440\u0432\u0438\u0441 \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d","cw_call_to":"\u0417\u0432\u043e\u043d\u043e\u043a \u043d\u0430","cw_chat":"\u0427\u0430\u0442","cw_chatWithOperator":"\u0447\u0430\u0442 \u0441 \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u043e\u043c","cw_close":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c","cw_code_restrict":"\u041a \u0441\u043e\u0436\u0430\u043b\u0435\u043d\u0438\u044e, \u043c\u044b \u043d\u0435 \u043c\u043e\u0436\u0435\u043c \u043f\u043e\u0437\u0432\u043e\u043d\u0438\u0442\u044c \u043d\u0430 \u044d\u0442\u043e\u0442 \u043d\u043e\u043c\u0435\u0440","cw_connecting":"\u0421\u043e\u0435\u0434\u0438\u043d\u044f\u0435\u043c...","cw_enterPhonePlaceholder":"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0430\u0448 \u0442\u0435\u043b\u0435\u0444\u043e\u043d","cw_errInfoText":"\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043f\u043e\u0437\u0432\u043e\u043d\u0438\u0442\u044c \u0435\u0449\u0435 \u0440\u0430\u0437, \u0438\u043b\u0438 \u043d\u0430\u043f\u0438\u0448\u0438\u0442\u0435 \u043d\u0430\u043c \u0432 \u0447\u0430\u0442.","cw_formCenterText":"\u041d\u0435 \u043d\u0430\u0448\u043b\u0438, \u0447\u0442\u043e \u0438\u0441\u043a\u0430\u043b\u0438?","cw_form_second":"\u0441\u0435\u043a\u0443\u043d\u0434\u0443","cw_form_secondd":"\u0441\u0435\u043a\u0443\u043d\u0434","cw_form_seconds":"\u0441\u0435\u043a\u0443\u043d\u0434\u044b","cw_pickUpPhone":"\u0412\u043e\u0437\u044c\u043c\u0438\u0442\u0435 \u0442\u0440\u0443\u0431\u043a\u0443","cw_rate_limit":"\u0412\u044b\u0437\u043e\u0432 \u043d\u0430 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440 \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u0435\u043d","cw_repeatCall":"\u041f\u0435\u0440\u0435\u0437\u0432\u043e\u043d\u0438\u0442\u0435 \u043c\u043d\u0435","cw_repeatCallAgain":"\u041f\u0435\u0440\u0435\u0437\u0432\u043e\u043d\u0438\u0442\u044c \u0435\u0449\u0435 \u0440\u0430\u0437","cw_reportPlaceholder":"\u0421\u043e\u043e\u0431\u0449\u0438\u0442\u0435 \u043e \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0435, \u043c\u044b \u0440\u0430\u0437\u0431\u0435\u0440\u0435\u043c\u0441\u044f!","cw_reportProblem":"\u0441\u043e\u043e\u0431\u0449\u0438\u0442\u044c \u043e \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0435","cw_seconds":"\u0441\u0435\u043a\u0443\u043d\u0434","cw_textSend":"\u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c","cw_thxForCall":"\u0421\u043f\u0430\u0441\u0438\u0431\u043e \u0432\u0430\u043c \u0437\u0430 \u0437\u0432\u043e\u043d\u043e\u043a!","cw_typeInChat":"\u041d\u0430\u043f\u0438\u0441\u0430\u0442\u044c \u0432 \u0447\u0430\u0442","cw_unableToConnect":"\u041d\u0435 \u0441\u043c\u043e\u0433\u043b\u0438 \u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c\u0441\u044f?","cw_weCalling":"\u041c\u044b \u0432\u0430\u043c \u0437\u0432\u043e\u043d\u0438\u043c","cw_weRecallAfter":"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430 \u0438 \u043c\u044b \u043f\u0435\u0440\u0435\u0437\u0432\u043e\u043d\u0438\u043c \u0432\u0430\u043c \u0437\u0430","c_callConnected":"\u0412\u044b\u0437\u043e\u0432 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d","c_callDisconnected":"\u0412\u044b\u0437\u043e\u0432 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d","c_callProcessing":"\u0412\u044b\u0437\u044b\u0432\u0430\u0435\u043c \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u0430...","defCallformTitle":"\u041d\u0443\u0436\u043d\u0430 \u043f\u043e\u043c\u043e\u0449\u044c? <br>\u041c\u044b \u043f\u0435\u0440\u0435\u0437\u0432\u043e\u043d\u0438\u043c \u0447\u0435\u0440\u0435\u0437 <span style='color: #40cd72'>_SEC_<\/span> \u0441\u0435\u043a\u0443\u043d\u0434!","defOfflineFormText":"\u041e\u0441\u0442\u0430\u0432\u044c\u0442\u0435 \u0441\u0432\u043e\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u0432 \u044d\u0442\u043e\u0439 \u0444\u043e\u0440\u043c\u0435, \u0438 \u043c\u044b \u043f\u043e\u043b\u0443\u0447\u0438\u043c \u0435\u0433\u043e \u043d\u0430 e-mail \u0438 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u043e\u0442\u0432\u0435\u0442\u0438\u043c!","defOfflineWidgetLabel":"\u041e\u0442\u043f\u0440\u0430\u0432\u044c\u0442\u0435 \u043d\u0430\u043c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435","defOfflineWidgetLabelMobile":"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435","defOnlineWidgetLabel":"\u041d\u0430\u043f\u0438\u0448\u0438\u0442\u0435 \u043d\u0430\u043c, \u043c\u044b \u043e\u043d\u043b\u0430\u0439\u043d!","defOnlineWidgetLabelMobile":"\u041a\u043e\u043d\u0441\u0443\u043b\u044c\u0442\u0430\u043d\u0442","defRuleInvitationText":"\u0417\u0434\u0440\u0430\u0432\u0441\u0442\u0432\u0443\u0439\u0442\u0435! \u042f \u043c\u043e\u0433\u0443 \u0432\u0430\u043c \u0447\u0435\u043c-\u0442\u043e \u043f\u043e\u043c\u043e\u0447\u044c?","defRuleRetaining":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u043e\u0434\u043e\u0436\u0434\u0438\u0442\u0435. \u0421\u0435\u0439\u0447\u0430\u0441 \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u044b \u0437\u0430\u043d\u044f\u0442\u044b, \u043d\u043e \u0441\u043a\u043e\u0440\u043e \u043a\u0442\u043e-\u043d\u0438\u0431\u0443\u0434\u044c \u043e\u0441\u0432\u043e\u0431\u043e\u0434\u0438\u0442\u0441\u044f \u0438 \u043e\u0442\u0432\u0435\u0442\u0438\u0442 \u0432\u0430\u043c!","defRuleRetainingEmail":"\u041d\u0435 \u0445\u043e\u0442\u0438\u0442\u0435 \u0436\u0434\u0430\u0442\u044c \u043e\u0442\u0432\u0435\u0442\u0430? \u041e\u0441\u0442\u0430\u0432\u044c\u0442\u0435 e-mail \u0438 \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u0435 \u043e\u0442\u0432\u0435\u0442 \u043d\u0430 \u043f\u043e\u0447\u0442\u0443!","lblAgentDisconnected":"\u041e\u043f\u0435\u0440\u0430\u0442\u043e\u0440 \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u043b\u0441\u044f","lblCallMe":"\u041f\u043e\u0437\u0432\u043e\u043d\u0438\u0442\u044c","lblCaptcha":"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0434 \u0441 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0438","lblCaptchaError":"\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u043a\u043e\u0434, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437","lblChatEnded":"\u0414\u0438\u0430\u043b\u043e\u0433 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d","lblChatIsOnline":"\u041a\u043e\u043d\u0441\u0443\u043b\u044c\u0442\u0430\u043d\u0442 \u043e\u043d\u043b\u0430\u0439\u043d","lblConnectedToAgent":"\u041d\u0430\u043f\u0438\u0448\u0438\u0442\u0435 \u0412\u0430\u0448\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435!","lblConnectionLost":"\u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u043f\u043e\u0442\u0435\u0440\u044f\u043d\u043e. \u0412\u043e\u0441\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u043c...","lblDeclineFile":"\u041e\u0442\u043a\u043b\u043e\u043d\u0438\u0442\u044c","lblDefaultCobrowseComment":"\u041e\u0431\u0440\u0430\u0442\u0438\u0442\u0435 \u0432\u043d\u0438\u043c\u0430\u043d\u0438\u0435","lblEnterMessageHere":"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u0438 \u043d\u0430\u0436\u043c\u0438\u0442\u0435 Enter","lblEnterMessageOrPhoneHere":"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u0438\u043b\u0438 \u043d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430 (\u043f\u0435\u0440\u0435\u0437\u0432\u043e\u043d\u0438\u043c \u043c\u0433\u043d\u043e\u0432\u0435\u043d\u043d\u043e)","lblEvaluateCancel":"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c","lblEvaluatePlease":"\u041e\u0446\u0435\u043d\u0438\u0442\u0435 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u043e \u043e\u0431\u0441\u043b\u0443\u0436\u0438\u0432\u0430\u043d\u0438\u044f","lblEvaluateThanks":"\u0421\u043f\u0430\u0441\u0438\u0431\u043e \u0437\u0430 \u043e\u0446\u0435\u043d\u043a\u0443!","lblHangUp":"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435","lblHangUpShort":"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c","lblIntroduceButton":"\u041f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u0438\u0442\u044c\u0441\u044f","lblIntroduceName":"\u0412\u0430\u0448\u0435 \u0438\u043c\u044f","lblIntroduceRequest":"\u041f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u044c\u0442\u0435\u0441\u044c, \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430","lblIntroduceRequestBefore":"\u041f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u044c\u0442\u0435\u0441\u044c \u0438 \u043d\u0430\u0447\u043d\u0438\u0442\u0435 \u0447\u0430\u0442!","lblLeaveMessage":"\u041e\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435","lblLookingForFreeAgent":"\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0435\u043c\u0441\u044f...","lblMessageError":"\u041a \u0441\u043e\u0436\u0430\u043b\u0435\u043d\u0438\u044e, \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u043d\u0435 \u0431\u044b\u043b\u043e \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e \u043f\u043e \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u043c \u043f\u0440\u0438\u0447\u0438\u043d\u0430\u043c","lblMessageHere":"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435","lblNegative":"\u041f\u043b\u043e\u0445\u043e","lblNewMessage":"\u041d\u043e\u0432\u043e\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435!","lblNoOperators":"\u041a \u0441\u043e\u0436\u0430\u043b\u0435\u043d\u0438\u044e, \u0441\u0435\u0439\u0447\u0430\u0441 \u043d\u0438\u043a\u0442\u043e \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u043e\u0442\u0432\u0435\u0442\u0438\u0442\u044c","lblOfflineMessageSend":"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e","lblOperatorsOnline":"\u041e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u044b \u043e\u043d\u043b\u0430\u0439\u043d","lblPencilHint":"\u041e\u043f\u0435\u0440\u0430\u0442\u043e\u0440 \u043d\u0430\u0431\u0438\u0440\u0430\u0435\u0442 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435","lblPhoneHint":"\u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u00ab\u0420\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c\u00bb, \u0447\u0442\u043e\u0431\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043c\u0438\u043a\u0440\u043e\u0444\u043e\u043d \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0430 \u0434\u043b\u044f \u0440\u0430\u0437\u0433\u043e\u0432\u043e\u0440\u0430.\r\n\u0412\u0430\u0448\u0430 \u0432\u0435\u0431-\u043a\u0430\u043c\u0435\u0440\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u043d\u0435 \u0431\u0443\u0434\u0435\u0442","lblPositive":"\u0425\u043e\u0440\u043e\u0448\u043e","lblPwrBy":"\u0427\u0430\u0442 \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d <a href=\"http:\/\/www.jivosite.ru\/_URL_\" target=\"_blank\"><span class=\"j1\">Jivo<\/span><span class=\"j2\">Site<\/span><\/a>","lblReceiveFile":"\u041f\u0440\u0438\u043d\u044f\u0442\u044c","lblReopenedElseWhere":"\u0414\u0438\u0430\u043b\u043e\u0433 \u043e\u0442\u043a\u0440\u044b\u0442 \u0432 \u0434\u0440\u0443\u0433\u043e\u043c \u043e\u043a\u043d\u0435","lblReply":"\u041e\u0442\u0432\u0435\u0442\u0438\u0442\u044c","lblSelectDep":"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043e\u0442\u0434\u0435\u043b","lblSend":"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c","lblSendBefore":"\u041d\u0430\u0447\u0430\u0442\u044c \u0434\u0438\u0430\u043b\u043e\u0433","lblSendingFile":"_AGENT_ \u043f\u0435\u0440\u0435\u0434\u0430\u0435\u0442 \u0432\u0430\u043c \u0444\u0430\u0439\u043b: _FILE_","lblThanks":"\u0421\u043f\u0430\u0441\u0438\u0431\u043e!","lblThankYouMessage":"\u0421\u043f\u0430\u0441\u0438\u0431\u043e \u0437\u0430 \u0432\u0430\u0448\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435! \u041c\u044b&nbsp;\u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0441\u0432\u044f\u0436\u0435\u043c\u0441\u044f \u0441&nbsp;\u0432\u0430\u043c\u0438 \u0432 \u0431\u043b\u0438\u0436\u0430\u0439\u0448\u0435\u0435 \u0432\u0440\u0435\u043c\u044f","lblTransferred":"\u0414\u0438\u0430\u043b\u043e\u0433 \u043f\u0435\u0440\u0435\u0434\u0430\u043d \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u0443 _AGENT_","lblView":"\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c","lblWaitForOperator":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430 \u043e\u0436\u0438\u0434\u0430\u0439\u0442\u0435 \u043e\u0442\u0432\u0435\u0442\u0430 \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u0430...","lblWebPhoneFlashError":"\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u0430\u044f \u0432\u0435\u0440\u0441\u0438\u044f Flash \u043d\u0435 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0441\u043e\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u0432\u044b\u0437\u043e\u0432. \u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0432\u043e\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0447\u0430\u0442\u043e\u043c","lblWebPhoneMicError":"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043c\u0438\u043a\u0440\u043e\u0444\u043e\u043d. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u043e\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435\u0441\u044c \u0447\u0430\u0442\u043e\u043c","lblWebPhoneNotAvail":"\u0412\u044b\u0437\u043e\u0432 \u043d\u0435 \u0432\u043e\u0437\u043c\u043e\u0436\u0435\u043d \u0438\u0437-\u0437\u0430 \u043f\u0440\u043e\u0431\u043b\u0435\u043c \u0441 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435\u043c. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u043e\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435\u0441\u044c \u0447\u0430\u0442\u043e\u043c","lblWebPhoneNotConnected":"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0433\u043e\u043b\u043e\u0441\u043e\u0432\u043e\u0435 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u043e\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435\u0441\u044c \u0447\u0430\u0442\u043e\u043c","lblYourEmail":"\u0412\u0430\u0448 E-mail","lblYourMessage":"\u0412\u0430\u0448\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435","lblYourPhone":"\u0412\u0430\u0448 \u0442\u0435\u043b\u0435\u0444\u043e\u043d","lnkCloseThisWindow":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c","lnkRestartChat":"\u0412\u043e\u0437\u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c","ofl_enterEmail":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 e-mail","ofl_enterMessage":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435","ofl_enterName":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f","ofl_enterValidEmail":"\u0423\u043a\u0430\u0437\u0430\u043d \u043d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 e-mail","ofl_enterValidPhone":"\u0423\u043a\u0430\u0437\u0430\u043d \u043d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0442\u0435\u043b\u0435\u0444\u043e\u043d","seo_copyrightTextNew":"\u0427\u0430\u0442 \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d <a href=\"http:\/\/www.jivosite.ru\/\" target=\"_blank\" id=\"jivosite-copyright\" class=\"jivo-_COLOR_ jivo-ru\"><\/a>"};function translate(e){if("custom_langpack"in config&&e in config.custom_langpack){return config.custom_langpack[e].replace(/\n/g,"<br />").replace(/'/g,"&#039;")}return translate_basic(e)}function translate_basic(e){if(e in base_langpack){return base_langpack[e].replace(/\n/g,"<br />")}return e}function cookie(e,t,i){if(e!="__utmz"){e=["jv",e,config.widget_id].join("_")}if(arguments.length>1&&String(t)!=="[object Object]"){if(typeof i==="undefined"){i={}}if(t===null||t===undefined){log("Clearing COOKIE "+e);i.expires=-1}else{log("Set COOKIE "+e+" with value "+t)}if(typeof i.expires==="number"){var n=i.expires,o=i.expires=new Date;o.setDate(o.getDate()+n)}t=String(t);return document.cookie=[encodeURIComponent(e),"=",encodeURIComponent(t),i.expires?"; expires="+i.expires.toUTCString():"",config.cookie_domain&&!jivo.isSeparateWindow()?"; domain="+config.cookie_domain:"","; path=/"].join("")}i=t||{};var a,s=i.raw?function(e){return e}:decodeURIComponent;return(a=new RegExp("(?:^|; )"+encodeURIComponent(e)+"=([^;]*)").exec(document.cookie))?s(a[1]):null}function getJSONP(e,t){var i=new jivoXHR;i.open("GET",e);i.onload=t;i.send()}function getJSONPWithData(e,t,i){e+="?cb=?";t["t"]=(new Date).getTime();for(var n in t){e+="&"+n+"="+encodeURIComponent(t[n])}return getJSONP(e,i)}var error_sent_cnt=0;function reportException(e){if("production"=="production"&&!config["disable_error_reporting"]){if(++error_sent_cnt>3){return}try{getJSONPWithData("//err.jivosite.com/widget",{widget_id:config.widget_id,message:e.message,url:window.top.location.href,lineNumber:e.lineNumber,fileName:e.fileName,column:e.columnNumber,stack:e.stack},log)}catch(e){log(e.message)}}else{log("REPORT",e)}}function telemetry(e,t){if(typeof t!="object"){t={}}t.event=e;t.widget_id=config.widget_id;t.chat_mode=config.chat_mode;if(cookie("client_id")){t.client_id=cookie("client_id").split(".")[0]}if("production"!="production"){log("TELEMETRY",t);return}try{getJSONPWithData("//telemetry.jivosite.com/w",t,log)}catch(i){log(i.message)}}function callWidgetPing(e,t){var i={name:"cw_ping"};if(cookie("client_id")){i.jv_client_id=cookie("client_id")}if(cookie("sess_id")){i.jv_sess_id=cookie("sess_id")}if(t){i=underscore.extend(i,t)}getJSONPWithData(chatServerUrl(config.widget_id,config.site_id),i,function(t){if(t.result==="ok"){e(t)}})}function setUTMParams(e){var t=e.substr(e.indexOf("?")+1),i=t.split("&"),n,o,a="";for(o=i.length;o--;){n=i[o].split("=");if(n[0].indexOf("utm_")>=0){n=i[o];a+=(a.length>0?"|":"")+n.substr(n.indexOf("utm_")+4)}}if(a){cookie("utm",a)}}function setImplicitGuiMessage(e,t){var i=0,n=t||"";underscore.each(underscore.pairs(e),function(e){if(i<10){n=n+e[0]+": "+e[1]+"; \n";i+=1}});if(i>0){jivo.handle("gui_message",n,{implicit:1})}}function highlightUrls(e){var t=/(\s|"|'|^)((?:(?:http|https|ftp|ftps|mailto):\/\/)?)((?:[a-zA-Zа-яА-Я0-9]|[\~\!\#$\%\^\&\*\(\)\+\=\_\-\:\;?\/\[\]\{\}\`\.]|(?:,(?!\s)))*\.(?:рф|me|com|aero|biz|com|coop|edu|eu|gov|info|int|mil|museum|name|net|org|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sy|sz|tc|td|tf|tg|th|tj|tk|tm|tn|to|tp|tr|tt|tv|tw|tz|travel|xxx|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|za|zm|zw)(?:[a-zA-Zа-яА-Я0-9]|[\~\!\#$\%\^\&\*\(\)\+\=\_\-\:\;?\/\[\]\{\}\`\.]|(?:,(?!\s)))*)/gim;e=e.replace(/^(\n)/,"");e=e.replace(/([\n]{2,})/g,"\n\n");return stripBrackets(e).replace(t,function(e,t,i,n){if(!i){i="http://"}var o=document.domain;o=o.replace("www.","");var a;if(n.indexOf(o,0)==-1){a="_blank"}else{a="col_old_page"}return t+"<a href='"+i+n+"' target='"+a+"'>"+n+"</a>"})}function nl2br(e){return e.replace(/\n/g,"<br />")}function stripBrackets(e){if(underscore.isUndefined(e))return"";else return e.replace(/</g,"&lt;").replace(/>/g,"&gt;")}var CLASS_LIST_SUPPORTED="classList"in document.documentElement;function splitClasses(e){return underscore.isArray(e)?e:e.replace(/^\s+|\s+$/g,"").split(/\s+/)}function forceRedraw(e){e.offsetHeight}function getClasses(e){return splitClasses(e.className)}function setClasses(e,t){var i=t.join(" ");if(e.className!==i){e.className=i;forceRedraw(e)}}var hasClass=CLASS_LIST_SUPPORTED?function e(t,i){return t.classList.contains(i)}:function t(e,i){return e.className!==""&&underscore.contains(getClasses(e),i)};var addClass=CLASS_LIST_SUPPORTED?function i(e,t){underscore.each(splitClasses(t),function(t){if(e){e.classList.add(t)}});forceRedraw(e)}:function n(e,t){var i=getClasses(e),n=underscore.union(i,splitClasses(t));setClasses(e,n)};var removeClass=CLASS_LIST_SUPPORTED?function o(e,t){underscore.each(splitClasses(t),function(t){e.classList.remove(t)});forceRedraw(e)}:function a(e,t){var i=getClasses(e),n=underscore.difference(i,splitClasses(t));setClasses(e,n)};var toggleClass=CLASS_LIST_SUPPORTED?function s(e,t,i){t=underscore.uniq(splitClasses(t));underscore.each(t,function(t){e.classList.toggle(t,i)});forceRedraw(e)}:function r(e,t,i){var n=getClasses(e),o=[],a=[],s;underscore.each(splitClasses(t),function(e){var t=underscore.contains(n,e)?i!==true&&a:i!==false&&o;if(t){t.push(e)}});s=underscore.union(underscore.difference(n,a),o);setClasses(e,s)};function removeProperty(e,t){if(e.style.removeProperty)e.style.removeProperty(t);else e.style.removeAttribute(t)}function removeElement(e){e.parentNode.removeChild(e)}function prefixedEvent(e,t,i){var n=["webkit","moz","MS","o",""];for(var o=0;o<n.length;o++){if(!n[o])t=t.toLowerCase();if(e.addEventListener){e.addEventListener(n[o]+t,i,false)}else{e.attachEvent(n[o]+t,i)}}}function css3AnimationIsSupported(){var e=utils.browser,t=e.name;return!!(t==="Microsoft Internet Explorer"&&e.mV>9||t==="Firefox"&&e.mV>23||t==="Chrome"&&e.mV>28||t==="Safari"&&e.mV>5)}function switchClasses(e,t,i){removeClass(e,t);addClass(e,i)}function getOffsetRect(e){var t=e.getBoundingClientRect();var i=document.body;var n=document.documentElement;var o=window.pageYOffset||n.scrollTop||i.scrollTop;var a=window.pageXOffset||n.scrollLeft||i.scrollLeft;var s=n.clientTop||i.clientTop||0;var r=n.clientLeft||i.clientLeft||0;var l=t.top+o-s;var c=t.left+a-r;return{top:Math.round(l),left:Math.round(c)}}function getElementPosition(e){function t(e){return e.compatMode&&e.compatMode!="BackCompat"?e.documentElement:e.body}var i=e.ownerDocument,n=i.all&&!window.opera,o=n?t(i):i.defaultView||i.parentWindow,a={left:0,top:0},s;if(e.getBoundingClientRect){a=underscore.extend(a,e.getBoundingClientRect())}else{s=e;while(s){a.left+=s.offsetLeft;a.top+=s.offsetTop;s=s.offsetParent}}a.width=e.offsetWidth;a.height=e.offsetHeight;a.windowWidth=n?o.clientWidth:o.innerWidth;a.windowHeight=n?o.clientHeight:o.innerHeight;return a}function setElementPosition(e,t){e.style.cssText+=""+"; top: "+t.top+"px"+"; left : "+t.left+"px"+"; width : "+t.width+"px"+"; height: "+t.height+"px";return this}function setSubstrTitle(e){return e.substr(0,255)}function getConfigContactsAsk(){var e=true;underscore.each(["name","phone","email"],function(t){if(config.contacts_settings[t].show){e=false}},this);if(e){config.contacts_ask=2}}function getIconLocale(){if(config.iconLocale===undefined){var e=underscore.find(["ru_RU","be","kk","uk"],function(e){return e===config.locale});config.iconLocale=e?e:"en"}return config.iconLocale}function getInputColor(){if(config.bubble_color===undefined){underscore.defaults(config,{bubble_color:"green"})}return config.bubble_color}function getURLParam(e,t){var i=(t||window.location||"").search.substring(1);var n=i.split("&");for(var o=0;o<n.length;o++){var a=n[o].split("=");if(a[0]==e){return decodeURIComponent(a[1])}}}function getByIdFromParent(e){var t=window.parent.document,i=t.getElementById(e);return i&&$(i)}function proxy(e,t,i){return e[t].apply(e,i)}var utils={fields:["client_name","phone","email"],phoneReg:/^\+?[0-9() -]+$/i,showAd:function(){return!(config.options&8&&config.hide_ad)},hideOffline:function(){return config.hide_offline>0},isValidValue_phone:function(e){return e.replace(/\D+/g,"").length>=5&&this.phoneReg.test(e)},isValidValue_mobilePhone:function(e){var t=e.replace(/\D+/g,""),i=-1;if(underscore.indexOf(["7","8"],t.charAt(0))!==-1){i=11}else if(t.charAt(0)==="9"){i=10}return underscore.indexOf(["7","8","9"],t.charAt(0))!==-1&&t.length===i&&this.phoneReg.test(e)},isValidValue_email:function(e){return e.length>=4&&/^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i.test(e)},isValidValue_name:function(e){return e.length>0&&e.length<100}};(function(e){if(e.browser)return;e.browser={};e.browser.mozilla=false;e.browser.webkit=false;e.browser.opera=false;e.browser.msie=false;var t=navigator.userAgent;e.browser.ua=t;e.browser.name=navigator.appName;e.browser.fV=""+parseFloat(navigator.appVersion);e.browser.mV=parseInt(navigator.appVersion,10);var i,n,o;if((n=t.indexOf("Opera"))!=-1){e.browser.opera=true;e.browser.name="Opera";e.browser.fV=t.substring(n+6);if((n=t.indexOf("Version"))!=-1)e.browser.fV=t.substring(n+8)}else if((n=t.indexOf("MSIE"))!=-1){e.browser.msie=true;e.browser.name="Microsoft Internet Explorer";e.browser.fV=t.substring(n+5)}else if(t.indexOf("Trident")!=-1){e.browser.msie=true;e.browser.name="Microsoft Internet Explorer";var a=t.indexOf("rv:")+3;var s=a+4;e.browser.fV=t.substring(a,s)}else if((n=t.indexOf("Chrome"))!=-1){e.browser.webkit=true;e.browser.name="Chrome";e.browser.fV=t.substring(n+7)}else if((n=t.indexOf("Safari"))!=-1){e.browser.webkit=true;e.browser.name="Safari";e.browser.fV=t.substring(n+7);if((n=t.indexOf("Version"))!=-1)e.browser.fV=t.substring(n+8)}else if((n=t.indexOf("AppleWebkit"))!=-1){e.browser.webkit=true;e.browser.name="Safari";e.browser.fV=t.substring(n+7);if((n=t.indexOf("Version"))!=-1)e.browser.fV=t.substring(n+8)}else if((n=t.indexOf("Firefox"))!=-1){e.browser.mozilla=true;e.browser.name="Firefox";e.browser.fV=t.substring(n+8)}else if((i=t.lastIndexOf(" ")+1)<(n=t.lastIndexOf("/"))){e.browser.name=t.substring(i,n);e.browser.fV=t.substring(n+1);if(e.browser.name.toLowerCase()==e.browser.name.toUpperCase()){e.browser.name=navigator.appName}}if((o=e.browser.fV.indexOf(";"))!=-1)e.browser.fV=e.browser.fV.substring(0,o);if((o=e.browser.fV.indexOf(" "))!=-1)e.browser.fV=e.browser.fV.substring(0,o);e.browser.mV=parseInt(""+e.browser.fV,10);if(isNaN(e.browser.mV)){e.browser.fV=""+parseFloat(navigator.appVersion);e.browser.mV=parseInt(navigator.appVersion,10)}e.browser.version=e.browser.mV})(utils);function staticUrl(e,t){if(!t){e+="?rnd=1456926222"}if(config.static_host){return"//"+config.static_host+e}return config.base_url+e}function chatServerUrl(){var e=window.location.protocol+"//";if("comet"in config){e+=config.comet.host;if(window.location.protocol=="https:"){if("secure_port"in config.comet){e+=":"+config.comet.secure_port}}else{if("plain_port"in config.comet){e+=":"+config.comet.plain_port}}}else{e+="node.jivosite.com"}return e+"/jsonp/"+underscore.toArray(arguments).join("/")}(window.jivo_init=function(){function e(e,t){var i=document;if(t){i=t}var n;try{n=i.getElementsByClassName(e)}catch(o){n=[];var a=new RegExp("\\b"+e+"\\b");var s=i.getElementsByTagName("*");for(var r=0;r<s.length;r++){var l=s[r].className;if(a.test(l)){n.push(s[r])}}}return n}var t=window._templates={chat:underscore.template(["<div dir='ltr' class='jivo-triangle-wraper '>","<div class='jivo-triangle-clip'>","<div class='jivo-triangle jivo-chat-triangle'><div class='jivo-triangle-inner'></div></div>","<div id='jivo-css-leaf' class='jivo-css-leaf jivo-{{ jivo_config.chat_mode }} jivo-{{ jivo_config.widget_font_color }}'>","<div class='jivo-top-right-square'>","<div class='jivo-bottom-left-square'></div>","</div>","</div>","</div>","</div>","<div id='jivo_iframe_wrap'>","<div id='jivo_iframe_placeholder' class='{{ inputBorderColor }}'>","<div id='inner-chat' style='display: none;' <% if (jivo.isTablet()) {%>class='tablet-version-widget'<% } %>>","<div id='web_phone' class='phone_hidden'>","<div id='rtc_placeholder'></div>","<div id='up_arrow'></div>","<div id='phone_hint'></div>","</div>","<div id='sound_player'></div>","<div id='contents_placeholder'></div>","</div>","</div>","</div>"].join("\n")),label:{top:underscore.template(["<div id='jivo_chat_widget_online'>","<div id='jivo-label' class='jivo-fixed-{{ orientation }} jivo-animate jivo-{{ jivo_config.chat_mode }}'>","<div class='jivo-triangle-wraper'>","<div class='jivo-triangle-clip'>","<div class='jivo-triangle jivo-label-triangle'><div class='jivo-triangle-inner'></div></div>","<div class='jivo-css-leaf jivo-{{ jivo_config.chat_mode }} jivo-{{ jivo_config.widget_font_color }}'>","<div class='jivo-top-right-square'>","<div class='jivo-bottom-left-square'></div>","</div>","</div>","</div>","</div>","<div id='jivo-label-wrapper' style='height: {{ height }}px'>","<div id='jivo-label-copyright' class='jivo-{{ type }} <% if (locale) {%>jivo-{{ locale }}<% } %>'></div>","<div id='jivo-label-inner-wrapper'>","<div id='jivo-label-text' <% if (locale) {%>class='jivo-{{ locale }}'<% } %>>{{ text }}</div>","<div id='jivo-label-indicator'></div>","<div id='jivo-label-status' class='jivo-{{ type }}'></div>","</div>","</div>","</div>","</div>"].join("\n")),bottom:underscore.template(["<div id='jivo_chat_widget_online'>","<div id='jivo-label' class='jivo-fixed-{{ orientation }} jivo-animate jivo-{{ jivo_config.chat_mode }}'>","<div class='jivo-triangle-wraper '>","<div class='jivo-triangle-clip'>","<div class='jivo-triangle jivo-label-triangle'><div class='jivo-triangle-inner'></div></div>","<div class='jivo-css-leaf jivo-{{ jivo_config.chat_mode }} jivo-{{ jivo_config.widget_font_color }}'>","<div class='jivo-top-right-square'>","<div class='jivo-bottom-left-square jivo-{{ jivo_config.chat_mode }}'></div>","</div>","</div>","</div>","</div>","<div id='jivo-label-wrapper' style='height: {{ height }}px'>","<div id='jivo-label-inner-wrapper'>","<div id='jivo-label-status' class='jivo-{{ type }} jivo-{{ jivo_config.chat_mode }}'></div>","<div id='jivo-label-text' <% if (locale) {%>class='jivo-{{ locale }}'<% } %>>{{ text }}</div>","<div id='jivo-label-indicator'></div>","</div>","<div id='jivo-label-copyright' class='jivo-{{ type }} <% if (locale) {%>jivo-{{ locale }}<% } %>'></div>","</div>","</div>","</div>"].join("\n")),left:underscore.template(["<div id='jivo_chat_widget_online'>","<div id='jivo-label' class='jivo-fixed-{{ orientation }} jivo-animate jivo-{{ jivo_config.chat_mode }}'>","<div class='jivo-triangle-wraper '>","<div class='jivo-triangle-clip'>","<div class='jivo-triangle jivo-label-triangle'><div class='jivo-triangle-inner'></div></div>","<div class='jivo-css-leaf jivo-{{ jivo_config.chat_mode }} jivo-{{ jivo_config.widget_font_color }}'>","<div class='jivo-top-right-square'>","<div class='jivo-bottom-left-square'></div>","</div>","</div>","</div>","</div>","<div id='jivo-label-wrapper' style='width: {{ height }}px'>","<div id='jivo-label-copyright' class='jivo-{{ type }} <% if (locale) {%>jivo-{{ locale }}<% } %>'></div>","<div id='jivo-label-inner-wrapper'>","<div id='jivo-label-text' class='jivo-{{ type }} <% if (locale) {%>jivo-{{ locale }}<% } %>'>","<div id='jivo-text-container'>","<div>{{ text }}</div>","</div>","</div>","<div id='jivo-label-status' class='jivo-{{ type }}'></div>","<div id='jivo-label-indicator'></div>","</div>","</div>","</div>","</div>"].join("\n")),right:underscore.template(["<div id='jivo_chat_widget_online'>","<div id='jivo-label' class='jivo-fixed-{{ orientation }} jivo-animate jivo-{{ jivo_config.chat_mode }}'>","<div class='jivo-triangle-wraper '>","<div class='jivo-triangle-clip'>","<div class='jivo-triangle jivo-label-triangle'><div class='jivo-triangle-inner'></div></div>","<div class='jivo-css-leaf jivo-{{ jivo_config.chat_mode }} jivo-{{ jivo_config.widget_font_color }}'>","<div class='jivo-top-right-square'>","<div class='jivo-bottom-left-square'></div>","</div>","</div>","</div>","</div>","<div id='jivo-label-wrapper' style='width: {{ height }}px'>","<div id='jivo-label-copyright' class='jivo-{{ type }} <% if (locale) {%>jivo-{{ locale }}<% } %>'></div>","<div id='jivo-label-inner-wrapper'>","<div id='jivo-label-text' class='jivo-{{ type }} <% if (locale) {%>jivo-{{ locale }}<% } %>'>","<div id='jivo-text-container'>","<div>{{ text }}</div>","</div>","</div>","<div id='jivo-label-status' class='jivo-{{ type }}'></div>","<div id='jivo-label-indicator'></div>","</div>","</div>","</div>","</div>"].join("\n"))},message:{message:underscore.template(["<% if (jivo.isSeparateWindow()) {%>","<div id='jivo_action'>","<div id='jivo_close_button' class='{{ jivo_config.widget_font_color }}' data-action='close'></div>","</div>","<% } %>","<div id='header-avatar' class='header {{ jivo_config.widget_font_color }}' style='background-color: {{ jivo_config.widget_color }}'>","<div id='header-avatar-container'>","<div id='header-animate-container'>","<div class='info'>","<div class='agent-name'>{{ header }}</div>","</div>","</div>","</div>","<div class='clear'></div>","</div>","<div class='special-logo'></div>","<div id='offline-form' class='message<% if (templateData.nologo) {%> nologo<% } %>'>","<div id='offline-form-inner' class='system-message-container'>","<div class='description message'>{{ msg }}</div>","<div id='buttons'></div>","</div>","<div id='jivosite-adword' class='<% if (templateData.locale) {%>jivosite-adword-{{ templateData.locale }}<% } %>'>","<div class='content'>","{{ templateData.link }}","</div>","</div>","</div>"].join("\n")),messageContent:underscore.template(["<div id='offline-form-inner' class='system-message-container'>","<div class='description message'>{{ msg }}</div>","<div id='buttons'></div>","</div>","<div id='jivosite-adword' class='<% if (templateData.locale) {%>jivosite-adword-{{ templateData.locale }}<% } %>'>","<div class='content'>","{{ templateData.link }}","</div>","</div>"].join("\n"))},offline:{form:underscore.template(["<% if (jivo.isSeparateWindow()) {%>","<div id='jivo_action'>","<div id='jivo_close_button' class='{{ jivo_config.widget_font_color }}' data-action='close'></div>","</div>","<% } %>","<div id='header-avatar' class='header {{ jivo_config.widget_font_color }}' style='background-color: {{ jivo_config.widget_color }}'>","<div id='header-avatar-container'>","<div class='header-animate-info header-animate-first'>","<div class='avatar'></div>","<div class='info'>","<div class='agent-name'>{{ agent.name }}</div>","<div class='title'>{{ agent.title }}</div>","</div>","</div>","<div class='header-animate-info header-animate-second'>","<div class='avatar'></div>","<div class='info'>","<div class='agent-name'></div>","<div class='title'></div>","</div>","</div>","</div>","<div class='clear'></div>","</div>","<div class='special-logo'></div>","<div id='offline-form'<% if (nologo) {%> class='nologo'<% } %>>","<div id='offline-form-inner'>","<div id='offline-form-fields'>","<div class='description'>{{ text }}</div>","<% if (fields.get('message').show()) {%>","<div class='field-wrapper message'>","<textarea id='message' maxlength='{{ maxMessageLength }}' class='input-field' placeholder='{{ translate('lblYourMessage') }}<% if (fields.get('message').required()) {%>*<% } %>'>{{fields.get('message').value()}}</textarea>","<div id='error-message' class='error-balloon multiline'>{{ translate('ofl_enterMessage') }}</div>","</div>","<% } %>","<% if (fields.get('name').show()) {%>","<div class='field-wrapper'>","<input id='name' type='text' class='input-field' placeholder='{{ translate('lblIntroduceName') }}<% if (fields.get('name').required()) {%>*<% } %>' value='{{ cookie('client_name') }}'>","<div id='error-name' class='error-balloon'>{{ translate('ofl_enterName') }}</div>","</div>","<% } %>","<% if (fields.get('phone').show()) {%>","<div class='field-wrapper'>","<input id='phone' type='tel' class='input-field' placeholder='{{ translate('lblYourPhone') }}<% if (fields.get('phone').required()) {%>*<% } %>' value='{{ cookie('phone') }}'>","<div id='error-phone' class='error-balloon'>{{ translate('ofl_enterValidPhone') }}</div>","</div>","<% } %>","<% if (fields.get('email').show()) {%>","<div class='field-wrapper'>","<input id='email' type='email' class='input-field' placeholder='{{ translate('lblYourEmail') }}<% if (fields.get('email').required()) {%>*<% } %>' value='{{ cookie('email') }}'>","<div id='error-email' class='error-balloon'>{{ translate('ofl_enterValidEmail') }}</div>","</div>","<% } %>","<div class='buttons'>","<div class='left-button'>","<a id='cancel' class='jivoBtn cancel' href='#'>{{ translate('lblEvaluateCancel') }}</a>","</div>","<div>","<input id='submit' type='button' value='{{ translate('lblSend') }}' class='jivoBtn accept'>","</div>","</div>","<div class='captcha-container'>","<div class='body'>","<div class='img-box'><img src='' alt='captcha code image'></div>","<input type='text' class='input-field cap_symbols' value='' placeholder='{{ translate('lblCaptcha') }}'>","<input id='resend' type='button' class='jivoBtn accept' value='Ok'>","<div class='error'>{{ translate('lblCaptchaError') }}</div>","</div>","</div>","<a id='cancelCap' class='jivoBtn cancel' href='#'>{{ translate('lblEvaluateCancel') }}</a>","<div class='clear'/>","</div>","</div>","<div id='jivosite-adword' class='<% if (locale) {%>jivosite-adword-{{ locale }}<% } %>'>","<div class='content'>","{{ link }}","</div>","</div>","</div>","<% if (jivo.isSeparateWindow() && jivo.isMobile()) {%>","<div id='device-landscape' <% if (window.orientation === 90 || window.orientation === -90) {%>style='display: block'<% } %>></div>","<% } %>"].join("\n"))},online:{chat:underscore.template(["<% if (jivo.isSeparateWindow()) {%>","<div id='jivo_action'>","<div id='jivo_close_button' class='{{ jivo_config.widget_font_color }}' data-action='close'></div>","</div>","<% if (jivo.isMobile()) {%>","<div id='device-landscape' <% if (window.orientation === 90 || window.orientation === -90) {%>style='display: block'<% } %>></div>","<% } %>","<% } %>","<div id='jivosite-iframe-chat'>","<div id='header-avatar' class='header {{ jivo_config.widget_font_color }}' style='background-color: {{ jivo_config.widget_color }}'>","<div id='header-avatar-container'>","<div id='header-animate-container'>","<div class='header-animate-info header-animate-first'>","<div class='avatar'></div>","<div class='info'>","<div class='agent-name'>{{ agent.name }}</div>","<div class='title'>{{ agent.title }}</div>","</div>","</div>","<div class='header-animate-info header-animate-second'>","<div class='avatar'></div>","<div class='info'>","<div class='agent-name'></div>","<div class='title'></div>","</div>","</div>","</div>","</div>","<div class='clear'></div>","<div class='sound_player'></div>","</div>","<div id='chat-body'<% if (templateData.nologo) {%> class='nologo'<% } %>>","<div id='jivo-chat'>","<div id='scrollbar-container'>","<div id='messages-div' class='viewport'>","<div id='messages-div-outer'>","<div id='messages-div-inner' class='overview messages-div-inner'>","<div id='messages-div-inner-clear'></div>","</div>","</div>","<div id='agent-typing'></div>","</div>","</div>","</div>","<div id='jivosite-adword' class='<% if (templateData.locale) {%>jivosite-adword-{{ templateData.locale }}<% } %>'>","<div class='content'>","{{ templateData.link }}","</div>","</div>","<div id='input-div' class='<% if (devicejs.iphone()) {%>input-div-iphone<% } %>'>","<div class='input-div-table'>","<div class='td-textarea'>","<textarea id='input-field' class='<% if (jivo.getCallWidget()) { %>input-field-callwidget<% } %>' name='input-field' maxlength='{{ templateData.maxMessageLength }}' placeholder='{{templateData.lblEnterMessageHere}}' autocomplete='off'></textarea>","</div>","<div class='td-button'>","<input id='input-button' type='button' value=<% if (jivo.isTablet() && !jivo.isSeparateWindow()) {%>'{{ translate('lblReply') }}'<% } else {%>'{{ translate('lblSend') }}' disabled<% } %> class='jivoBtn accept'>","</div>","</div>","</div>","</div>","</div>","<div class='special-logo'></div>"].join("\n")),agentMessage:underscore.template(["<div class='new-msg-container {{ type }} {{ color }} <% if (history && history === true) {%>new-msg-container-history<% } %>'>","<div class='pip'></div>","<div class='new-msg-body {{ type }}'>","<div class='new-msg-body-inner'>","<div class='new-msg-text <% if (history && history === true) {%>new-msg-text-history<% } %>'>","<div class='new-msg-text-inner'>{{ nl2br(highlightUrls(text)) }}</div>","</div>","</div>","</div>","<div class='new-time'>{{ dateFormat(time, 'H:MM') }}</div>","</div>"].join("\n")),clientMessage:underscore.template(["<div class='new-msg-container {{ type }} <% if (history && history === true) {%>new-msg-container-history<% } %>'>","<div class='pip'></div>","<div class='new-msg-body {{ type }}'>","<div class='new-msg-body-inner'>","<div class='new-msg-text <% if (history && history === true) {%>new-msg-text-history<% } %>'>","<div class='new-msg-text-inner'>{{ nl2br(highlightUrls(text)) }}</div>","</div>","</div>","</div>","<div class='new-time'>{{ dateFormat(time, 'H:MM') }}</div>","</div>"].join("\n")),systemMessage:underscore.template(["<div class='new-msg-container {{ type }}'>","<div class='new-msg-body {{ type }}'>","<div class='new-msg-body-inner'>","<div class='new-msg-text'>","<div class='new-msg-text-inner'>{{ text }}</div>","</div>","</div>","</div>","</div>"].join("\n")),callMessage:underscore.template(["<div class='new-msg-container {{ type }}'>","<div class='new-msg-body {{ type }}'>","<div class='new-msg-body-inner'>","<div class='new-msg-text'>","<div class='new-msg-text-inner {{ icon }}'>{{ text }}</div>","</div>","</div>","</div>","</div>"].join("\n")),systemMessageEmail:underscore.template(["<div class='new-msg-container {{ type }} <% if (history && history === true) {%>new-msg-container-history<% } %>'>","<div class='save-chat-email'>","<div class='icon-email'></div>","<p>{{ text }}</p>","<div class='save-chat-email_input-block'>","<input placeholder='{{ translate('lblYourEmail') }}' class='save-chat-email_input'/>","<button class='save-chat-email_button'></button>","</div>","</div>","</div>"].join("\n")),emptyMessage:underscore.template(["<div class='new-msg-container {{ type }}' style='visible:hidden'>","</div>"].join("\n")),connectionError:underscore.template(["<div class='connectionError new-msg-container systemMessage'>","<div class='new-msg-body systemMessage'>","<div class='new-msg-body-inner'>","<div class='new-msg-text'>","<div class='new-msg-text-inner'>{{ text }}</div>","</div>","</div>","</div>","</div>"].join("\n")),cobrowse_highlight:underscore.template(["<div class='new-msg-container agentHighlight {{ color }} <% if (history && history === true) {%>new-msg-container-history<% } %>'>","<div class='pip'></div>","<div class='new-msg-text <% if (history && history === true) {%>new-msg-text-history<% } %>'>","<div class='new-msg-text-inner'>{{ highlightUrls(comment) }}</div>","</div>","<div class='cobrowse-btn-container'>","<a href='#' data-url='{{ page_url }}' data-hash='{{ hash }}'>","<div class='white-cloud'></div>{{ translate('lblView') }}","</a>","</div>","<div class='new-time'>{{ dateFormat(time, 'H:MM') }}</div>","</div>"].join("\n")),messageNode:underscore.template(["<div class='new-msg-text <% if (history && history === true) {%>new-msg-text-history<% } %>'>","<div class='new-msg-text-inner'><% if (type !== 'connectionError') {%>{{ nl2br(highlightUrls(text)) }}<% } else { %>{{ text }}<% } %></div>","</div>"].join("\n")),typing:underscore.template(["<div class='agent-typing-wrapper'>","<div class='agent-typing'>","{{ translate('lblPencilHint') }}","</div>","</div>"].join("\n")),receiveFile:underscore.template(["<div class='new-msg-container {{ type }}'>","<div class='new-msg-body'>","<div class='new-msg-body-inner'>","<div class='new-msg-text'>","<div class='new-msg-text-inner'>{{ translate('lblSendingFile').replace('_FILE_', fileName).replace('_AGENT_', agentName) }}</div>","</div>","<div class='evaluation-btn-container'>","<a href='{{ fileUrl }}' id='receive_file_{{ fileId }}' data-id='{{ fileId }}' data-name='{{ fileName }}' target='_blank' class='button accept'>{{ translate('lblReceiveFile') }}</a>","<a href='#' class='button decline' data-id='{{ fileId }}' data-name='{{ fileName }}'>{{ translate('lblDeclineFile') }}</a>","</div>","</div>","</div>","</div>"].join("\n")),highlight:underscore.template(["<div class='new-msg-container {{ type }}'>","<div class='pip'></div>","<div class='new-msg-body {{type }}'>","<div class='new-msg-body-inner'>","<div class='new-msg-text'>","<div class='new-msg-text-inner'>{{ text }}</div>","</div>","<div class='cobrowse-btn-container'>","<a href='#' data-href='{{ hash }}'>","<div class='white-cloud'></div>{{ lblView }}","</a>","</div>","</div>","</div>","<div class='new-time'>{{ dateFormat(time, 'H:MM') }}</div>","</div>"].join("\n")),introduceForm:underscore.template(["<div id='introduce-form'<% if (nologo) {%> class='nologo'<% } %>>","<!--div id='jivosite-adword' class='<% if (locale) {%>jivosite-adword-{{ locale }}<% } %>'>","<div class='content'>","{{ link }}","</div>","</div-->","<div id='introduce-avatar'>","<img src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHMAAABzCAYAAACrQz3mAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAADkdJREFUeNrsXQu0VkUVHn4el8fVFAIFcwmCRiBYKd0lj1zx8oFIAipaUGgSxIqHddUkWCVSBMrjQgsVgtQgwgcLFB9Qll5AeabiJSyIWyQqmhYgL3m0P8++9nPunnP/85/HzHDvXmuvH84598ye/Z09s2fPnplaJ06cUNm0bt065RAVErcj7kDcivlc4ibMBcSnEdcmPka8j/gw8b+ZdxHvZN5CvJV4v3KU6jgm7/nE3Yi7MLcL8bcA9Az+91kBzwHQNcylxH93RTm1LLfMBsR9ia8i7k3cwoAMu4lXEj9L/DTxAWfAtIHog7qZfgYxkLbRU8SLi4qKFiVUd/fBpEq0oZ9i4iHE9R1o1Q4RP0I8lYDdXgOmJ/xl9HMX8bV5/PlHxGXsvMCJKWenpsLBgbOzj5R9lMqpw85QQZaDBGepJTtOcKLaEzfKQ47lxJOpnJerJZgk9CX0M5H7w1zpHe6/4JysJt5GCjweo0wZ+mlL3JUdLPTTZ4d4xXPEPyaZNlULMEnYpvRTwn1iLgTLW8J91aukqBMpylqLfr5IfA3xjWy5udDjxN8jWd87ZcEkQWfQz+gcHv2A+6P5pJAtFjlmaIpv4X69cQ5/MpPkH3NKgUkCdqKfOcSXVPEoxnjTiH9DSjhsq+dD9UG/+03i23MY624mHkH1We88mCTcdPqp6ut8jXgCmtI0m9GYmmEMn37KzXEQzaC6jXUSTG6SfkXcKeCxch6OPOESiBpQBxD/nLhNwKMbiG8N6jqsA5MEupp+fk3cVPPIQeJJaFKpYgdjqkxD4i9ws3ch8ZlZXDdrKLOLPyIMIzYSH4mx6g246R3H/5YITtFQqvcK68EkYUbSz+yAR14gHkaV2RFDZb5EfB3x19nTzIQUF4H359m7Lo2j/lQv1AEx5LnE3QMe/T49OztOMDMxAzktAEhETEYR99QBmSPB+bgNY0x2LsbzgD+fuiCIMJD4JWJYynkxAYrgfE+u7yHNY7NYX7FRLJbJ3h0srrPmESh+IFWyLKIDgGHBvcTNE+r+drM1vRnFMn31ac/jzraaP1mLMiu8d6OWSYXj634xAMgnvTpWDWQAIQqznB2qpIAEYVbmMeLWcb2Q6/0VOHmaR6C3F0mPp0ctK45mdhVk1tybxBa5N8L7LyBer9KbQUGTjcD5+8qb9hpMXC8ioOibr+dWRXyEeCUBGqmcSM0sFQ6noatwC7P6t1ElFkQMZ6GJ+r0KFx9Ngt4i/gnxvLDNrFC/oewc1dY0uV1St0wSarIGSLj61+cDpI8+Q7zMAiBB5zAAmMMsjGilC9hKj2ia3GmpgklADqefOzVA9ieBl8agwLlx9l0x0U3cdxdEBHQpD6kkQBElGp4KmBwQmCPcQnt9i24wHJL68NdrI32NOGqrA0Cf4Y/jmHAb+r06UTAJyIs4siPRnSTgwhiUBZkmK7sJIAyIAdAnecws0cPEFyVpmfOVHKLDLPvUmBTVJ2wlDNEU9f8wYdQ+VPp4P8v6jh9Mnv2QguYYP90do5JuVW4QQnbXxvSuuzXjUOh7eqxDE56PXK+J7BRFHEdml9OYozAFjgAKZ6hfmKFJQN0RNHhFeZMFfkLQYUNclik5PId4CLI3RuX0cAhI0BUqpkxC1uMNSo7lzomlmeVUDylD4A4S4I2YlXOZcosKVNXZE2EAhT6LhVsoY0YkMAnIZkrO2UFQfXYCyumk3KNLY37fL1m/fgIOzaJYZolwDZPJwxLKDLjAQTDbxPky1usw1nMueFQNJlnll5WXXuiniRHnI3Xl1VP6zASb6by4X8j6nSjcujGoWQ+yzEnCtZ1hXOWQ1ELFPFmeEp2R0Huns75zwUUPJlkJAr5XCrcQ5TmUkPANlZvUIImXsp7v0HjQXcJYphREf1V5M+ZJUV1HwUxyjSsCCX+WRhI5gUlWeaEmsjEh4XRIV8FMqqWqcIYmCLeAT9tcLPOHwjVkmj/tqlISpoMJv38F699Pt+cC5mDh2n0pJCn/x1Ew303y5az3KcKtIYFgUhOLqR1/eArrHBeloJT/OgpmeQplLGYcsgnRp28EWeZNwoseTWkRz/4Umqwk6J9JF8D6f0S4NUgEk6yyYjMIPy1IQyPcnOyssUwtSXOb12QP6TI+D8lPZaTk10+lr9xVmTkI/4bGs60EppRzsiRlxexwDEh0C39NsTwJj6skMHsJDy5PWTmvOQYm9i74OMXyJDx6nQQm9ZdIafSn/e82oFzXwEx7B6zXGZdsAm6tsy2zm/CHqwwsgMW6jGMOgbkhzcIYj1XCrW7ZYEqZ6avT1gwJ+5Gmk7eRoNhSA+VKuHTNBlNK11hrSEkvOQLmZqHJS4PWCNc+mUXJUH9Zsc1nNsFCthlS0hpHwHzGULlvMj7ZhKB7YUbJW5+UxbnzVUhyZb/Xd0wUyrhIa13bAcyLNV5T+q7hunVtDYxt86USjeOYBkl+RQeA2Uq4YSqshsWormQcYH3lVENlS8GV1gCzpXCj3IBVYhbgSsfGmcg0N7GhsYRPS4D5OeHGvwwIiMFvI8fArKVp2ZKmXcK1cwGmlFj7rgEBDys36aiBMvcI15oCTGl3xg8NeYcunlzwNwNlSvg0BpgFNlgJh6q2OQbk28rbTtWGVqwgo/EeTZ0QsNIxMFcZKlfCpyHArCNYyceGhHzCMTCNyKvBp05G6sBpmFDXkJCId77gCJB/UV4aZOqkwedoRmeyBpX0XeVt42kzITb6bWVuuk7sGgGmlHxs8lwRbHXWlZsw27L10LzhhITLlbwtQFok4XMoo/HGGhtWGvJqsHXoTMvARNwYOTebDMsh4fNBRhMgOMsS5W21DExb5JECPXsApjTB2sISoW2b27RFnnOEa28BzHLhRktLhMaOyrakX8LpedkSWSR8ygGmNN3VyiJrWGaJHAhoHLFElvOFazsAppTe2NEiMB+2RI5HLdJJB+HaloymU2/Ph5zZQMh6+JNhGbAE4SkblMG4SGeSbc0UFRXtFwDFvGJbi77E6YbLf1CZmeqS6POq8rwvJij2V1if1LF3tghMpOWbSv3E0K3EIl1IuHyimwowtYm1FhF2fjRxxBSOhLJpnlVKIivNBlPKzO7FZ1zZQjhuY3bKZa41UGZQfwk8pAVeqz8Fk3eEelsIHHS0zDqLU2xukZqBlck2rX3poCoHdIDb9mzLBEkTrf0sAxMz7Feo5FeLHeG+aZdl9Zfw+BS3bDCfFR68QdlH+1NQMj4aGxf+Sng8J4G5TDPe7GhhpU44/v58+kvsWy/tXb+sEph8jqU0MB5qIZjHqxuYyjvUzk/YaOuAZJmg3wp/MJizzauTZR63zCqh/yHCrcXZ/zkJTLJOgOnPPGii5P2BaprZ9GgQ4+Dv1xdqwWSSAsrFlo05Gzj+/rBjS2kXy0qbPElg3i9cwxrOPhaB2SgFMOtYUtc+Sl5DO61KMKmpxcpcaYuSeyyyzsIUymhoiVXeI9wCPttysUyQtIsiDuseUI3ALLSgngNY77ngI4NJ1olcl+ell9DXUr8GzFSssr4GNOCyJmcwmcYJ15BOMsYwkPDq0kgFNX0sxxglp++M0/2BFkyyTuSG/k64NZ539DJF2Kk6jXHvXcpbTGvCKqHf8cIt4LEpNJhMozSOwQOGnCHMsf4gxbLGGnJ6HtA4YKOC/jYQTLJOTANJs+w9iUemXE8czoK9d9Jc1HSfSv8IyJGsXz8Bhz15g8mAjtaY9hQO/qZBvRnI01JWLKwEJ+SNTqPJJX221zg9m5R8Jls4MJlGaAbWS0iAJBXcgCuHaZ5mhvpotAQ4IS/Rk+lZj48pOfo0Ipd35AQmWSd2b5QW8eDgzgUJ9J/YYweHm2FOsdiUI+IjbHmODPvJcbcQrL/5Sj4IFXrfEBuYDChc5Y2age3PYqoUvNRvsfBIb2yu7CJYDU5jQmoq4qVnxvRe6G+gcH1jmKFgTscUZykbfeQflXe4daUhAwF+f54govkarryFtmcrdwjrTxDwnqW8ldShjymmumNqS8raf5+4O/GWRMDkwhH4lU4fwosGU2UWhnhXZ+4PkA5RT7lLFZv64iDTFaSDYznWv7/y1nzWFm7jZIRQy+xDg8lCDFfyOchIhOpPlVkR8LdwZJC98B0V80GiltCH7MiUkB7KAvSAAw6Waj7iETzWVImDycJMVvJpfgB0EFVkadaz+PIgPI6m6ue4FYYhDCkeUt5BPwez9HGd8rIE6mnGk6PzKSxvMFmoUiVnvh9jy0OTO4ijNher6kv/4OHNPHZ05mmaVuQEd8l7UBwFTAb0FfT7mts4rv50VUMVhJQc3awTTmL4qoqwBjSOZXu9lP5IiBogT6YgIHtTUxxpMW9kMEmAfcrbSmVtDVZ5EfR2Oelxb9QXRW5mfU3udGV+vtMlmkEgjvXp0Jxl+qwUgo2qwSgnGuUHMirFvtSdBJzFA973avASCZGdvqwnZTWYDCiCBj1UyscrOUCItXYn/SRyfnesfWZNPxpIM3myoip92WWZQj+KcejmagriZk8NRYl/0Ilbpu+rQxRkdDUCsoQzNcLoyF7L9Fkpvk5ssvj4KQ4i6tc8LJBOWabvC7xUebP2PSwGBcoJk+XwB+IfcWZGvnpxD8ws4RGoR46qyYVJR5iR6ZBP9h+8918Ql4adnHa2mdU0vauJMS7FjmCYLjJxWA2mogpDAgk55yovbwfyl5rWpXHL1HyZNytv6qyvhU0vtgrAXOQizcdpzDIrgRnlZQlQQ/7qsZU2cmdNbGqMzZVXMiPd8oCylGwH009Yg4E+FluOdVHJbNaIdY9rudnEzlfbXXGhXQPTT8hfRRY4dq7ChrotlXfqIFaJNWGHBs9gVh/ZD/vY0UF8FAcN4DTCcuXlwyILroyfcZL+J8AADxI/P7hyHu8AAAAASUVORK5CYII=' />","</div>","<div id='introduce-caption'>{{ translate('lblIntroduceRequest') }}</div>","<% if (fields.get('name').show()) {%>","<div class='field-wrapper'>","<input id='name' type='text' class='input-field' placeholder='{{ translate('lblIntroduceName') }}<% if (fields.get('name').required()) {%>*<% } %>' value='{{ cookie('client_name') }}'>","<div id='error-name' class='error-balloon'>{{ translate('ofl_enterName') }}</div>","</div>","<% } %>","<% if (fields.get('email').show()) {%>","<div class='field-wrapper'>","<input id='email' type='email' class='input-field' placeholder='{{ translate('lblYourEmail') }}<% if (fields.get('email').required()) {%>*<% } %>' value='{{ cookie('email') }}'>","<div id='error-email' class='error-balloon'>{{ translate('ofl_enterValidEmail') }}</div>","</div>","<% } %>","<% if (fields.get('phone').show()) {%>","<div class='field-wrapper'>","<input id='phone' type='tel' class='input-field' placeholder='{{ translate('lblYourPhone') }}<% if (fields.get('phone').required()) {%>*<% } %>' value='{{ cookie('phone') }}'>","<div id='error-phone' class='error-balloon'>{{ translate('ofl_enterValidPhone') }}</div>","</div>","<% } %>","<div class='message field-wrapper'>","<textarea id='message' class='input-field' placeholder='{{ translate('lblYourMessage') }}<% if (fields.get('message').required()) {%>*<% } %>' maxlength='{{ maxMessageLength }}'><% if (typeof valueInputField !== 'undefined') {%>{{ valueInputField }}<% } %></textarea>","<div id='error-message' class='error-balloon multiline'>{{ translate('ofl_enterMessage') }}</div>","</div>","<% if (departments) { %>","<div class='departments'>","<div id='current-department' class='input-field' data-id='{{ departments[0].id }}'>{{ departments[0].name }}</div>","<ul id='departments-list'>","<% _.each(departments, function(department) { %>","<li data-id='{{ department.id }}'>{{ department.name }}</li>","<% }) %>","</ul>","</div>","<% } %>","<div class='buttons'><div id='cancel-introduce' class='left-button'><a id='cancel' class='jivoBtn cancel' href='#'>{{ translate('lblEvaluateCancel') }}</a></div><div><input id='submit' type='button' value='{{ send }}' class='jivoBtn accept'></div></div>","</div>"].join("\n")),introducePopup:underscore.template(["<div id='introduce-popup' style='height: 0'>","<div id='introduce-popup-content'>","<% if (config.contacts_ask !== -1) {%><a id='cancel' href='#'></a><% } %>","<i class='icon-thx'></i>","<div class='text-field'>{{ translate('lblIntroduceRequest') }}:</div>","<% if (fields.get('name').show()) {%>","<div class='field-wrapper'>","<input id='name' type='text' class='input-field' placeholder='{{ translate('lblIntroduceName') }}<% if (fields.get('name').required()) {%>*<% } %>' value='{{ cookie('client_name') }}'>","<div id='error-name' class='error-balloon'>{{ translate('ofl_enterName') }}</div>","</div>","<% } %>","<% if (fields.get('email').show()) {%>","<div class='field-wrapper'>","<input id='email' type='email' class='input-field' placeholder='{{ translate('lblYourEmail') }}<% if (fields.get('email').required()) {%>*<% } %>' value='{{ cookie('email') }}'>","<div id='error-email' class='error-balloon'>{{ translate('ofl_enterValidEmail') }}</div>","</div>","<% } %>","<% if (fields.get('phone').show()) {%>","<div class='field-wrapper'>","<input id='phone' type='tel' class='input-field' placeholder='{{ translate('lblYourPhone') }}<% if (fields.get('phone').required()) {%>*<% } %>' value='{{ cookie('phone') }}'>","<div id='error-phone' class='error-balloon'>{{ translate('ofl_enterValidPhone') }}</div>","</div>","<% } %>","<div class='buttons'><input id='submit' type='button' value='{{ send }}' class='jivoBtn accept'></div>","</div>","</div>"].join("\n")),departments:underscore.template(["<div id='departments'<% if (nologo) {%> class='nologo'<% } %>>","<% _.each(departments, function(department) { %>","<a class='department' data-id='{{ department.id }}'>{{ department.name }}</a>","<% }) %>","</div>"].join("\n")),callButton:underscore.template("<div id='callme'><div></div></div>"),evaluation:underscore.template(["<div id='evaluation-popup'>","<div class='evaluation-text'>","<div class='evaluation-text-inner'>{{ translate('lblEvaluatePlease') }}</div>","</div>","<div class='evaluation-btn-container visible'>","<a href='#' class='button' id='negative'></a>","<a href='#' class='button' id='positive'></a>","<a href='#' class='cancel-icon' id='close-eval'></a>","</div>","<div class='evaluation-btn-container close-btn-container hidden'>","<a href='#' class='button hidden' id='cancel'>{{ translate('lblEvaluateCancel') }}</a>","<a href='#' id='close-eval' title='{{ translate('lblEvaluateCancel') }}'></a>","</div>","</div>"].join("\n"))},actionButton:underscore.template(["<div dir='ltr' id='jivo_action' style='display: none;' class='jivo-{{ mobile }}'>","<div id='jivo_close_button' data-action='close'></div>","</div>"].join("\n")),dragHandle:underscore.template(["<% if (jivo_config.chat_mode == 'online') { %>","<div id='jivo-mouse-tracker' style='display: none;'></div>","<div id='jivo-drag-handle' style='display: none;'></div>","<% } %>"].join("\n")),sound_player:underscore.template(["<source src='{{ mp3 }}' type='audio/mpeg'>","<source src='{{ ogg }}' type='audio/ogg; codecs=vorbis'>","<source src='{{ wav }}' type='audio/wav'>"].join("\n")),callInChat:underscore.template(["<div id='callme-form'>","<div class='call-form call-tab'>","<div class='callme-text'>"+translate("cw_weRecallAfter")+" <span class='jivo-text-time'>28</span> <span class='jivo-text-sec'>"+translate("cw_seconds")+"</span>!</div>","<div class='callme-box'>","<div class='callme-code'>+7</div><input class='call-tel' maxlength='12' type='text' placeholder='123 456 7890'/><div id='callme-start-call' class='can-call'></div>","</div>","</div>","<div class='call-wait call-tab'>","<div class='callme-text'>"+translate("cw_callAfter")+"</div>","<div class='callme-timer'>25</div><div class='callme-seconds'>"+translate("cw_seconds")+"</div>","</div>","<div class='call-connecting call-tab'>","<div class='callme-text'>"+translate("cw_connecting")+"</div>","<div class='callme-icon'></div>","</div>","<div class='pin'></div>","<div class='callme-close'></div>","</div>"].join("\n")),label_buttons:underscore.template(["<div id='jivo-show-callme'>","<a id='jivo-show-callme-text' class='jivo-show-callme' href='#'>"+translate("cw_callAfter")+" <span class='jivo-text-time'>{{ seconds }}</span> <span class='jivo-text-sec'>{{ text_seconds }}</span>!</a>","</div>","<div id='jivo-show-chat'>","<a id='jivo-show-chat-text' <% if (jivo_config.chat_mode == 'online') {%>class='jivo-show-chat jivo-show-chat-online'<% } else { %>class='jivo-show-chat jivo-show-chat-offline'<% } %> href='#'>{{ chat_button_text }}</a></div>","</div>"].join("\n"))};
machina.on("newfsm",function(e){e.on("handling",function(e){log(this.namespace+": handling "+e.inputType+" in state "+this.state)});e.on("nohandler",function(e){log(this.namespace+": unhandled "+e.inputType+" in state "+this.state)});e.on("transition",function(e){log([this.namespace+":","transition from:",e.fromState,"to:",e.toState,"action:",e.action].join(" "))})});var i=machina.Fsm.extend({_fireEvent:function(e){delete this._scheduled_events[e];this.handle(e)},_scheduleEvent:function(e,t){if(!(e in this._scheduled_events)){log(this.namespace+": scheduling "+e+" for "+t);this._scheduled_events[e]=setTimeout(underscore.bind(this._fireEvent,this,e),t)}else{log(this.namespace+": attempt to re-schedule event"+e)}},_cancelEvent:function(e){if(e in this._scheduled_events){clearTimeout(this._scheduled_events[e]);delete this._scheduled_events[e]}else{log(this.namespace+": attempt to cancel not scheduled event",e)}},constructor:function(){this._scheduled_events={};machina.Fsm.apply(this,arguments)}});(function(e){var t={CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3};var i={1e3:"Normal Closure",1001:"Going away",1002:"Protocol error",1003:"Unsupported data",1004:"reserved",1005:null,1006:null,1007:"Invalid frame payload data",1008:"Policy violation",1009:"Message Too Big",1010:"Mandatory Ext.",1011:"Internal Error",1012:"Service Restart",1013:"Try Again Later",1014:"Unassigned",1015:"TLS handshake",3001:"Attempts have Ended",3333:"Spam detected"};var n=1e4;var o=2e4;var a=20;var s=2;var r=60;var l=0;var c=1e3;var d=function(){};var u=function(){throw new Error("Not implemented")};var f=function(){return(new Date).getTime()};var h=function(e,t){this.name="NetworkError";this.code=t<<0;this.message=String(e)};h.prototype.toString=function(){return this.name+":"+(this.code<<0||"")+" "+this.message};var g=function(e,t,i){if(e&&"function"===typeof e[t]){try{e[t](i)}catch(n){if("onerror"===String(t)){throw n}else{try{arguments.callee(e,"onerror",n)}catch(n){}}}}};var p={};var m;if(window&&("function"===typeof window.WebSocket||"object"===typeof window.WebSocket)){var v=window.WebSocket;m=function(e,i){var n,o=this,s;this.url=e;this.readyState=t.CONNECTING;this.close=function(e,i){if(this.readyState===t.CONNECTING){this.readyState=t.CLOSING;clearTimeout(s);s=setTimeout(function(){o.readyState=t.CLOSED;g(o,"onclose",{wasClean:false,code:1006,reason:""})},a)}else if(this.readyState===t.OPEN){this.readyState=t.CLOSING;try{if(i){n.close(e,i)}else if(e){n.close(e)}else{n.close(1e3)}}catch(r){g(o,"onerror",r);g(o,"onclose",{wasClean:false,code:1006,reason:""})}}};this.send=function(e){if(!n||n.OPEN!==n.readyState){throw new Error("Socket is not open")}n.send(e)};s=setTimeout(function(){try{if(i){n=new v(e,i)}else{n=new v(e)}n.onclose=function(e){clearTimeout(s);o.readyState=t.CLOSED;g(o,"onclose",e)};n.onerror=function(e){if(!e.name&&!e.message){e.name="WebSocketError";e.message="Unknown"}g(o,"onerror",e)};n.onmessage=function(e){g(o,"onmessage",e)};n.onopen=function(e){o.readyState=t.OPEN;o.protocol=n.protocol;g(o,"onopen",e)}}catch(a){g(o,"onerror",a)}},a)};for(var _ in t){m.prototype[_]=t[_]}}if(window&&window.navigator){if(/iP(hone|od|ad)/.test(window.navigator.platform)){var w=/OS (\d+)_(\d+)_?(\d+)?/.exec(window.navigator.appVersion);if(w&&6>w[1]){m=u}}if(/apple/i.test(window.navigator.vendor)){var w=/\bVersion\/(\d+)\./.exec(window.navigator.userAgent);if(w&&6>w[1]){m=u}}}p["ws"]=p["wss"]=m;var b=function(){var e=window.document.getElementsByTagName("head")[0];var t,i,n,o,a=this;this.withCredentials=false;this.readyState=0;this.responseText="";this.status=0;this.statusText="";this.timeout=void 0;var s=function(){if(!t){return}clearTimeout(o);t.onreadystatechange=d;t.onload=d;t.onerror=d;t.parentNode.removeChild(t);t=null;i=null;n=null;a.responseText="";a.status=0;a.statusText="";a.timeout=void 0;a.withCredentials=false;try{delete window[n]}catch(e){window[n]=void 0}g(a,"onloadend")};var r=function(){if(!t){return}g(a,"onerror");s()};this.open=function(e,t){if(i||!t){return}a.readyState=1;i=String(t).replace(/#.*$/,"");n="_jivo"+b._count++;i+=(-1===i.indexOf("?")?"?":"&")+"cb="+n};this.send=function(l){if(!i){return}l=l?"&msg="+encodeURIComponent(l):"";window[n]=function(e){a.readyState=4;if(b._statusBody.test(e)){a.status=b._statusBody.exec(e)[1]<<0;a.statusText="";a.responseText="";g(a,"onerror");s()}else{a.status=200;a.statusText="OK";a.responseText=e;g(a,"onload");s()}};t=document.createElement("script");t.charset="utf-8";t.type="text/javascript";t.onreadystatechange=function(){if("complete"===this.readyState||"loaded"===this.readyState){setTimeout(r,0)}};if(!t.readyState){t.onload=t.onerror=r}t.src=i+l;e.appendChild(t);a.timeout<<=0;if(0<a.timeout){o=setTimeout(function(){g(a,"ontimeout");s()},a.timeout)}};this.abort=function(){g(a,"onabort");s()};this.setRequestHeader=d};b._statusBody=/^(\d{3})\n$/m;b._count=0;b.prototype={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4};var y=3e3;var C=function(){if(C._stack.length){return C._stack.pop()}var e;try{e=new XMLHttpRequest;if(!("withCredentials"in e)){e=null}}catch(t){}e=e||new b;e.release=function(){C._stack.push(e)};return e};C._stack=[];var j=function(e){var t,i,n,o=y,a=d;for(var s=1;s<arguments.length;s++){if(arguments[s]){switch(typeof arguments[s]){case"object":i=arguments[s];break;case"string":n=arguments[s];break;case"number":o=arguments[s];break;case"function":a=arguments[s];break;default:break}}}if("string"!==typeof e){a(TypeError("Bad URL"));return null}try{t=C();t.open(n?"POST":"GET",e,true);if(n){t.setRequestHeader("Content-Type","text/plain")}}catch(r){a(r);t.release();return null}o<<=0;if(0<o){try{t.timeout=o}catch(r){}}t.onloadend=function(){t.release()};t.onload=function(){if(200===t.status){a(null,t.responseText)}else{a(new h(t.statusText,t.status))}};t.onabort=function(){a(new h("Aborted"))};t.ontimeout=function(){a(new h("Timeout"))};t.onerror=function(){a(new h("Unknown"))};if(i){for(var s in i){t.setRequestHeader(s,i[s])}}try{t.send(n||null)}catch(r){a(r);t.release();return null}return function(){a=d}};e.request=j;var x=2e4;var E=/([^\n]*)\n/gm;var k=function(e){if("string"!==typeof e){return e}var t={},i,n;E.lastIndex=0;while(null!==(i=E.exec(e))){if(!i[1]){t.message=e.substring(i.index+1);break}i=i[1].split(/\t/);n=i[0];if(n){i.shift();t[n]=i}}return t};var T=function(e,n){if(/[^\/]$/.test(e)){e+="/"}var o=this,s=d,r="open",l,c,u=x,h=0,p,m;this.readyState=t.CONNECTING;var v=function(e,n,a){if(t.CLOSED===o.readyState){return}clearTimeout(p);o.readyState=t.CLOSED;g(o,"onclose",{wasClean:!!a,code:n||1006,reason:i[n]||e||""})};var _=function(t,i){s();s=j(e+r+(t?"/"+t:"")+"?"+f(),u,i,w)};var w=function(e,i){var n=k(i);switch(o.readyState){case t.CONNECTING:if(e){g(o,"onerror",e);v("Open error");break}else if(n&&n.open&&n.open[0]){r=n.open[0];o.protocol=n.open[1];o.readyState=t.OPEN;g(o,"onopen")}else{v("No response in state open");break}case t.OPEN:var a="";if(n){if(n.timeout&&0<n.timeout[0]){u=Math.ceil(n.timeout[0])}if(n.etag&&n.etag[0]){var s=n.etag[0]<<0;var d=s-h;if(0<d){if(1!==d){g(o,"onerror",new Error("Missing "+d+" etags"))}if(n.message){g(o,"onmessage",{data:n.message})}}h=s;a="etag/"+s}if(n.close){o.readyState=t.CLOSING;a="close/"+(n.close[0]||"")+"/"+(n.close[1]||"")}}else if(e){if(204===e.status){break}g(o,"onerror",e);if(!e.status){v();return}}_(a);break;case t.CLOSING:if(n&&n.close){var f=n.close[0]<<0;v(n.close[1],f,!l||l===f)}else{v(c,l,false)}break;case t.CLOSED:default:break}};this.close=function(e,i){if(t.CONNECTING===this.readyState){clearTimeout(m);s();p=setTimeout(v,a)}else if(t.OPEN===this.readyState){l=e<<0||1e3;c=i||"";this.readyState=t.CLOSING;_("close/"+l+"/"+c)}};this.send=function(e){if(t.OPEN!==this.readyState){throw new Error("Socket is not open")}if(e&&"string"===typeof e){_("send",e)}else{throw new TypeError("Bad data type")}};var b=[];if(n){if("string"===typeof n){b.push(n)}else if(n instanceof Array){for(var y=0;y<n.length;y++){b.push(String(n[y]))}}}m=setTimeout(function(){_(b.join("/"))},a)};for(var _ in t){T.prototype[_]=t[_]}p["http"]=p["https"]=T;var I=/^\s*(?:([^\;\/\?\:\@\&\=\+\$\,\#\n\r\s]{1,8})\:\/\/)([^\s\n\r]+)\s*$/;var S=function(e,t){if(!t){t=[];t.index=0;t.add=function(e){t.unshift({value:String(e),health:l});t.index=0}}if(e){if("string"===typeof e||e instanceof String){t.push({value:String(e),health:l})}else if(0<e.length){for(var i=0;i<e.length;i++){arguments.callee(e[i],t)}}}return t};var M=function(e){if("string"!==typeof e){throw new TypeError("Bad URL type")}var t=I.exec(e);if(null===t){throw new Error("Bad URL")}else if(!p[t[1]]){throw new Error("Not supported URL scheme: "+t[1])}return new p[t[1]](e)};var N=function(e,t,i){var n=e[t]=i;return function(i){if(arguments.length){n=e[t]=i}return n}};var A=function(e,t){var i=1e3,n;var o=function(){if(e&&0<=e.health){t(++e.health);i<<=1;n=setTimeout(o,i)}};n=setTimeout(o,i);return function(){clearTimeout(n)}};var O=function(){var e=0;setInterval(function(){if(0<e){e-=s;if(!(0<=e)){e=0}}},1e3);return function(){return r<++e}}();var L=function(e){var a=S(e);var s=null;var r=this;var u=d;var f={connecting:d,open:d,close:d,error:d,message:d};var h=N(this,"state",t.CLOSED);var g=N(this,"url",void 0);var p=N(this,"health",void 0);var m=function(e,t){clearTimeout(m.value);if(e){m.value=setTimeout(e,t)}};var v=function(e){u();u=d;m();h(t.CLOSED);try{f.close(e)}catch(i){b(i)}g(void 0);p(void 0)};var _=function(){if(O()){u();u=d;if(s){s.onclose=null;s.onerror=null;s.onmessage=null;s.onopen=null;s.close(3333);s=null;for(var e=0;e<a.lenght;e++){a[e].health=-1}}return true}return false};var w=function(e){u();u=d;m();if(!e){e={wasClean:false,code:1005,reason:"No Status Rcvd"}}if(!e.wasClean){p(--a[a.index].health)}if(1012===e.code){h(t.CONNECTING);try{f.connecting(a[a.index].health)}finally{return m(x,n+(Math.random()*o<<0))}}else if(1005===e.code||1e3===e.code||4e3<=e.code&&5e3>e.code){v(e)}else{x()}};var b=function(e){try{f.error(e)}catch(t){throw t}};var y=function(e){try{f.message(e.data)}catch(t){b(t)}};var C=function(){m();h(t.OPEN);u=A(a[a.index],p);try{f.open()}catch(e){b(e)}};var j=function(){var e=a[a.index];try{s=M(e.value)}catch(t){e.health=-1;++a.index;b(t);return x()}s.onclose=w;s.onerror=b;s.onmessage=y;s.onopen=C};var x=function(e){m();if(a.index>=a.length){g(void 0);p(void 0);v({wasClean:false,code:3001,reason:i[3001]})}else if(0>a[a.index].health){b(new Error("Sick URL"));++a.index;x()}else{if(s){s.onclose=null;s.onerror=null;s.onmessage=null;s.onopen=null;try{s.close()}catch(n){}}h(t.CONNECTING);var o=a[a.index];if(g()!==o.value){g(o.value);p(o.health)}try{f.connecting(o.health)}catch(n){}if(e||l===a[a.index].health){j()}else{m(j,c)}}};this.open=function(e){if(_()){return v({wasClean:false,code:3333,reason:i[3333]})}if(t.CONNECTING===h()||t.OPEN===h()){return}if(e){e=String(e);for(var n=0;n<a.length;n++){if(e===a[n].value){a.index=n;return x(true)}}a.add(e)}x(true)};this.close=function(e,n){m();if(t.CLOSING!==h()&&t.CLOSED!==h()){if(s&&(s.CONNECTING===s.readyState||s.OPEN===s.readyState)){e<<=0;if(4e3>e||5e3<=e){s.close()}else if(n){s.close(e,String(n))}else{s.close(e)}s.onclose=v;h(t.CLOSING)}else{v({wasClean:false,code:1011,reason:i[1011]})}}};this.send=function(e){if(t.OPEN!==h()){return new Error("Connection is not open")}if(_()){v({wasClean:false,code:3333,reason:i[3333]});return new Error("Spam detected")}try{s.send(e)}catch(n){return n}return null};var E=function(e,t){return function(){t.apply(e,arguments)}};this.on=function(e,t){if(e&&"object"===typeof e){for(var i in e){this.on(i,E(e,e[i]))}}else if(f[e]&&"function"===typeof t){f[e]=t}};this.off=function(){for(var e in f){f[e]=d}};this.getHealthyURLs=function(){var e=[];for(var t=0;t<a.length;t++){if(0<=a[t].health){e.push(a[t])}}e.sort(function(e,t){return t.health-e.health});for(var t=0;t<e.length;t++){e[t]=e[t].value}return e}};L.prototype={valueOf:function(){return this.toString()},toString:function(){return t.OPEN===this.state()?this.url:""},toJSON:function(e){switch(e){case"url":return'"'+this.url+'"';case"state":return this.state;case"health":return this.health;default:break}if(!arguments.length){return'{"state":'+this.state+', "health":'+this.health+', "url":"'+this.url+'"}'}return""}};for(var _ in t){L.prototype[_]=t[_]}e.Connection=L})(utils);var n=new i({namespace:"CONMANAGER",msg_buf:[],jconnection:null,send:function(e){log("SEND: ",e);this.handle("send",e)},sendIfConnected:function(e){if(this.isConnected()){log("SEND IF CONNECTION: ",e);this.handle("send",e)}},resume:function(){this.handle("resume")},setupConnection:function(){if(this.jconnection){return}var e=[];if("production"=="production"){e.unshift("https://"+config.comet.host+"/cometcn");if(!cookie("use_lp")){if(!ie){e.unshift("wss://"+config.comet.host+"/cometcn")}}}else{e.unshift("http://"+config.comet.host+"/cometcn");if(!cookie("use_lp")){if(!ie){e.unshift("ws://"+config.comet.host+"/cometcn")}}}log("CONNECTION: url",e);this.jconnection=new utils.Connection(e);this.jconnection.on("connecting",underscore.bind(this.handle,this,"socket_connecting"));this.jconnection.on("open",underscore.bind(this.handle,this,"socket_connect"));this.jconnection.on("close",underscore.bind(this.handle,this,"socket_disconnect"));this.jconnection.on("error",function(e){log("CONNECTION: error",e.name+": "+e.message)});this.jconnection.on("message",function(e){var t;try{t=JSON.parse(e)}catch(i){return log("ERROR parse error",i)}if(!t||"object"!==typeof t){return log("ERROR bad message")}n.handle("socket_message",t)});this.jconnection.open()},_sendSocketEvent:function(e){var t;try{t=JSON.stringify(e)}catch(i){return log("ERROR stringify error",i)}if(typeof e=="object"){if("name"in e){log("Sending "+e.name);var n=this.jconnection.send(t);if(n){log("ERROR send error",n)}}else{log("ERROR Attempt to send event without name")}}else{log("ERROR Socket event must be object")}},_bufferMessage:function(e){this.msg_buf.push(e)},_flushMessageBuffer:function(){var e;while(e=this.msg_buf.shift()){this._sendSocketEvent(e)}},isConnected:function(){return this.state==="CONNECTED"},setCustomData:function(e){if(this.isConnected()){this.send({name:"update_custom_data",custom_data:e})}else{this.custom_data=e}},setUserToken:function(e){if(this.isConnected()){this.send({name:"update_user_token",user_token:e})}else{this.user_token=e}},createClientModel:function(){if(!this.clientModel){this.clientModel={chat_opened:cookie("gui_state")==="CHAT",page_visible:f.pageVisible()}}},updateClient:function(e){var t={name:"update_client",jv_sess_id:cookie("sess_id")};this.createClientModel();var i=underscore.clone(this.clientModel);underscore.extend(this.clientModel,e);if(!underscore.isEqual(this.clientModel,i)){underscore.extend(t,e);this.sendIfConnected(t)}},requestTelemetry:function(e){var t=this.jconnection,i={};if(t){i.state=t.state;i.url=t.url;i.health=t.health}telemetry(e,i)},states:{uninitialized:{_onEnter:function(){if(this.jconnection){this.jconnection.off();this.jconnection.close();this.jconnection=null}},send:function(e){this._bufferMessage(e);this.transition("CONNECTING")},resume:function(){this.transition("CONNECTING")},startup:function(){cookie("sess_id",null);this.transition("CONNECTING")}},CONNECTING:{_onEnter:function(){this.setupConnection()},socket_connect:function(){if(this.jconnection.url.indexOf("http")==0){cookie("use_lp",1)}if(cookie("sess_id")){this.transition("RESUMING")}else{this.transition("STARTING_UP")}},send:function(e){this._bufferMessage(e)},socket_disconnect:function(){this.requestTelemetry("Disconnected while connecting");this.transition("uninitialized")},socket_connecting:function(){}},STARTING_UP:{_onEnter:function(){this.createClientModel();var e={name:"startup",jv_widget_id:config.widget_id,site_id:config.site_id,current_page:f.getCurrentPage(),is_mobile:f.isMobile(),visits_count:cookie("visits_count")-0};e=underscore.extend(e,this.clientModel);if(cookie("client_id")){e.jv_client_id=cookie("client_id");log("CONNECTION: restored client #"+e.jv_client_id)}if(cookie("__utmz")){e.g_utmz=cookie("__utmz")}if(cookie("agent_info")){e.pa_id=cookie("agent_info").split("$$")[0];log("CONNECTION: restored agent #"+e.pa_id)}if(cookie("client_name")){e.client_name=cookie("client_name");log("CONNECTION: restored client name="+e.client_name)}if(cookie("email")){e.email=cookie("email");log("CONNECTION: restored client email="+e.email)}if(cookie("phone")){e.phone=cookie("phone");log("CONNECTION: restored client phone="+e.phone)}if(cookie("refer")){e.refer=cookie("refer");if(cookie("utm")){e.utm=cookie("utm")}}if(f.invitationText){e.proactive_rule={invitation_text:f.invitationText,agent_info:f.agentInfo}}if(this.custom_data){e.custom_data=this.custom_data}if(this.user_token){e.user_token=this.user_token}this._sendSocketEvent(e);this._scheduleEvent("startup_timeout",3e3)},startup_timeout:function(){this.requestTelemetry("Startup Timeout")},send:function(e){this._bufferMessage(e)},socket_message:function(e){if(e.name==="startup_ok"){this._cancelEvent("startup_timeout");cookie("sess_id",e.jv_sess_id,{expires:1,path:"/"});cookie("client_id",e.jv_client_id,{expires:365,path:"/"});this.transition("CONNECTED")}else if(e.name==="startup_error"){if(e.err_code&&e.err_code==="blacklisted"){cookie("client_id","z"+cookie("client_id"))}f.handle("force_offline",e);this.transition("DISCONNECTING")}}},RESUMING:{_onEnter:function(){this.createClientModel();this._sendSocketEvent(underscore.extend({name:"resume",jv_sess_id:cookie("sess_id"),jv_widget_id:config.widget_id,site_id:config.site_id,visits_count:cookie("visits_count")-0,separate_window:f.isSeparateWindow(),current_page:f.getCurrentPage()},this.clientModel));this._scheduleEvent("resume_timeout",3e3)},socket_message:function(e){this._cancelEvent("resume_timeout");if(e.name=="resume_ok"){f.handle(e.name,e);this.transition("CONNECTED")}else{f.handle("resume_failed");this.transition("STARTING_UP")}},resume_timeout:function(){this.requestTelemetry("Resume Timeout")}},CONNECTED:{_onEnter:function(){f.handle("startup_ok");this._flushMessageBuffer()},socket_message:function(e){switch(e.name){case"agent_chat_close":if(!f.isVisitorsInsight()){this.transition("DISCONNECTING")}break;case"force_offline":this.transition("DISCONNECTING");break;case"blacklist":cookie("client_id","z"+cookie("client_id"));this.transition("DISCONNECTING");break;case"cw_call_end":case"cw_error":if(f.state=="OFFLINE"){this.transition("DISCONNECTING")}break;case"accept":case"transferred":cookie("agent_info",[e.agent_info.agent_id].join("$$"));break;case"offline_ack":if(!("cap_id"in e)){this.transition("DISCONNECTING")}break}f.handle(e.name,e)},send:function(e){this._sendSocketEvent(e)},socket_disconnect:function(e){log("CONNECTION: close",e.wasClean,e.code,e.reason);if(e.code==1e3){f.handle("reopened_elsewhere")}this.transition("uninitialized")},startup:function(){f.handle("startup_ok")},socket_connecting:function(){setTimeout(underscore.bind(function(){this.requestTelemetry("JC reconnect")},this),2e3);this.transition("CONNECTING")}},DISCONNECTING:{_onEnter:function(){cookie("sess_id",null);this.jconnection.close()},socket_disconnect:function(e){this.transition("uninitialized")}}}});var o={inited:false,initialize:function(){if(this.inited)return;this.initScroll();this.initClose();this.inited=true},initScroll:function(){window.parent.onscroll=underscore.throttle(underscore.bind(this._scroll,this),150)},initClose:function(){this.last_position={};window.parent.onmousemove=underscore.throttle(underscore.bind(this._mouse,this),150)},_mouse:function(e){if(typeof this.last_position.x!=="undefined"){var t=this.last_position.x-e.clientX,i=this.last_position.y-e.clientY;if(Math.abs(t)>Math.abs(i)&&t>0){}else if(Math.abs(t)>Math.abs(i)&&t<0){}else if(Math.abs(i)>Math.abs(t)&&i>0){if(e.clientY<30){f.handle("move_close_button")}}else if(Math.abs(i)>Math.abs(t)&&i<0){}}this.last_position={x:e.clientX,y:e.clientY}},_scroll:function(e){var t=(window.parent.document.documentElement.scrollTop+window.parent.document.body.scrollTop)/(window.parent.document.documentElement.scrollHeight-window.parent.document.documentElement.clientHeight)*100;f.handle("move_scroll",Math.round(t))}};var a=i.extend({initialize:function(){this.namespace="RULE#"+this.name.replace(" ","_");this.initialState="unreachable";var e=[],t=false,i=this.commands[0];if(cookie(i.command+"_onceADay")){return}for(var n=0;n<this.conditions.length;n++){var a=this.conditions[n];if(this.isGoalCondition(a)){o.initialize()}if(this.isTimeCondition(a)||this.isGoalCondition(a)){e.push(a)}else{if(a.condition==="page_url"){a.value=a.value.replace("http://","").replace("https://","")}else if(a.condition=="ab_test_group"){if(!cookie("ab_test_group")){var s=Math.round(Math.random());var r=a.group_name?a.group_name:"JivoSite A/B Group";cookie("ab_test_group",s?"group_a":"group_b");p.setABTestGroupContacts(r,s?"Group A":"Group B")}}if(this.checkCondition(a)){t=true}else if(this.type==="all"){return}}}if(e.length>0){this.conditions=e;if(this.checkTimeConditions()){this.initialState="triggered"}else{this.initialState="time_wait"}}else if(t){this.initialState="triggered"}},checkTimeConditions:function(){var e=false;for(var t=0;t<this.conditions.length;t++){if(this.checkCondition(this.conditions[t])){e=true}else{if(this.type==="all"){return false}}}return e},isTimeCondition:function(e){return e.condition.indexOf("time")>=0},isGoalCondition:function(e){return e.condition=="goal_close"||e.condition=="goal_scroll"},checkCondition:function(e){var t=this.getValue(e.condition);var i=this.compare(t,e.value,e.comparator);if(!i){log(this.namespace+": failed condition "+e.condition+"; expected="+e.value+"; actual="+t)}return i},getValue:function(e){switch(e){case"online":return config.chat_mode==="online";case"page_url":return f.getPageWindow().location.href.replace("http://","").replace("https://","");case"hour":return(new Date).getHours();case"page_title":return f.getPageWindow().document.title;case"week_day":return(new Date).getDay();case"time_after_close":var t=cookie("close_time");return t===null?Number.MAX_VALUE:this.timeDiff(t);case"time_after_first_message":return s.firstMessageTime!==null?this.timeDiff(s.firstMessageTime.getTime()):NaN;case"time_after_invitation":var i=cookie("invitation_time");return i===null||i===""?Number.MAX_VALUE:this.timeDiff(i);case"time_on_page":return this.timeDiff(s.pageEnterTime);case"time_on_site":return this.timeDiff(cookie("enter_ts"));case"number_of_visits":return cookie("visits_count");case"goal_close":return s.movedToCloseButton;case"goal_scroll":return s.scrollPosition;default:return cookie(e)}},timeDiff:function(e){return Math.round(((new Date).getTime()-e)/1e3)},compare:function(e,t,i){switch(i){case"contain":return e.toLowerCase().indexOf(t.toLowerCase())!=-1;case"greater":return e>t;case"greater_equal":return e>=t;case"lower":return e<t;case"lower_equal":return e<=t;case"not_contain":return e.toLowerCase().indexOf(t.toLowerCase())===-1;case"not_equal":return t!=e;case"regexp":return new RegExp(e,"i").test(t);default:return t==e}},states:{time_wait:{_onEnter:function(){this._scheduleEvent("tick",1e3)},tick:function(){if(this.checkTimeConditions()){this.transition("triggered")}else{this._scheduleEvent("tick",1e3)}},cancel:"unreachable"},unreachable:{},triggered:{_onEnter:function(){var e=this.commands[0],t;if(typeof e.params==="object"&&e.params.onceADay){t=e.command+"_onceADay"}if(underscore.indexOf(["uninitialized","WIDGET"],f.gui.state)===-1&&underscore.indexOf(["proactive","open_offline","show_callform"],e.command)!==-1){return}switch(e.command){case"proactive":s.showProactive(e.params.message,e.params.department,this.name,t);break;case"open_offline":if(config.chat_mode==="online"){return}cookie("invitation_time",(new Date).getTime());if(t){s.addOnceADayCookie(t)}if(e.params){if(e.params.title){config.offline_form_title=e.params.title;chat_view_offline.instance.models.form.set("templateData.header",e.params.title)}if(e.params.message){config.offline_form_text=e.params.message;chat_view_offline.instance.models.form.set("templateData.text",e.params.message)}}setTimeout(function(){if(!f.isMobileOrTablet()){if(e.params.message){chat_view_offline.getFormView().updateText()}f.handle("gui_maximize");f.soundPlayer.incomingMessage()}else{f.gui.incrementCounter()}},0);break;case"hide":f.handle("hide");break;case"system_message":f.handle("system_message",{message:e.params.message});break;case"system_message_email":if(cookie("email")){return}f.handle("system_message_email",{message:e.params.message});break;case"show_callform":log(this.namespace+"rule triggered: show_callform",e);s.showCallForm(e.params.title,t);break}}}}});var s=new i({initialState:false,isInited:false,namespace:"ruleManager",scrollPosition:false,movedToCloseButton:false,init:function(){this.rules=[];underscore.defaults(config,{rules:[]});this.pageEnterTime=(new Date).getTime();if(!cookie("pages_count")){cookie("pages_count",1)}else{cookie("pages_count",parseInt(cookie("pages_count"))+1)}f.on("handling",underscore.bind(this.onJivoHandling,this));if(config.rules.length==0&&underscore.isArray(config.proactive_rules)&&config.proactive_rules.length>0){this.importLegacy();this.transition("ready");return}if(this.needGeo()){log("RULE MANAGER NEED GEO");this.transition("fetch_geo");return}this.isInited=true;log("RULE MANAGER READY");this.transition("ready")},needGeo:function(){var e,t;for(var i=0;i<config.rules.length;i++){e=config.rules[i];for(var n=0;n<e.conditions.length;n++){t=e.conditions[n];if(t.condition=="country"||t.condition=="city"){if(cookie("country")==null){return true}}}}return false},states:{fetch_geo:{_onEnter:function(){getJSONP(config.base_url+"/script/geo?cb=?",underscore.bind(this.handle,this,"geo_data"))},geo_data:function(e){log("RULE MANAGER GEO DATA",e);cookie("country",e.country,{expires:1});cookie("city",e.city,{expires:1});this.transition("ready")}},ready:{_onEnter:function(){for(var e=0;e<config.rules.length;e++){this.rules.push(new a(config.rules[e]))}log(this.namespace+": rules count="+this.rules.length+"; wait count="+underscore.where(this.rules,{state:"time_wait"}).length);this.emit("ready")}}},firstMessageTime:null,canInvite:true,importLegacy:function(){log(this.namespace+": importing from proactive_rules");var e;var t=["contain","equal","regexp"];for(var i=0;i<config.proactive_rules.length;i++){e=config.proactive_rules[i];underscore.defaults(e,{name:e.invitationText,urlPrefix:[{url:"/",mm:0}],page_timeout:20,close_timeout:300,enter_timeout:0,pages_count:0});for(var n=0;n<e.urlPrefix.length;n++){config.rules.push({legacyId:e.id,name:e.name,type:"all",conditions:[{condition:"online",value:true},{condition:"time_on_page",comparator:"greater_equal",value:e.page_timeout},{condition:"time_after_close",comparator:"greater_equal",value:e.close_timeout},{condition:"time_on_site",comparator:"greater_equal",value:e.enter_timeout},{condition:"pages_count",comparator:"greater_equal",value:e.pages_count},{condition:"page_url",comparator:t[e.urlPrefix[n].mm],value:e.urlPrefix[n].url}],commands:[{command:"proactive",params:{message:e.invitationText}}]})}}},onJivoHandling:function(e){switch(e.inputType){case"gui_minimize":cookie("close_time",(new Date).getTime());break;case"gui_message":if(!this.firstMessageTime){this.firstMessageTime=new Date}this.cancelRule("proactive");this.cancelRule("show_callform");break;case"accept":this.allRulesCancel();break;case"invitation":cookie("invitation_time",(new Date).getTime());break;case"callback_invitation":cookie("invitation_time",(new Date).getTime());break;case"move_close_button":underscore.each(this.rules,function(e){this.movedToCloseButton=true;e.handle("tick")},this);break;case"move_scroll":underscore.each(this.rules,function(t){this.scrollPosition=e.args;t.handle("tick")},this);break;case"api_open":if(e.args&&typeof e.args[0]==="object"&&e.args[0].start==="call"){this.allRulesCancel()}break;break}},cancelRule:function(e){log(this.namespace+": cancel "+e);for(var t=0;t<this.rules.length;t+=1){if(this.rules[t].state==="time_wait"&&this.rules[t].commands[0].command===e){this.rules[t].handle("cancel")}}if(e==="proactive"){this.canInvite=false}},allRulesCancel:function(){for(var e=0;e<this.rules.length;e++){if(this.rules[e].state==="time_wait"){this.rules[e].handle("cancel")}}},restoreAgentInfo:function(){var e=cookie("agent_info");if(e){var t=e.split("$$");return{agent_id:t[0]}}return false},addOnceADayCookie:function(e){cookie(e,1,{expires:1,path:"/"})},showProactive:function(e,t,i,n){if(!this.canInvite){log("showProactive cant invite");return}if(typeof e=="number"){var o=parseInt(e),a=false;if(o){for(var s=0;s<this.rules.length;s++){if(this.rules[s].commands[0].command=="proactive"){if(this.rules[s].legacyId==o){e=this.rules[s].commands[0].params.message;log(this.namespace+": legacy rule found by ID="+o+"; message="+e);a=true;break}}}if(!a){log(this.namespace+": legacy rule not found by ID="+o);return}}}var r=this.restoreAgentInfo();var l={name:"active_agent"};if(t&&config.departments&&underscore.findWhere(config.departments,{id:t})){l.department=t}if(r){l.agent_id=r.agent_id}if(cookie("client_id")){l.jv_client_id=cookie("client_id")}getJSONPWithData(chatServerUrl(config.widget_id,config.site_id),l,underscore.bind(function(t){if(underscore.indexOf(["uninitialized","WIDGET"],f.gui.state)!==-1){if(t){f.handle("invitation",{name:i,invitationText:e},t);if(n){this.addOnceADayCookie(n)}}else{log("JIVO: invitation failed, no agent")}}},this))},showCallForm:function(e,t){callWidgetPing(underscore.bind(function(i){if(i.show_form&&underscore.indexOf(["uninitialized","WIDGET"],f.gui.state)!==-1){log("showCallForm title:"+e);f.handle("callback_invitation",{title:e});f.soundPlayer.incomingMessage();if(t){this.addOnceADayCookie(t)}}else{f.gui.labelButtons.disable()}},this))}});var r=i.extend({namespace:"WIDGET",fade:false,position:{},initialState:"HIDDEN",initialize:function(){this._templateData={orientation:config.widget_orientation,height:config.widget_height,style:config.style_string,text:config.chat_mode=="online"?config.online_widget_label:config.offline_widget_label,type:config.widget_font_color,locale:getIconLocale()};this.customElement=null;this._widgetDiv=document.createElement("div");this._widgetContainer=window.parent.document.getElementById("jivo-iframe-container");addClass(this._widgetContainer,"jivo-iframe-container-"+config.widget_orientation);log(this._widgetDiv,t,config.widget_orientation,this._templateData);this._widgetDiv.setAttribute("id","jivo_chat_widget");this._widgetDiv.innerHTML=t.label[config.widget_orientation](this._templateData);this.topWrap.appendChild(this._widgetDiv);this._label=document.getElementById("jivo-label");this._innerLabelWrapper=document.getElementById("jivo-label-inner-wrapper");this._copyright=document.getElementById("jivo-label-copyright");this.widgetWidth=null;this.widgetHeight=null;this.widgetMarginBottom=this._widgetContainer.style.marginBottom;this.setColor();this.setFontStyle();this.setPosition();this._widgetDiv.onclick=underscore.bind(this.handle,this,"click");if(!f.isMobile()&&config.style_string){setTimeout(underscore.bind(function(){addClass(this._widgetContainer,config.style_string)},this),300)}},isCustomLabel:function(){if(window.parent.window!=window.top&&window.top.document){this.customElement=window.top.document.getElementById("jivo_custom_widget")}else if(window.parent.document){this.customElement=window.parent.document.getElementById("jivo_custom_widget")}if(this.customElement){return true}else{return false}},states:{VISIBLE:{_onEnter:function(){log(this.namespace,"WIDGET VISIBLE",this.fade);removeClass(this._widgetContainer,"jivo-expanded");var e=config.widget_orientation,t=this._widgetContainer.style;if(f.isMobile()){e="bottom"}switch(e){case"left":t.width="38px";t.marginLeft="0";t.left="0";t.marginBottom=-this.widgetMarginBottom;if(config.widget_padding=="0"){t.bottom="100%"}else if(config.widget_padding=="50"){t.bottom="50%"
}else if(config.widget_padding=="100"){t.bottom="10px"}t.height=this.widgetHeight;if(!f.isMobile()){this._innerLabelWrapper.style.height=parseFloat(this.widgetHeight)-this._copyright.offsetHeight+"px"}break;case"right":t.width="38px";t.marginRight="0";t.left="auto";t.right="0";log(this.widgetHeight);t.marginBottom=-this.widgetMarginBottom;if(config.widget_padding=="0"){t.bottom="100%"}else if(config.widget_padding=="50"){t.bottom="50%"}else if(config.widget_padding=="100"){t.bottom="10px"}t.right=0;t.height=this.widgetHeight;if(!f.isMobile()){this._innerLabelWrapper.style.height=parseFloat(this.widgetHeight)-this._copyright.offsetHeight+"px"}break;case"top":t.bottom="100%";if(config.widget_padding=="0"){t.right="";t.left="30px"}else if(config.widget_padding=="50"){t.left="";if(parseFloat(this.widgetWidth)<275){this.widgetWidth=275}t.marginRight=parseFloat(this.widgetWidth)/2*-1+"px";t.right=config.widget_padding+"%"}else if(config.widget_padding=="100"){t.left="";t.right="30px"}t.top=0;t.width=this.widgetWidth;if(!f.isMobile()){this._innerLabelWrapper.style.width=parseFloat(this.widgetWidth)-this._copyright.offsetWidth-5+"px";this._innerLabelWrapper.style.float="right"}break;case"bottom":if(config.widget_padding=="0"){t.right="";t.left="30px"}else if(config.widget_padding=="50"){t.left="";if(parseFloat(this.widgetWidth)<275){this.widgetWidth=275}t.marginRight=parseFloat(this.widgetWidth)/2*-1+"px";t.right=config.widget_padding+"%"}else if(config.widget_padding=="100"){t.left="";t.right="30px"}t.bottom=0;t.width=this.widgetWidth;if(!f.isMobile()){this._innerLabelWrapper.style.width=parseFloat(this.widgetWidth)-this._copyright.offsetWidth-5+"px"}break}if(f.isMobile()){t.marginLeft="0";t.left="0";t.marginBottom="0";t.right="auto"}f.transferProportion({width:document.getElementById("jivo-label").offsetWidth,height:config.widget_height-0});log("widget VISIBLE",this.isCustomLabel(),f.gui.state);if(this.isCustomLabel()){addClass(this._widgetContainer,"jivo-custom-label");if(f.gui.state==="CHAT"){this.customElement.style.display="none"}else{this.customElement.style.display="block";f.gui.jivoframecontainer.element.style.visibility="hidden"}}else{this._label.style.display="block";this._label.style.visibility="visible";if(!this._hideLabelForCallWidget){this._label.style.visibility="visible"}if(this.fade){}removeClass(this._widgetContainer,"jivo-no-transition")}},click:function(){log("widget visible click",f.isMobileOrTablet());f.isClicked=true;f.handle("gui_maximize")},hide:"HIDDEN"},HIDDEN:{_onEnter:function(){removeClass(this._label,"jivo-fade-in");this._label.style.visibility="hidden";if(this.isCustomLabel()){addClass(this._widgetContainer,"jivo-custom-label");this._widgetContainer.style.visibility="visible"}},show:"VISIBLE"}},setText:function(e){if(!this._widgetDiv)return;var t;if(underscore.indexOf(["right","left"],config["widget_orientation"])>=0){t=document.getElementById("jivo-text-container");t=t.getElementsByTagName("div")[0]}else{t=document.getElementById("jivo-label-text")}t.innerHTML=e;this.setLabelPosition();this.position=getElementPosition(this._label)},setColor:function(){this._containerDiv=document.getElementById("jivo-label-wrapper");this._textContainer=document.getElementById("jivo-label-text");this._label=document.getElementById("jivo-label");var t=e("jivo-label-triangle");for(var i=0;i<t.length;i++){switch(config.widget_orientation){case"top":t[i].style.borderColor=config.widget_color;break;case"bottom":t[i].style.borderLeftColor=config.widget_color;break;case"right":t[i].style.borderBottomColor=config.widget_color;t[i].style.borderRightColor=config.widget_color;break;case"left":t[i].style.borderBottomColor=config.widget_color;t[i].style.borderLeftColor=config.widget_color;t[i].style.borderRightColor=config.widget_color;break}}t=e("jivo-triangle-inner");for(i=0;i<t.length;i++){t[i].style.backgroundColor=config.widget_color}this._label.style.backgroundColor=config.widget_color;if(underscore.indexOf([config.chat_mode.toUpperCase(),f.state],"OFFLINE")!==-1){t=e("jivo-bottom-left-square");for(i=0;i<t.length;i++){t[i].style.backgroundColor=config.widget_color}}if(this._containerDiv){this._textContainer.style.fontSize=config.font_size+"px";this._textContainer.style.fontFamily=config.font_family;this._isDarkText=config.widget_font_color=="dark";var n="#222222";if(this._isDarkText){n="#222222"}else{n="#F0F1F1"}this._textContainer.style.color=n}},setOffline:function(){log("widget.setOffline");addClass(this._label,"jivo-offline");removeClass(this._label,"jivo-online");document.getElementById("jivo_chat_widget_online").setAttribute("id","jivo_chat_widget_offline");this.setText(config.offline_widget_label);var t=e("jivo-bottom-left-square");for(var i=0;i<t.length;i+=1){t[i].style.backgroundColor=config.widget_color}t=e("jivo-css-leaf");for(i=0;i<t.length;i+=1){removeClass(t[i],"jivo-online");addClass(t[i],"jivo-offline")}if(f.gui.state==="WIDGET"){this.setPosition()}},setOnline:function(){addClass(this._label,"jivo-online");removeClass(this._label,"jivo-offline");this.setText(config.online_widget_label);var t=e("jivo-bottom-left-square");for(var i=0;i<t.length;i+=1){t[i].style.backgroundColor="#44bb6e"}t=e("jivo-css-leaf");for(i=0;i<t.length;i+=1){removeClass(t[i],"jivo-offline");addClass(t[i],"jivo-online")}},setPosition:function(){var e=getElementPosition(this._label),t=document.getElementById("jivo-label-text").offsetWidth,i=0,n=0,o,a=this._widgetContainer.style;switch(config.widget_orientation){case"left":case"right":o=config.iconLocale==="en"?38:48;break;case"top":case"bottom":o=10;break}if(utils.showAd()){i=this._copyright.offsetWidth;n=this._copyright.offsetHeight}var s=document.getElementById("jivo-label-status").offsetWidth,r=document.getElementById("jivo-label-status").offsetHeight;switch(config.widget_orientation){case"left":case"right":var l=document.getElementById("jivo-text-container"),c=l.getElementsByTagName("div")[0];if(c.offsetWidth<c.offsetHeight){l.style.width=c.offsetWidth+"px";l.style.height=c.offsetHeight+"px"}else{l.style.width=c.offsetHeight+"px";l.style.height=c.offsetWidth+"px"}var d=l.offsetHeight;this._label.style.width=config.widget_height+"px";a.width=config.widget_height+"px";a.height=d+n+r+o+"px";e=getElementPosition(this._label);switch(config.widget_padding){case"0":a.top="";a.bottom="100%";a.marginBottom=parseFloat(a.height)*-1-30+"px";break;case"50":a.marginBottom=parseFloat(a.height)/2*-1+"px";a.bottom=config.widget_padding+"%";break}if(parseInt(a.height)<90)a.height="90px";this.widgetHeight=a.height;this.widgetMarginBottom=a.marginBottom;if(!f.isMobile()){this._innerLabelWrapper.style.height=parseFloat(this.widgetHeight)-this._copyright.offsetHeight+"px"}break;case"top":a.width=t+i+s+o+"px";a.height=config.widget_height+"px";this._label.style.height=config.widget_height+"px";switch(config.widget_padding){case"0":a.left="30px";a.right="";a.bottom="100%";break;case"50":a.marginRight=e.width/2*-1+"px";a.bottom="100%";a.right=config.widget_padding+"%";a.left="";break;case"100":a.bottom="100%";break}this.widgetWidth=a.width;if(!f.isMobile()){this._innerLabelWrapper.style.width=parseFloat(this.widgetWidth)-this._copyright.offsetWidth-5+"px"}break;case"bottom":var u=t+i+s+o;if(ie8&&u<300){u=300;this.widgetWidth=u+"px"}a.width=u+"px";a.height=config.widget_height+"px";this._label.style.height=config.widget_height+"px";switch(config.widget_padding){case"0":a.left=30+"px";a.right="";break;case"50":a.marginRight=e.width/2*-1+"px";a.right=config.widget_padding+"%";a.left="";break}this.widgetWidth=a.width;if(!f.isMobile()){this._innerLabelWrapper.style.width=parseFloat(this.widgetWidth)-this._copyright.offsetWidth-5+"px"}break}},setLabelPosition:function(){var e=document.getElementById("jivo-label-text").offsetWidth,t=0,i=0,n;switch(config.widget_orientation){case"left":case"right":n=config.iconLocale==="en"?38:48;break;case"top":case"bottom":n=10;break}if(utils.showAd()){t=document.getElementById("jivo-label-copyright").offsetWidth;i=document.getElementById("jivo-label-copyright").offsetHeight}var o=document.getElementById("jivo-label-status").offsetWidth,a=document.getElementById("jivo-label-status").offsetHeight;switch(config.widget_orientation){case"left":case"right":var s=document.getElementById("jivo-text-container"),r=s.getElementsByTagName("div")[0];if(r.offsetWidth<r.offsetHeight){s.style.width=r.offsetWidth+"px";s.style.height=r.offsetHeight+"px"}else{s.style.width=r.offsetHeight+"px";s.style.height=r.offsetWidth+"px"}var l=s.offsetHeight;this._label.style.width=config.widget_height+"px";this._label.style.height=this.widgetHeight=l+i+a+n+"px";break;case"top":case"bottom":this._label.style.height=config.widget_height+"px";var c=this.widgetWidth=e+t+o+n;if(ie8&&c<300){c=300}this._label.style.width=this.widgetWidth=c+"px";break}},setFontStyle:function(){var e=document.getElementById("jivo-label-text");switch(config.font_type){case"normal":e.style.fontWeight="normal";e.style.fontStyle="normal";break;case"italic":e.style.fontWeight="normal";e.style.fontStyle="italic";break;case"bold":e.style.fontWeight="bold";e.style.fontStyle="normal";break;case"bold italic":e.style.fontWeight="bold";e.style.fontStyle="italic";break}e.style.fontSize=config.font_size},getPosition:function(){return getElementPosition(document.getElementById("jivo-label"))}});var l=i.extend({timer:0,seconds:0,textEl:false,initialState:"unitialized",namespace:"CALLTIMER",setTimerNull:function(){clearInterval(this.timer);cookie("cw_timer",null)},initialize:function(){log("CallTimer initalized.")},states:{unitialized:{start_timer:"STARTTIMER"},STARTTIMER:{_onEnter:function(){this.handle("start_timer")},start_timer:function(){var e=this.seconds,t=e*1e3,i=this.callTimerText;log(i);i.innerHTML=t/1e3;clearInterval(this.timer);this.timer=setInterval(underscore.bind(function(){if(!cookie("cw_timer")){cookie("cw_timer",(new Date).getTime())}else{var e=parseInt((new Date).getTime())-parseInt(cookie("cw_timer"));t=this.seconds*1e3-e;t=(t/1e3).toFixed(1)*1e3;if(t<=0){clearInterval(this.timer);this.timer=false;this.handle("timer_finished");return}}if(t/1e3%1===0&&Number(t)===t){i.innerHTML=t/1e3+".0"}else{i.innerHTML=t/1e3}t=t-100;if(t<=0){i.innerHTML=t;clearInterval(this.timer);this.timer=false;this.handle("timer_finished")}},this),100)},timer_finished:"STOP",cancel_timer:"unitialized"},STOP:{_onEnter:function(){log("STOP, timer_finished");chat_view_online.getCallBackView().showConnecting()},start_timer:"STARTTIMER"}}});var c=i.extend({namespace:"GUI",mode:"online",animate:false,unreadMessages:0,skipStoreState:false,_event_queue:[],setOnline:function(){this.widget.setOnline();this.mode="online";return this},setOffline:function(){if(this.mode!="offline"){this._setButtonsOffline();this.widget.setOffline();this.mode="offline"}return this},showWidget:function(e,t){this.enableAnimation(!!e);this.skipStoreState=!!t;this.handle("minimize");return this},showChat:function(e,t){log("showChat",t);if(f.isMobileOrTablet()){f._callUserFunction("onOpen");this.resetCounter();this.openNewWindow()}else{this.enableAnimation(!!e);this.handle("maximize",t)}return this},showCallWidget:function(){log("showCallWidget");this.widget._hideLabelForCallWidget=true;if(this.jivoframecontainer.dragHandle){this.jivoframecontainer.dragHandle.style.display="none"}this.handle("callwidget")},showInvitation:function(e,t){this.handle("invitation",e,t);return this},showLabelForCallWidget:function(){this.widget._hideLabelForCallWidget=false;if(this.widget.state==="VISIBLE"){this._chatDiv.style.visibility="visible"}if(config.widget_orientation==="top"||config.widget_orientation==="bottom"){this._chatDiv.style.height=config.widget_height+"px"}else{log("showLABEL",config.widget_height)}},openNewWindow:function(){log("this.openNewWindow",window.location.protocol);var e=window.location.protocol,t=e+jivo_config.base_url+"/script/window/"+jivo_config.widget_id,i=[],n=["client_id"],o;if(jivo_config.chat_mode==="online"){n.push("sess_id")}for(var a=0;a<n.length;a++){if(cookie(n[a])){i.push(n[a]+"="+cookie(n[a]));log("cookie for new window",cookie(n[a]))}}o=f.getCurrentPage();i.push("url="+encodeURIComponent(o.url));i.push("title="+encodeURIComponent(o.title));if(i.length){t+="?"+i.join("&")}var s;f.isTablet()&&f.checkVisibilityAPI?s=window.open(t,"jivo_"+config.widget_id):window.parent.window.location=t;if(s){s.focus()}},chatInitialized:function(){return!!this._chatDiv},incrementCounter:function(){if(this.widget.isCustomLabel())return;var e=document.getElementById("jivo-label-indicator");e.innerHTML=++this.unreadMessages;e.style.visibility="visible";if(config.widget_orientation==="top"||config.widget_orientation==="bottom"){this.jivoframecontainer.setHeight("50px")}else{this.jivoframecontainer.setWidth("50px")}},resetCounter:function(){var e=document.getElementById("jivo-label-indicator");this.unreadMessages=0;e.style.visibility="hidden"},_setButtonsOffline:function(){var t=false;var i=e("jivo-online-btn",window.parent.document);for(var n=0;n<i.length;n++){if(!t){t=i[n].style.display}i[n].style.display="none"}i=e("jivo-offline-btn",window.parent.document);for(n=0;n<i.length;n++){i[n].style.display=t}},highlight:function(e){var t=config.base_url+"/script/cobrowsing?cb=?&hash="+e;getJSONP(t,function(e){if(underscore.isObject(e)){if(e.comment.length==0)e.comment=translate("lblDefaultCobrowseComment");e.comment=stripBrackets(e.comment);coBrowserIframeCreater.process("highlight",e);coBrowserIframeCreater.process("renderTooltip",e)}})},setColor:function(){this._isDarkText=config.widget_font_color=="dark";this._backgroundColor=config.widget_color;this._borderColor=adjustLightness(this._backgroundColor,.6,1);this._bodyColor=adjustLightness(this._backgroundColor,1.15,.5);if(this._chatDiv){var e,t;if(this._isDarkText){e=adjustLightness(this._backgroundColor,1.15,.7)+" 0 1px";t=adjustLightness(this._backgroundColor,.1,.5)}else{e=adjustLightness(this._backgroundColor,.6,1)+" 0 -1px";t="#ffffff"}}},setChatHeight:function(e){log("Setting chat height: "+e);this.jivoframecontainer.setHeight(e+"px")},initialize:function(){var i,n;this._wrapDiv=document.createElement("div");this._wrapDiv.setAttribute("id","jivo_top_wrap");document.body.appendChild(this._wrapDiv);this._chatDiv=document.createElement("div");this._chatDiv.setAttribute("id","jivo-chat");this._chatDiv.innerHTML=t.chat({chatMode:config.chat_mode,mobile:"desktop",lblLookingForFreeAgent:translate("lblLookingForFreeAgent"),lblPhoneHint:translate("lblPhoneHint"),inputBorderColor:getInputColor()});this._wrapDiv.appendChild(this._chatDiv);addClass(this._chatDiv,"jivo-animated jivo-"+config.chat_mode);underscore.defaults(config,{online_widget_label:translate("defOnlineWidgetLabel"),offline_widget_label:translate("defOfflineWidgetLabel"),offline_form_text:translate("defOfflineFormText"),contacts_settings:{name:{show:false,required:false},phone:{show:false,required:false},email:{show:false,required:false}}});if(f.isMobile()){config.online_widget_label=translate("defOnlineWidgetLabelMobile")||config.online_widget_label;config.offline_widget_label=translate("defOfflineWidgetLabelMobile")||config.offline_widget_label;config.widget_orientation="bottom";config.widget_padding=100;if(config.ignore_viewport){f.ignore_viewport=config.ignore_viewport}}if(f.isWixIframe()){config.widget_orientation="bottom"}if(ie8){config.widget_orientation="bottom";config.widget_padding="100"}config.style_string+=" jivo_shadow";this.widget=new r({topWrap:this._wrapDiv});this.copyright=new d;this.jivoframecontainer=new h({widget:this.widget});this.labelButtons=new g;if(this.animationIsSupported()){this.jivoframecontainer.on("expanded",underscore.bind(this.handle,this,"animate_finished"));this.jivoframecontainer.on("collapsed",underscore.bind(this.handle,this,"animate_finished"))}getConfigContactsAsk();this.setColor();var o={seconds:config.callback_widget,initTimer:config.callback_widget,textTimerWait:null};this.callTimer=new l(o);n=e("jivo-chat-triangle");for(i=0;i<n.length;i++){n[i].style.borderLeftColor=config.widget_color;n[i].style.borderTopColor=config.widget_color}n=e("jivo-triangle-inner");for(i=0;i<n.length;i++){n[i].style.backgroundColor=config.widget_color}if(config.chat_mode=="offline"){n=e("jivo-bottom-left-square");for(i=0;i<n.length;i++){n[i].style.backgroundColor=config.widget_color}}},enableAnimation:function(e){if(!f.isWixIframe()&&e){log("GUI : enabling animation");this.animate=true}else{log("GUI : disabling animation");this.animate=false}},animationIsSupported:function(){return!!(!this.widget.isCustomLabel()&&css3AnimationIsSupported())},setGuiState:function(){if(f.pageVisible()&&this.setCookie){cookie("gui_state",this.state)}},handleBlacklist:function(e){if(e.err_code&&e.err_code==="blacklisted"){this.handle("blacklist");s.allRulesCancel();if(this.widget.isCustomLabel()){this.widget.customElement.style.display="none"}}else{if(utils.hideOffline()){chat_contents.handle("connect_failed")}else{chat_contents.handle("gui_leave_msg")}}},states:{uninitialized:{minimize:"WIDGET",maximize:function(){this._event_queue.push(["show",this.mode]);this.transition("CHAT")},blacklist:"INVISIBLE",resume_ok:function(e){var t=e.client_info.msg_history;window.chat_contents.handle.apply(window.chat_contents,["resume_ok"].concat(underscore.toArray(arguments)));if(underscore.findWhere(t,{type:"agentMessage",ack:0})){this.transition("CHAT");return}var i=cookie("gui_state"),n=e.client_info.cw_call&&e.client_info.cw_call.status;if(!i||i==="CALLWIDGET"&&!n||i==="CALLWIDGET"&&n==="cw_call_end"){log("callback check to state",i);i="WIDGET"}if(n==="cw_error"){n=false}if(n){if(n!=="cw_connected"){this.jivoframecontainer.setHeight("410px")}else{var o="124px";if(f.resumed_context.agent_info&&f.resumed_context.agent_info.state==0){o="70px"}else if(chat_view_online&&chat_view_online.getChatModel().get("agent.online")){o="124px"}log("setexpandto",o);this.jivoframecontainer.expandTo=o}this.jivoframecontainer.setWidth("300px");this.jivoframecontainer.setTransition(false);i="CALLWIDGET"}if(n&&cookie("chat_call")==1){this.jivoframecontainer.expandTo=false;i="CHAT";f.handle(n)}if(f.state==="OFFLINE"&&i==="CHAT"){log("handle expand from resume_ok");f.gui.jivoframecontainer.setTransition(false);f.gui.jivoframecontainer.handle("expand")}log("resume_ok trasition to: ",i);this.transition(i)}},WIDGET:{_onEnter:function(){removeClass(this.jivoframecontainer.element,"jivo-state-chat");addClass(this.jivoframecontainer.element,"jivo-state-widget");removeClass(this.jivoframecontainer.element,"jivo-expanded");addClass(this.jivoframecontainer.element,"jivo-collapsed");log("widget transition");if(!this.skipStoreState){cookie("gui_state",this.state)}this.skipStoreState=false;n.updateClient({chat_opened:false});if(this.chatInitialized()){this._chatDiv.style.display="none";this._chatDiv.style.visibility="hidden";removeClass(this._chatDiv,"jivo-fade-in");if(this.jivoframecontainer.closeButton){this.jivoframecontainer.closeButton.style.display="none"}}log("WIDGET.onEnter",this.widget.isCustomLabel());if(!this.widget.isCustomLabel()){this.widget.handle("show");this.widget.setPosition()}else{this.jivoframecontainer.element.style.visibility="hidden"}if(this.jivoframecontainer.dragHandle){this.jivoframecontainer.dragHandle.style.display="none"}},minimize:function(){log("widget minimized");addClass(this.jivoframecontainer.element,"jivo-no-transition");if(config.widget_orientation==="right"||config.widget_orientation==="left"){this.jivoframecontainer.setWidth("38px")}else{this.jivoframecontainer.setHeight("38px")}$(".jivo-call-form").hide()},maximize:function(e){if(this.chatInitialized()){this._chatDiv.style.height="";this.jivoframecontainer.innerChat.style.display="none";this.jivoframecontainer.innerChat.style.visibility="hidden"}this.resetCounter();this._event_queue.push(["show",this.mode,e]);this.copyright.transition("HIDDEN");this.jivoframecontainer.element.style.visibility="visible";if(this.animationIsSupported()&&this.animate){this.transition("ANIMATE_EXPAND")}else{this.jivoframecontainer.handle("expand");this.transition("CHAT")}},callwidget:function(){if(this.chatInitialized()){this._chatDiv.style.height="";this.jivoframecontainer.innerChat.style.display="none";this.jivoframecontainer.innerChat.style.visibility="hidden"}this.resetCounter();this.copyright.transition("HIDDEN");if(this.animationIsSupported()){this.nextState="CALLWIDGET";if(f.cw.callwidget.state!=="CALL"){this.jivoframecontainer.expandTo="410px"}this.transition("ANIMATE_EXPAND")}else{this.transition("CALLWIDGET")}},"*":function(e,t){log("widget payload",e,arguments);log("isMobile",f.isMobile(),"isTablet",f.isTablet(),!(f.isMobile()||f.isAndroid4old()&&f.isTablet()));if(!(f.isMobileOrTablet()||f.isAndroid())){log("desktop, expand to chat.");if(e!=="invitation"){this._event_queue.push(["show",this.mode])}this._event_queue.push(underscore.toArray(arguments));if(underscore.indexOf(["agent_message","invitation","agent_service_message"],e)>=0||cookie("chat_call")==1&&f.resumed_context){if(config.departments&&e==="invitation"){chat_view_online.getDepartmentsView().close()}this.transition(this.animationIsSupported()?"ANIMATE_EXPAND":"CHAT")}else if(e==="resume_ok"){var i=cookie("gui_state"),n=t.client_info.cw_call&&t.client_info.cw_call.status;switch(i){case"CHAT":this.transition(i);break;case"CALLWIDGET":if(!n||n==="cw_call_end"){this.transition("WIDGET")}else{if(!f.isMobileOrTablet()){this.jivoframecontainer.setTransition(false)}this.transition("CALLWIDGET")}break;default:break}}}else if(underscore.indexOf(["agent_message","system_message","invitation","agent_service_message"],e)>=0){if(underscore.indexOf(["agent_message","invitation","agent_service_message"],e)>=0){this.incrementCounter()}}},blacklist:"INVISIBLE",connect_failed:function(e){this.handleBlacklist(e)}},CHAT:{_onEnter:function(){removeClass(this.jivoframecontainer.element,"jivo-state-widget");addClass(this.jivoframecontainer.element,"jivo-state-chat");this.copyright.transition("HIDDEN");if(this.labelButtons.enabled){this.labelButtons.transition("HIDDEN")}if(this.widget.isCustomLabel()){removeClass(this.jivoframecontainer.element,"jivo-custom-label")}removeClass(this.jivoframecontainer.element,"jivo-collapsed");addClass(this.jivoframecontainer.element,"jivo-expanded");log("CHAT prior action",this._priorAction);cookie("gui_state",this.state);n.updateClient({chat_opened:true});if(f.getCallWidget()){f.getCallWidget().hideCallWidget()}if(this._priorAction!="WIDGET.maximize"&&f.state!="OFFLINE"){addClass(this.jivoframecontainer.element,"jivo-no-transition");if(!f.isTablet()&&f.state!="OFFLINE"){this.showChat(true,this.openParams)}}if(cookie("collapsed")){addClass(this.jivoframecontainer.element,"jivo-no-transition")}else{removeClass(this.jivoframecontainer.element,"jivo-no-transition")}this._chatDiv.style.height="100%";this._chatDiv.style.display="block";this._chatDiv.style.visibility="visible";if(this.jivoframecontainer.closeButton){this.jivoframecontainer.closeButton.style.display="block"}log("CHAT",$("#introduce-form").is(":visible"),cookie("expanded"));if(!$("#introduce-form").is(":visible")&&$("#introduce-form").css("display")==="none"||(config.contacts_ask==2||config.contacts_ask==0)){if(this.jivoframecontainer.dragHandle){this.jivoframecontainer.dragHandle.style.display="block"}}else{if(this.jivoframecontainer.dragHandle){this.jivoframecontainer.dragHandle.style.display="none"}}this.jivoframecontainer.jivoLeaf.style.display="block";var e;while(e=this._event_queue.shift()){log("CHAT onEnter, apply chat_contents event",e);window.chat_contents.handle.apply(window.chat_contents,e)}if(!this.widget.fade){this.widget.fade=true}this.widget.handle("hide");if(!this.animationIsSupported()){this.handle("maximize")}if(this.animationIsSupported()&&this.priorState!=="CALLWIDGET"&&!cookie("collapsed")){addClass(this.jivoframecontainer.innerChat,"jivo-fade-in")}this.jivoframecontainer.innerChat.style.display="block";this.jivoframecontainer.innerChat.style.visibility="visible";if(f.state==="OFFLINE"){$("#jivo-form-container").hide();chat_view_offline.disableDragging()}else{chat_view_online.getChatView().updateMessage();chat_view_online.getMessagesView().setScrollBottom(0);chat_view_online.getMessagesView().updateScrollBar()}},minimize:function(){if(this.widget.isCustomLabel()){this.jivoframecontainer.element.style.visibility="hidden";addClass(this.jivoframecontainer.element,"jivo-no-transition");this.jivoframecontainer.element.style.visibility="hidden"}else{removeClass(this.jivoframecontainer.element,"jivo-no-transition")}removeClass(this.jivoframecontainer.element,"jivo-state-chat");addClass(this.jivoframecontainer.element,"jivo-state-widget");if(this.animationIsSupported()&&this.animate){this.jivoframecontainer.innerChat.style.display="none";this.jivoframecontainer.innerChat.style.visibility="hidden";removeClass(this.jivoframecontainer.innerChat,"jivo-fade-in");addClass(this.jivoframecontainer.chatDiv,"jivo-fade-out")}else{this.jivoframecontainer.innerChat.style.display="none";this.jivoframecontainer.innerChat.style.visibility="hidden"}if(this.jivoframecontainer.closeButton){this.jivoframecontainer.closeButton.style.display="none"}if(this.jivoframecontainer.dragHandle){this.jivoframecontainer.dragHandle.style.display="none"}this.jivoframecontainer.jivoLeaf.style.display="none";if(f.state=="OFFLINE"&&utils.hideOffline()){this.handle("blacklist");return}if(this.animationIsSupported()&&this.animate){if(f.getCallWidget()&&f.getCallWidget().state==="CALL"){this.jivoframecontainer.closeButton.style.display="none";this.handle("callwidget")}else{this.transition("ANIMATE_COLLAPSE")}}else{this._chatDiv.style.display="none";this._chatDiv.style.visibility="hidden";this.transition("WIDGET")}},maximize:function(){this.jivoframecontainer.element.style.visibility="visible";var e=this.jivoframecontainer.getChatPosition(),t=this.jivoframecontainer.element.style;t.width="300px";if(this.widget.isCustomLabel()){this.jivoframecontainer.element.style.visibility="visible"}if(f.resumed_context&&chat_view_online.getChatModel().get("agent.state")===0){e.height=$("#header-avatar").height()+"px"}if(this.jivoframecontainer.expandTo){e.height=parseInt(this.jivoframecontainer.expandTo)+"px"}if(cookie("collapsed")==1){log("maximize hide close & drag");setTimeout(function(){f.gui.jivoframecontainer.closeButton.style.display="none";f.gui.jivoframecontainer.dragHandle.style.display="none"},10);if(this._priorAction!="uninitialized.resume_ok"){removeClass(this.jivoframecontainer.element,"jivo-no-transition")}e.height="70px"}switch(config.widget_orientation){case"left":t.marginLeft="30px";t.top="";t.bottom="0";t.left=e.left;t.height=e.height;t.marginBottom="0";break;case"right":t.marginRight="30px";t.marginBottom="0";t.top="";t.bottom="0";t.right=e.right;t.height=e.height;break;case"top":t.top="auto";t.bottom="0";t.marginBottom="0";t.height=e.height;if(config.widget_padding=="0"){t.left=e.left}else if(config.widget_padding=="50"){if(!e.left&&!e.right){t.right="30px"}else{t.right=e.right}t.margin=""}else if(config.widget_padding=="100"){t.right=e.right}break;case"bottom":t.height=e.height;if(config.widget_padding=="0"){t.left=e.left}if(config.widget_padding=="50"){if(!e.left&&!e.right){t.right="30px";t.marginRight=""}else{t.right=e.right;t.margin=""}}if(config.widget_padding=="100"){if(!e.left&&!e.right){t.right="30px"}else{t.right=e.right}}break}log("maximize",this._priorAction);if(cookie("collapsed")==1){$("#header-avatar").addClass("expanded")}else{$("#header-avatar").removeClass("expanded");chat_view_online.getChatView().toolbarToggle("show")}f.transferProportion({width:parseFloat(t.width),height:parseFloat(t.height)})},callwidget:function(){this.transition("CALLWIDGET")},"*":function(e,t){log("gui CHAT payload, chat_contents apply.",e);window.chat_contents.handle.apply(window.chat_contents,underscore.toArray(arguments));if(e==="resume_ok"){if(cookie("gui_state")&&cookie("gui_state")==="WIDGET"){this.transition("WIDGET")}}},blacklist:"INVISIBLE",connect_failed:function(e){this.handleBlacklist(e)}},CALLWIDGET:{_onEnter:function(){this.jivoframecontainer.setWidth("300px");var e="";if(f.resumed_context&&f.resumed_context.client_info.cw_call&&f.resumed_context.client_info.cw_call.status==="cw_connected"){if(f.resumed_context.agent_info.state===0){e="70px"}else{e="124px"}this.jivoframecontainer.expandTo=e}else{if(f.state==="OFFLINE"&&f.getCallWidget().currentState==="cw_connected"){e="124px"}else{e="410px"}this.jivoframecontainer.expandTo=e}if(f.state==="OFFLINE"){log("gui CALLWIDGET set height",e);this.jivoframecontainer.setHeight(e)}else{this.jivoframecontainer.handle("expand")}f.getCallWidget().showCallWidget();cookie("gui_state",this.state);n.updateClient({chat_opened:false});removeClass(this.jivoframecontainer.element,"jivo-state-widget");addClass(this.jivoframecontainer.element,"jivo-state-chat");this.copyright.transition("HIDDEN");if(this.labelButtons.enabled){this.labelButtons.transition("HIDDEN")}if(this.widget.isCustomLabel()){removeClass(this.jivoframecontainer.element,"jivo-custom-label")}removeClass(this.jivoframecontainer.element,"jivo-collapsed");addClass(this.jivoframecontainer.element,"jivo-expanded");this.jivoframecontainer.innerChat.style.display="none";this.jivoframecontainer.innerChat.style.visibility="hidden";this._chatDiv.style.height="100%";this._chatDiv.style.display="block";this._chatDiv.style.visibility="visible";if(this.jivoframecontainer.dragHandle){this.jivoframecontainer.dragHandle.style.display="none"}this.jivoframecontainer.jivoLeaf.style.display="block";var t;while(t=this._event_queue.shift()){log("CHAT onEnter, apply chat_contents event",t);window.chat_contents.handle.apply(window.chat_contents,t)}if(!this.widget.fade){this.widget.fade=true}this.widget.handle("hide");if(!this.jivoframecontainer.callbackContainer){this.jivoframecontainer.callbackContainer=document.getElementById("jivo-form-container")}if(this.animationIsSupported()){removeClass(this.jivoframecontainer.innerChat,"jivo-fade-out");addClass(this.jivoframecontainer.callbackContainer,"jivo-fade-in")}else{var i=this.jivoframecontainer.element.style;switch(config.widget_orientation){case"left":i.marginLeft="30px";i.top="";i.bottom="0";break;case"right":i.marginRight="30px";i.marginBottom="0";i.top="";i.bottom="0";break;case"top":i.top="auto";i.bottom="0";i.marginBottom="0";i.right="30px";break;case"bottom":i.right="30px";break}}this.jivoframecontainer.callbackContainer.style.display="block";this.jivoframecontainer.callbackContainer.style.visibility="visible"},minimize:function(){f.getCallWidget().hideCallWidget();removeClass(this.jivoframecontainer.element,"jivo-no-transition");removeClass(this.jivoframecontainer.element,"jivo-state-chat");addClass(this.jivoframecontainer.element,"jivo-state-widget");this.jivoframecontainer.callbackContainer.style.display="none";this.jivoframecontainer.callbackContainer.style.visibility="hidden";if(this.animationIsSupported()){removeClass(this.jivoframecontainer.innerChat,"jivo-fade-in");removeClass(this.jivoframecontainer.callbackContainer,"jivo-fade-in");addClass(this.jivoframecontainer.chatDiv,"jivo-fade-out")}this.jivoframecontainer.closeButton.style.display="none";if(this.jivoframecontainer.dragHandle){this.jivoframecontainer.dragHandle.style.display="none"}this.jivoframecontainer.jivoLeaf.style.display="none";if(this.animationIsSupported()){this.transition("ANIMATE_COLLAPSE")}else{this._chatDiv.style.display="none";this._chatDiv.style.visibility="hidden";this.transition("WIDGET")}},maximize:function(e){this._event_queue.unshift(["show",e?e:this.mode]);this.jivoframecontainer.expandTo=false;$("#jivo-form-container").hide();this.transition("CHAT")},"*":function(e){this._event_queue.push(underscore.toArray(arguments));if(e==="agent_message"){this.handle("maximize")}else if(e==="resume_ok"){if(f.getCallWidget().state==="CLOSED"){this.transition("WIDGET")}}},blacklist:"INVISIBLE",connect_failed:function(e){this.handleBlacklist(e)
},cw_show_form:function(){setTimeout(function(){chat_view_online.getChatView().toolbarToggle("show")},250)}},ANIMATE_EXPAND:{_onEnter:function(){this.copyright.transition("HIDDEN");if(this.labelButtons.enabled){this.labelButtons.transition("HIDDEN")}removeClass(this.jivoframecontainer.element,"jivo-no-transition");addClass(this.jivoframecontainer.chatDiv,"jivo-animating jivo-opening");addClass(this.jivoframecontainer.element,"jivo-opening");this.jivoframecontainer.innerChat.style.display="none";this.jivoframecontainer.innerChat.style.visibility="hidden";this.jivoframecontainer.chatDiv.style.display="block";this.jivoframecontainer.chatDiv.style.visibility="visible";this.jivoframecontainer.jivoLeaf.style.display="none";if(this.widget.isCustomLabel()){this.jivoframecontainer.element.style.visibility="visible"}log("ANIMATE expand: jivoframecontainer handle expand");this.jivoframecontainer.handle("expand");this.widget.handle("hide")},animate_finished:function(){removeClass(this.jivoframecontainer.chatDiv,"jivo-animating jivo-opening");removeClass(this.jivoframecontainer.element,"jivo-opening");this.jivoframecontainer.innerChat.style.display="block";if(f.state=="OFFLINE"){addClass(this.jivoframecontainer.element,"jivo-no-transition")}var e=this.nextState;this.nextState=null;this.transition(e?"CALLWIDGET":"CHAT")},resume_ok:function(){window.chat_contents.handle.apply(window.chat_contents,["resume_ok"].concat(underscore.toArray(arguments)));this.handle("animate_finished")},"*":function(e,t){this._event_queue.push(underscore.toArray(arguments))},blacklist:"INVISIBLE",connect_failed:function(e){this.handleBlacklist(e)}},ANIMATE_COLLAPSE:{_onEnter:function(){addClass(this.jivoframecontainer.element,"jivo-closing");addClass(this.jivoframecontainer.chatDiv,"jivo-animating jivo-closing");this.jivoframecontainer.jivoLeaf.style.display="none";this.jivoframecontainer.handle("collapse")},"*":function(e,t){this._event_queue.push(underscore.toArray(arguments))},animate_finished:function(){removeClass(this.jivoframecontainer.chatDiv,"jivo-animating jivo-closing");removeClass(this.jivoframecontainer.element,"jivo-closing");this.transition("WIDGET")},blacklist:"INVISIBLE",connect_failed:function(e){this.handleBlacklist(e)},resume_ok:function(){this.handle("animate_finished")}},INVISIBLE:{_onEnter:function(){this.widget.handle("hide");this.jivoframecontainer.element.setAttribute("style","display:none !important");this._chatDiv.style.display="none";this._chatDiv.style.visibility="hidden";removeClass(this._chatDiv,"jivo-fade-in")}}}},{_backgroundColor:0,_borderColor:0,_bodyColor:0,_shadow:0});var d=i.extend({namespace:"AD",initialState:"HIDDEN",disabled:false,initialize:function(){var e=document.getElementById("jivo-label-copyright"),t=this.widgetContainer=window.parent.document.getElementById("jivo-iframe-container"),i=this.widgetHeight=parseFloat(config.widget_height),n=this.widgetWidth=this.widgetContainer.offsetWidth;if(!utils.showAd()){addClass(e,"jivo-no-copyright");this.disabled=true;return}this.jivo_copyright=document.getElementById("jivo_copyright");if(!this.jivo_copyright){this.jivo_copyright=document.createElement("div");this.jivo_copyright.innerHTML=translate("seo_copyrightTextNew").replace("_COLOR_",config.widget_font_color);this.jivo_copyright.id="jivo_copyright";this.jivo_copyright.style.display="none";document.body.appendChild(this.jivo_copyright)}var o=document.createElement("div");o.setAttribute("id","jivo_copyright_corner");o.setAttribute("class","jivo-"+config.widget_orientation);switch(config.widget_orientation){case"top":o.style.borderBottomColor=config.widget_color;break;case"left":o.style.borderRightColor=config.widget_color;break;case"right":o.style.borderLeftColor=config.widget_color;break;case"bottom":o.style.borderTopColor=config.widget_color;break}this.jivo_copyright.style.backgroundColor=config.widget_color;this.jivo_copyright.style.color=f.getTextColor();this.jivo_copyright.appendChild(o);var a=this.jivo_copyright.getElementsByTagName("a");for(var s=0;s<a.length;s++){a[s].href+="?utm_source="+encodeURIComponent(location.hostname)+"&utm_medium=link&utm_content=widget_popup&utm_campaign=self_ad"}if(!f.isMobile()){e.onmouseover=underscore.bind(this.handle,this,"ad_mouseover");e.onmouseout=underscore.bind(this.handle,this,"ad_mouseout");this.jivo_copyright.onmouseover=underscore.bind(this.handle,this,"copyright_mouseover");this.jivo_copyright.onmouseout=underscore.bind(this.handle,this,"copyright_mouseout")}},getTooltipSize:function(){var e=getElementPosition(this.jivo_copyright);return{width:e.width,height:e.height}},getTooltipPosition:function(e){var t=getElementPosition(e),i=getElementPosition(this.jivo_copyright),n={top:0,left:0},o;switch(config.widget_orientation){case"left":o=10;n={top:t.top+20,left:t.left+40+o};if(ie8){n={top:t.top,left:t.left+this.widgetWidth+10}}break;case"right":o=config.iconLocale==="en"?80:60;n={top:t.top+20,right:50};break;case"top":n={top:t.top+(t.height+15),left:t.left+40};break;case"bottom":n={bottom:t.height+10,left:t.left+(t.width-i.width)-40};break}return n},states:{HIDDEN:{_onEnter:function(){if(!this.disabled){this.jivo_copyright.style.display="none"}switch(config.widget_orientation){case"left":case"right":this.widgetContainer.style.width=this.widgetWidth+"px";break;case"top":case"bottom":this.widgetContainer.style.height=this.widgetHeight+"px";break}removeClass(this.widgetContainer,"jivo-no-transition")},ad_mouseover:"VISIBLE"},VISIBLE:{_onEnter:function(){if(f.gui.labelButtons){f.gui.labelButtons.transition("HIDDEN");f.gui.labelButtons.element.style.display="none"}this.jivo_copyright.style.display="block";this.widgetContainer.style.width=f.gui.jivoframecontainer.widgetWidth;var e=this.getTooltipPosition(document.getElementById("jivo-label")),t=this.getTooltipSize(),i=150;addClass(this.widgetContainer,"jivo-no-transition");switch(config.widget_orientation){case"left":case"right":this.widgetContainer.style.width=this.widgetWidth+t.width+i+"px";break;case"top":case"bottom":this.widgetContainer.style.height=this.widgetHeight+t.height+i+"px";break}if(e.left){this.jivo_copyright.style.left=e.left+"px"}if(e.right){this.jivo_copyright.style.right=e.right+"px"}if(typeof e.bottom!="undefined"){this.jivo_copyright.style.bottom=e.bottom+"px"}else{this.jivo_copyright.style.top=e.top+"px"}},ad_mouseout:function(){this._scheduleEvent("hide",700)},hide:"HIDDEN",copyright_mouseover:function(){this._cancelEvent("hide")},copyright_mouseout:function(){this._scheduleEvent("hide",700)}}}});var u=new i({namespace:"TITLE",title:"",startBlink:function(){this.handle("start")},stopBlink:function(){this.handle("stop")},_messageShown:false,_showMessage:function(){window.parent.document.title=translate("lblNewMessage");this._messageShown=true},_showTitle:function(){window.parent.document.title=this.title;this._messageShown=false},states:{uninitialized:{start:"blinking"},blinking:{_onEnter:function(){this.title=window.parent.document.title;this._showMessage();this._scheduleEvent("blink",1e3)},blink:function(){if(this._messageShown){this._showTitle()}else{this._showMessage()}this._scheduleEvent("blink",1e3)},stop:function(){this._showTitle();this._cancelEvent("blink");this.transition("uninitialized")}}}});var f=window.jivo=new i({namespace:"JIVO",_chatWindow:false,_forcedCurrentPage:false,_forcedOffline:false,checkVisibilityAPI:true,invitationText:false,agentInfo:false,ruleName:false,isClicked:false,isOpen:false,initialize:function(){config.widget_height="38";var e=underscore.bind(this.handle,this,"window.loaded");if(document.readyState==="complete"){setTimeout(e)}else if(document.addEventListener){document.addEventListener("DOMContentLoaded",e,false);window.addEventListener("load",e,false)}else if(document.attachEvent){document.attachEvent("onreadystatechange",e);window.attachEvent("onload",e)}var t=devicejs.ios()?"pagehide":"beforeunload";addListener(window,t,this.onIframeWindowUnload);this.device=devicejs},onIframeWindowUnload:function(){var e=$("#jivo_container",parent.document);if(e&&e.attr("src")=="javascript:false"){return}try{if(window.parent.window!=window.top){if(window.top.jivo_magic_var===window.parent.window.jivo_magic_var&&!f.isMobileOrTablet()){log("window.onunload INIFRAME");return}}}catch(t){}telemetry("onIframeWindowUnload");$(f.getPageWindow()).off("resize");$("#jivo-chat").unbind("jivo.drag.init").unbind("jivo.drag.move").unbind("jivo.drag.stop");$("#jivo-iframe-container",parent.document).css({visibility:"hidden",display:"none"});if(ie8||ie9){try{window.top.postMessage("iframe_url_changed","*")}catch(t){}}else{window.top.postMessage({name:"iframe_url_changed"},"*")}},initializeMachines:function(){this.gui=new c;if(config.callback_widget&&!this.cw&&!this.isMobileOrTablet()){this.initCallWidget()}this.soundPlayer=soundPlayer;this.soundPlayer.initialize(document.getElementById("jivo_top_wrap"));if(config["form_observer"]&&!this.isSeparateWindow()){new v}},_changeBrowserLocation:function(e,t,i){var n=i||window;if(typeof n.parent.history.pushState==="function"){n.parent.history.pushState({},t,e)}},_newSession:function(){cookie("sess_id",null);if(!this.isSeparateWindow()){if(config.chat_mode==="offline"){if(utils.hideOffline()){f.gui.transition("INVISIBLE");this.transition("HIDDEN");return}}if(config.options&16){this.transition("INIT_RULE_MANAGER");return}if(config.chat_mode==="online"){if(this.isVisitorsInsight()){n.handle("startup")}this.transition("ONLINE")}else{this.transition("OFFLINE")}}if(!f.isMobileOrTablet()){this.gui.showWidget()}},_listenMessages:function(e){log("JIVO: listening for window messages");if("addEventListener"in window){window.addEventListener("message",underscore.bind(this._windowMessage,this,e),false)}else if("attachEvent"in window){window.attachEvent("message",underscore.bind(this._windowMessage,this,e))}},_windowMessage:function(e,t){this.handle([e,t.data.action].join("_"),t)},isVisitorsInsight:function(){return config.visitors_insight===1},isMobile:function(){return devicejs.mobile()},isTablet:function(){return devicejs.tablet()},isMobileOrTablet:function(){return this.isMobile()||this.isTablet()},isAndroid:function(){return devicejs.android()},isAndroid4old:function(){var e=navigator.userAgent,t,i=false;if(e.indexOf("Android")>=0){t=parseFloat(e.slice(e.indexOf("Android")+8));if(t===4||t===4.1||t===4.2){i=true}}return i},isWixIframe:function(){return typeof this.getPageWindow().jivo_in_wix_iframe!=="undefined"},isSeparateWindow:function(){return typeof jivo_newWindow!=="undefined"},isBitrix:function(){var e=document.cookie.split(";"),t=false;underscore.each(e,function(e){if(e.indexOf("BITRIX_")>=0){t=true}},this);if(t){telemetry("Bitrix Skip Iframe")}return t},getCallWidget:function(){return this.cw&&this.cw.callwidget},initCallWidget:function(){var e={currentState:"",position:{top:0,left:0},seconds:config.callback_widget,initTimer:config.callback_widget,agent_info:""};if(this.resumed_context&&this.resumed_context.client_info.cw_call){e.currentState=f.resumed_context.client_info.cw_call.status;if(e.currentState==="cw_call_end"||e.currentState==="cw_error")e.currentState="CLOSED";e.agent_info=this.resumed_context.agent_info}else{e.agent_info=null}if(e.currentState){if(underscore.indexOf(["cw_connected","cw_connecting","cw_error","cw_call_end"],e.currentState)!==-1){e.initialState="CALL";e.priorAction=e.currentState}else{e.initialState="WAIT";e.priorAction=e.currentState}}if(e.currentState==="CLOSED"){e.initialState="CLOSED"}if(!this.cw)this.cw={};this.cw.callwidget=new b(e);log("jivo.js init cw")},createMagicIFrame:function(){if(!this.isMobile()&&!this.isTablet()&&!this.isSeparateWindow()&&!this.isWixIframe()&&!this.isBitrix()){_.create()}},_callUserFunction:function(e,t){e="jivo_"+e;if(typeof window.parent.window[e]==="function"){try{log("JIVO: calling user function "+e);window.parent.window[e](t);log("JIVO: user function "+e+" returned")}catch(i){}}},_sendIntroduce:function(e){if(e.isEmailSubmitted){p.trackSystemMessageEmailSubmitted()}n.sendIfConnected({name:"introduction",client_name:e.name,phone:e.phone,email:e.email});this._saveClientInfo(e)},_saveClientInfo:function(e){underscore.each(["name","phone","email"],function(t){if(t in e&&e[t]!==""){if(t==="name"){cookie("client_name",e[t],{expires:365,path:"/"})}else{cookie(t,e[t],{expires:365,path:"/"})}}})},_chatAccepted:function(){p.trackChatConnected();this._callUserFunction("onAccepted")},transferProportion:function(e){this._callUserFunction("onResizeCallback",e)},getCurrentPage:function(){log("jivo.getCurrentPage",this._forcedCurrentPage,window.location.href,document.title);if(this._forcedCurrentPage){return this._forcedCurrentPage}var e=this.getPageWindow();return{url:e.location.href,title:setSubstrTitle(e.document.title)}},getPageWindow:function(){return window.parent||window},getChatHeight:function(){if(this.isMobileOrTablet()){return document.getElementById("jivo-chat").offsetHeight}else{return parseInt(f.gui.jivoframecontainer.getOnlineFormHeight())}},_stripHashFromLocation:function(e,t){var i=t||window;if(i.location.href.indexOf("#jvhs_"+e)>0){this._changeBrowserLocation(i.location.href.replace("#jvhs_"+e,""),document.title,i)}},pageVisible:function(){log("pageVisible");if("visibilityState"in document){return document.visibilityState==="visible"}else if("webkitVisibilityState"in document){return document.webkitVisibilityState==="visible"}return false},_listenVisibility:function(){log("Installing visibility event handler");var e,t,i;if(typeof document.hidden!=="undefined"){e="hidden";i="visibilitychange";t="visibilityState"}else if(typeof document.mozHidden!=="undefined"){e="mozHidden";i="mozvisibilitychange";t="mozVisibilityState"}else if(typeof document.msHidden!=="undefined"){e="msHidden";i="msvisibilitychange";t="msVisibilityState"}else if(typeof document.webkitHidden!=="undefined"){e="webkitHidden";i="webkitvisibilitychange";t="webkitVisibilityState"}if("addEventListener"in document&&typeof i!=="undefined"){document.addEventListener(i,underscore.bind(this._visibleHandler,this,t),false)}else{this.checkVisibilityAPI=false}},_visibleHandler:function(e){this.handle("window_"+document[e]);n.updateClient({page_visible:this.pageVisible()})},_isBlacklisted:function(){var e=cookie("client_id");return e&&e.indexOf("z")===0},_sendRate:function(e,t){var i={jv_sess_id:t,r:e};getJSONPWithData(config.base_url+"/script/rate/"+config.widget_id,i,function(e){log("Rate result",e)})},handleGuiTransition:function(e){log("handleGuiTransition",e);if(e.toState==="WIDGET"){this._callUserFunction("onClose")}else if(e.toState==="CHAT"){this._callUserFunction("onOpen")}},callWidgetEvents:function(e,t){log("callWidgetEvents",e,t);if(e.lastIndexOf("cw_",0)===0){log(e,this.state,underscore.toArray(arguments));if(!this.cw){log("JIVO: Call widget not initialized.")}else{if(e==="cw_cancel_call"){n.send({name:e});return}if(e==="cw_call"){n.send({name:e,tel:t.tel,invitation_text:t.invitation_text||false})}else if(e==="cw_ping"){cookie("chat_call",null);n.send({name:e,title:underscore.toArray(arguments)[1]||false})}else{if(cookie("chat_call")==1&&e!="cw_call_end"&&e!="cw_error"){var i=underscore.toArray(arguments);window.chat_contents.handle.apply(window.chat_contents,i)}else{this.emit.apply(this,underscore.toArray(arguments))}}}}else{if(this.resumed_context&&this.resumed_context.client_info.cw_call&&cookie("chat_call")==1&&!this.resumed_context.agent_info){this.gui.transition("CHAT");window.chat_contents.handle(this.resumed_context.client_info.cw_call.status)}}},updateHeight:function(e){if("update_height"===e&&this.gui){this.gui.handle.apply(this.gui,underscore.toArray(arguments))}},getTextColor:function(){if(config.widget_font_color=="dark"){return"#222222"}else{return"#F0F1F1"}},"*":function(e,t){this.updateHeight(e,t);log(this.namespace+": unhandled "+e+" in state "+this.state)},states:{uninitialized:{"window.loaded":function(){if(!cookie("enter_ts")){cookie("enter_ts",(new Date).getTime());var e=this.getPageWindow();if(e.document.referrer){cookie("refer",e.document.referrer);setUTMParams(e.location.href)}var t=cookie("visits_count")-0;cookie("visits_count",!t?1:t+1,{expires:365,path:"/"})}p.findYaCounter();if(this.isSeparateWindow()){this._listenVisibility();var i=getURLParam("url");var n=getURLParam("title");if(i&&n){this._forcedCurrentPage={url:i,title:setSubstrTitle(n)}}var o=getURLParam("client_id");if(o){cookie("client_id",o)}var a=getURLParam("sess_id");config.chat_mode=a?"online":"offline";this.initializeMachines();if(a){cookie("sess_id",a,{expires:1,path:"/"});this.transition("CHECKING_SESSION")}else{this.transition("OFFLINE")}}else if(this._isBlacklisted()||this.isMobileOrTablet()&&config.disable_mobile){this.transition("HIDDEN")}else{this.transition("LOADING_CSS")}}},LOADING_CSS:{_onEnter:function(){if(document.createStyleSheet){document.createStyleSheet(staticUrl("/css/main.css"));if(ie8){document.createStyleSheet(staticUrl("/css/label-ie8.css"));document.createStyleSheet(staticUrl("/css/chat-ie8.css"))}if(devicejs.windowsPhone()){document.createStyleSheet(staticUrl("/css/label-wp.css"))}if(config.callback_widget&&!this.isMobileOrTablet()){document.createStyleSheet(staticUrl("/css/call-widget.css"))}}else{var e=document.createElement("link");e.setAttribute("rel","stylesheet");e.setAttribute("href",staticUrl("/css/main.css"));var t=utils.browser;if(t.name==="Opera"||t.name==="Safari"&&t.mV<6&&!f.isMobile()||t.name==="Firefox"&&t.mV<12&&!f.isMobile()){var i=document.createElement("link"),n=document.createElement("link");i.setAttribute("rel","stylesheet");i.setAttribute("href",staticUrl("/css/label-ie8.css"));document.body.appendChild(i);n.setAttribute("rel","stylesheet");n.setAttribute("href",staticUrl("/css/chat-ie8.css"));document.body.appendChild(n)}document.body.appendChild(e);if(devicejs.windowsPhone()){var o=document.createElement("link");o.setAttribute("rel","stylesheet");o.setAttribute("href",staticUrl("/css/label-wp.css"));document.body.appendChild(o)}if(config.callback_widget&&!this.isMobileOrTablet()){var a=document.createElement("link");a.setAttribute("rel","stylesheet");a.setAttribute("href",staticUrl("/css/call-widget.css"));document.body.appendChild(a)}}var s=this.cssDetector=document.createElement("div");s.id="jivo_css_detector";s.style.visibility="hidden";s.style.position="absolute";document.body.appendChild(s);this._scheduleEvent("timer_css",100)},api_open:function(e){this.handle("gui_maximize",e)},gui_maximize:function(){this.isOpen=true},timer_css:function(){if(!(this.cssDetector.offsetWidth>0)){this._scheduleEvent("timer_css",100);return}this.initializeMachines();this.gui.on("transition",underscore.bind(this.handleGuiTransition,this));var e=window.location.hash.split("jvhs_");if(!underscore.isUndefined(e[1])){this.gui.highlight(e[1])}try{if(window.parent.window!=window.top){log("window.parent.window != window.top",window.parent.window!=window.top);try{if(window.top.jivo_magic_var===window.parent.window.jivo_magic_var&&!this.isWixIframe()){this.transition("IN_IFRAME");return}}catch(t){log(t)}if(!this.isWixIframe()){log("!this.isWixIframe");this.transition("HIDDEN");return}}}catch(t){log(t)}if(!this.isSeparateWindow()){this._listenVisibility();this._callUserFunction("onLoadCallback")}if(this.isMobileOrTablet()){this.gui.transition("WIDGET")}if(cookie("sess_id")){this.transition("CHECKING_SESSION")}else{this._newSession()}},gui_introduced:function(e){this._saveClientInfo(e)}},CHECKING_SESSION:{_onEnter:function(){var e=cookie("sess_id");var t=this.getCurrentPage();getJSONPWithData(chatServerUrl(e,config.site_id,config.widget_id),{name:"url_change",jv_widget_id:config.widget_id,title:setSubstrTitle(t.title),url:t.url},underscore.bind(this.handle,this,"check_session_response"));this._scheduleEvent("timer_check_session",4e3)},check_session_response:function(e){log("JIVO: Check session response",e);this._cancelEvent("timer_check_session");if(typeof e==="object"){if(e.result==="ok"){if(e.has_connection){if(this.pageVisible()){this.transition("RESUMING")}else{this.transition(config.chat_mode.toUpperCase());if(!f.isMobileOrTablet()){this.gui.showWidget(false,true)}}}else{this.transition("RESUMING")}return}}this._newSession()},timer_check_session:function(){reportException({message:"Check session Timeout"});this._newSession()}},RESUMING:{_onEnter:function(){n.resume(cookie("sess_id"))},resume_ok:function(e){log("resuming chat");this.resumed_context=e;var t=this.getCallWidget(),i;if(t&&cookie("chat_call")!=1){if(this.resumed_context.client_info.cw_call){i=this.resumed_context.client_info.cw_call.status;if(i==="cw_wait"){log("resume on cw_wait, handle_start_timer");t.handle("start_timer")}else{log("RESUMING.resume_ok callwidget handle status.",i);t.handle(i)}}else{t.handle("CLOSED")}}var n=e.client_info.msg_history;if(n&&n.length){n=e.client_info.msg_history=underscore.reject(n,function(e){return e.implicit})}if(n&&underscore.findWhere(n,{type:"clientMessage"})){this.createMagicIFrame()}var o=config.chat_mode.toUpperCase();if(n&&n.length>0){o="ONLINE";config.chat_mode="online"}else if(config.chat_mode=="offline"){if(utils.hideOffline()){f.gui.transition("INVISIBLE");this.transition("HIDDEN");return}}this.transition(o);if(this.isSeparateWindow()||!(this.isVisitorsInsight()&&n&&n.length===0)||e.agent_info||i){this.gui.handle("resume_ok",e)}else{this.transition("INIT_RULE_MANAGER")}if(this.isMobileOrTablet()&&!this.isSeparateWindow()){underscore.each(n,function(e){if(e.type==="agentMessage"&&!e.ack){this.gui.incrementCounter()}},this);if(!underscore.findWhere(n,{type:"agentMessage",ack:0})){this.gui.resetCounter()}}},resume_failed:function(){this._newSession()},gui_callwidget:function(){this.gui.showCallWidget()}},HIDDEN:{_onEnter:function(){if(window.parent.document){var e=window.parent.document.getElementById("jivo-iframe-container");if(e&&e.style){e.style.visibility="hidden";e.style.display="none";var t=window.parent.document.getElementById("jivo_custom_widget");if(t){t.style.display="none"}}}}},IN_IFRAME:{_onEnter:function(){log("IN_IFRAME",window.location.href,document.title);cookie("mframe",null);if(window.parent.window.parent.window.jivo){window.parent.window.parent.window.jivo.handle("iframe_url_change",window.location.href,document.title);f.gui.jivoframecontainer.element.style.visibility="hidden"}else{if(cookie("sess_id")){this.transition("CHECKING_SESSION")}else{this._newSession()}}},highlight_cobrowse:function(e){this.gui.highlight(e)},gui_introduced:function(e,t){this._sendIntroduce(e);if(!t){p.trackGaveContacts();this._callUserFunction("onIntroduction")}},gui_email_form_show:function(){p.trackSystemMessageEmailShown()},gui_close_cobrowse:function(e){this._stripHashFromLocation(e,window.parent)},"*":function(e){if(underscore.indexOf(["api_open","gui_message"],e)>=0){if(!window.parent.window.jivo){window.top.window.jivo.handle.apply(window.top.window.jivo,underscore.toArray(arguments))}else{window.parent.window.jivo.handle.apply(window.parent.window.jivo,underscore.toArray(arguments))}}else{log("JIVO: unhandled "+e+" in "+this.state)}}},INIT_RULE_MANAGER:{_onEnter:function(){log("INIT_RULE_MANAGER on enter.",s.isInited);if(s.isInited){this.handle("rule_manager_ready")}else{log("INIT_RULE_MANAGER init.");s.on("ready",underscore.bind(this.handle,this,"rule_manager_ready"));this.ruleManager=s;s.init()}},rule_manager_ready:function(){if(config.chat_mode==="online"){if(this.isVisitorsInsight()){n.handle("startup")}this.transition("ONLINE")}else{this.transition("OFFLINE")}if(this.isOpen){this.gui.showChat()}else{this.gui.showWidget()}},hide:"HIDDEN"},ONLINE:{_onEnter:function(){this.gui.setOnline();if(!chat_contents.isInit){chat_contents.init(config.chat_mode,this.open_params)}},api_open:function(e){this.handle("gui_maximize",e)},invitation:function(e,t){n.updateClient({chat_opened:true,page_visible:this.pageVisible(),proactive_rule:{invitation_text:e.invitationText,agent_id:t.agent_id}});p.trackProactiveInvitationShown(e.name);this.ruleName=e.name;this.invitationText=e.invitationText;this.agentInfo=t;this.gui.showInvitation(this.agentInfo,this.invitationText);cookie("collapsed",null);this.transition("PROACTIVE")},callback_invitation:function(e){var t=this.getCallWidget();if(t){t.handle("cw_show_form",{show_form:1,title:e.title})}p.trackCallWidgetInvitationShown(e.title)},highlight_cobrowse:function(e){this.gui.highlight(e)},gui_close_cobrowse:function(e){this._stripHashFromLocation(e)},gui_maximize:function(e){log("gui_maximize",e);this.openParams=e;if(this.isMobileOrTablet()&&!cookie("sess_id")){this.transition("STARTING_SESSION")}else{p.trackChatOpenedByClick();this.gui.showChat(true,this.openParams)}},gui_callwidget:function(){if(cookie("chat_call")===1){chat_view_online.getCallBackView().showForm()}else{this.gui.showCallWidget()}},gui_answer_proactive:function(){if(cookie("sess_id")){if(f.isTablet()){this.gui.openNewWindow()}else{this.gui.showChat(true,this.openParams)}}},gui_typing:function(e){n.sendIfConnected({name:"client_typing",typing:e})},gui_introduced:function(e,t){this._sendIntroduce(e);if(!t){p.trackGaveContacts();this._callUserFunction("onIntroduction")}},gui_email_form_show:function(){p.trackSystemMessageEmailShown()},gui_message:function(e,t){this.createMagicIFrame();var i={name:"client_message",message:e};if(t){i=underscore.extend(i,t)}if(this.department_id){i.widget_department_id=this.department_id;this.department_id=null}n.send(i);if(!i.implicit){this.gui.handle("gui_message",e)}},gui_department:function(e){this.department_id=e},gui_typing_insight:function(e){n.sendIfConnected({name:"client_service_message",service:"typing_insight",event:"input_changed",new_val:e})},gui_minimize:function(){log("gui_minimize");u.stopBlink();this.gui.showWidget(true)},gui_decline_file:function(e,t){u.stopBlink();n.send({name:"client_service_message",service:"file_transfer",file_id:e,file_name:t,event:"file_declined"})},gui_receive_file:function(e,t){u.stopBlink();n.send({name:"client_service_message",service:"file_transfer",file_id:e,file_name:t,event:"file_received"})},gui_accept_cobrowse:function(e,t){log("gui_accept_cobrowse",e,t);u.stopBlink();var i=window.parent.document.location.href.split("#")[0];var n=e+"#jvhs_"+t;var o=window.parent.document.getElementById("jivo_magic_iframe");if(i===e||i===encodeURI(e)){try{var a=window;if(o){a=o.contentWindow}a.jivo_api.highlightCobrowse(t)}catch(s){log(s.toString());return}this._changeBrowserLocation(n,document.title)}else{if(this.isMobileOrTablet()){window.open(n,document.title)}else{if(o){log("magicIFrame navigate",n);_.navigate(n)}else{window.parent.document.location.href=n}}}},gui_evaluation:function(e,t){this._sendRate(e,t)},agent_chat_close:function(e){this.invitationText=this.agentInfo=false;this.gui.handle("agent_chat_close",e)},gui_msg_input_focus:function(){u.stopBlink()},"*":function(e,t){log("jivoOnline",e,t);if(!this.isMobileOrTablet()){this.callWidgetEvents(e,t)}if(underscore.indexOf(["agent_message","agent_service_message","system_message","system_message_email","agent_typing","accept","gui_resume","update_height","transferred","update_agent_info","blacklist","cw_show_form","cw_connected","cw_connecting","cw_call_end","cw_error"],e)>=0){if(underscore.indexOf(["agent_message","agent_service_message"],e)>=0){u.startBlink();if(this.isVisitorsInsight()&&t.msg_id&&t.msg_id===1&&!this.invitationText&&config.contacts_ask===1){this.invitationText=t.message}}log("gui apply",underscore.toArray(arguments));this.gui.handle.apply(this.gui,underscore.toArray(arguments));if(e==="accept"){this._chatAccepted()}}else{log("JIVO: unhandled "+e+" in "+this.state)}},iframe_url_change:function(e,t){log("iframe_url_change",e,t);this._changeBrowserLocation(e,t);n.sendIfConnected({name:"url_change",url:e,title:setSubstrTitle(t)})},reopened_elsewhere:function(){log("reopened_elsewhere");u.stopBlink();if(!f.isMobile()&&!(f.isTablet()&&$(".connectionError").length>0)){this.gui.showWidget(false,true)}},connect_failed:function(){this._forcedOffline="connect_failed";this.transition("OFFLINE");this.gui.handle("connect_failed")},force_offline:function(e){this._forcedOffline=e.err_code?e.err_code:e.name;this.transition("OFFLINE");this.gui.handle("connect_failed",e)},window_visible:function(){if(!n.isConnected()&&cookie("sess_id")){this.transition("CHECKING_SESSION")}},gui_start_call:function(){n.send({name:"request_call",want_call:1})},gui_agent_message_ack:function(e){log("jivo online gui_agent_message_ack");n.sendIfConnected({name:"agent_message_ack",ack_msg_ids:e})},gui_leave_msg:function(){this.gui.handle("gui_leave_msg")}},OFFLINE:{_onEnter:function(){u.stopBlink();this.gui.setOffline();chat_contents.init(config.chat_mode,this.open_params)},callback_invitation:function(e){var t=this.getCallWidget();if(t){t.handle("cw_show_form",{show_form:1,title:e.title})}p.trackCallWidgetInvitationShown(e.title)},gui_maximize:function(){p.trackOfflineFormOpenedByClick();if(!f.isMobile()){removeClass(f.gui.jivoframecontainer.element,"jivo-no-transition")}this.gui.showChat(true)},gui_minimize:function(){this.gui.showWidget(true)},gui_callwidget:function(){this.gui.showCallWidget()},gui_offline_message:function(e){this._saveClientInfo(e);n.send({name:"offline_message",message:e.message,email:e.email,phone:e.phone,client_name:e.name,cap_symbols:e.cap_symbols,from_online:this._forcedOffline});this.transition("OFFLINE_WAIT")},gui_leave_msg:function(){this.gui.handle("gui_leave_msg")},api_open:function(){this.handle("gui_maximize")},window_visible:function(){var e=this.getCallWidget();if(!n.isConnected()&&cookie("sess_id")){this.transition("CHECKING_SESSION")}else if(!cookie("sess_id")&&this.gui.state==="CALLWIDGET"&&underscore.indexOf(["CALL","WAIT"],e.state)!==-1){e.handle("cw_call_end")}},blacklist:function(){this.gui.handle("blacklist")},"*":function(e,t){this.callWidgetEvents(e,t);this.updateHeight(e,t)}},OFFLINE_WAIT:{_onEnter:function(){this._scheduleEvent("message_timer",parseInt("5000")*1e3||5e3)},offline_ack:function(e){this._cancelEvent("message_timer");if(e.result==="ok"){p.trackOfflineMessageSent();this.gui.handle("offline_success");this.transition("OFFLINE");return}else if(e.result==="error"){if("cap_id"in e){this.gui.handle("offline_captcha",e);this.transition("OFFLINE");return}}this.gui.handle("offline_failed");this.transition("OFFLINE")},message_timer:function(){this.gui.handle("offline_failed");this.transition("OFFLINE")}},PROACTIVE:{gui_minimize:function(){p.trackProactiveInvitationRejected(this.ruleName);this.gui.showWidget(true);this.transition("ONLINE")},gui_message:function(e,t){this.createMagicIFrame();p.trackProactiveInvitationAccepted(this.ruleName);cookie("agent_info",[this.agentInfo.agent_id].join("$$"));if(this.isMobileOrTablet()){return}var i={name:"client_message",message:e};if(t){i=underscore.extend(i,t)}n.send(i);if(!i.implicit){this.gui.handle("gui_message",e);this.transition("ONLINE")}},gui_answer_proactive:function(){this.transition("STARTING_SESSION")},gui_maximize:function(){if(this.isMobileOrTablet()){p.trackProactiveInvitationAccepted(this.ruleName);this.transition("STARTING_SESSION")}},gui_introduced:function(e,t){this._sendIntroduce(e);if(!t){p.trackGaveContacts();this._callUserFunction("onIntroduction")}},window_visible:function(){if(!n.isConnected()&&cookie("sess_id")){this.transition("CHECKING_SESSION")}},api_open:function(e){this.transition("ONLINE");this.handle("api_open",e)},accept:function(){this.transition("ONLINE");this._chatAccepted()},cw_ping:function(e,t){cookie("chat_call",null);this.transition("ONLINE");n.sendIfConnected({name:"cw_ping",title:underscore.toArray(arguments)[1]||false})},cw_call:function(e){this.callWidgetEvents("cw_call",e);this.transition("ONLINE")},gui_agent_message_ack:function(e){n.sendIfConnected({name:"agent_message_ack",ack_msg_ids:e})}},STARTING_SESSION:{_onEnter:function(){log("STARTING_SESSION _onEnter");n.handle("startup")},startup_ok:function(){this.transition("ONLINE");this.gui.showChat(true,this.openParams)
},gui_maximize:function(e){this.gui.showChat(true,e)}}}});var h=i.extend({namespace:"JIVOFRAMECONTAINER",JIVOFRAMECONTAINER_ID:"jivo-iframe-container",expandTo:false,TIMEOUT_TRANSITION:300,TIMEOUT_TRANSITION_DEBOUNCE:1,INPUT_MARGIN:10,INPUT_HEIGTH:32,MESSAGE_OFFLINE_HEIGHT:109,BUTTONS_HEIGHT:32,HEADER_OFFLINE_HEIGHT:60,INNER_PADDING:10,ADWORD_HEIGHT:30,MESSAGE_ONLINE_HEIGHT:84,HEADER_ONLINE_HEIGHT:70,AVATAR_MARGIN:20,MIN_HEIGHT:410,DESCRIPTION_MARGIN:20,initialize:function(){var e=this.element=window.parent.document.getElementById(this.JIVOFRAMECONTAINER_ID),t=this.innerChat=document.getElementById("inner-chat"),i=this.callbackContainer=document.getElementById("jivo-form-container"),n=this.chatDiv=document.getElementById("jivo-chat"),o=this.jivoLeaf=document.getElementById("jivo-css-leaf"),a=this.widgetHeight=e.offsetHeight,s=this.widgetWidth=e.offsetWidth,r=this.widgetMarginBottom=e.style.marginBottom;addClass(n,"jivo-orientation-"+config.widget_orientation);prefixedEvent(e,"TransitionEnd",underscore.bind(this.handle,this,"animate_finished"));if(ie8){addClass(this.element,"jivo-ie8");this.element.style.borderColor=config.widget_color;this.element.style.backgroundColor=config.widget_color}else if(devicejs.windowsPhone()){addClass(this.element,"jivo-wp")}if(e.style){e.style.visibility="visible";e.style.display="block"}},initialState:"INITIALIZED",setHeight:function(e){this.element.style.height=e},setWidth:function(e){this.element.style.width=e},getOfflineFormHeight:function(){var e=this.getOfflineDescriptionHeight();e+=this.MESSAGE_OFFLINE_HEIGHT+2*this.INNER_PADDING;if(config.contacts_settings.email.show||!config.contacts_settings.phone.show||!config.contacts_settings.phone.required){e+=this.INPUT_HEIGTH+this.INPUT_MARGIN}if(config.contacts_settings.name.show){e+=this.INPUT_HEIGTH+this.INPUT_MARGIN}if(config.contacts_settings.phone.show){e+=this.INPUT_HEIGTH+this.INPUT_MARGIN}e+=this.BUTTONS_HEIGHT;if(config.contacts_settings.email.show&&config.contacts_settings.phone.show&&!config.contacts_settings.name.show){e-=this.INPUT_MARGIN}if(!(config.options&8&&config.hide_ad)){e+=this.ADWORD_HEIGHT}e+=this.INNER_PADDING;e+=this.HEADER_OFFLINE_HEIGHT;return e+"px"},getOfflineDescriptionHeight:function(){var e=document.createElement("div"),t;e.style.position="absolute";e.style.fontSize="16px";e.style.fontFamily="Arial, sans-serif";e.style.lineHeight="19px";e.style.visibility="hidden";e.style.width="260px";if(chat_view_offline&&chat_view_offline.getFormView()){var i=chat_view_offline.getFormView().model;e.innerHTML=i.get("templateData.text")||i.get("templateData").text}window.parent.document.body.appendChild(e);t=e.offsetHeight+this.DESCRIPTION_MARGIN+5;window.parent.document.body.removeChild(e);return t},getOnlineFormHeight:function(e){var t=this.MESSAGE_ONLINE_HEIGHT+this.INPUT_MARGIN;if(config.contacts_settings.email.show){t+=this.INPUT_HEIGTH+this.INPUT_MARGIN}if(config.contacts_settings.name.show){t+=this.INPUT_HEIGTH+this.INPUT_MARGIN}if(config.contacts_settings.phone.show){t+=this.INPUT_HEIGTH+this.INPUT_MARGIN}if(config.departments){t+=this.INPUT_HEIGTH+this.INPUT_MARGIN}if(!(config.options&8&&config.hide_ad)){t+=this.ADWORD_HEIGHT}t+=2*this.INNER_PADDING;t+=this.HEADER_ONLINE_HEIGHT;t+=this.BUTTONS_HEIGHT;t+=this.AVATAR_MARGIN;if(e){return t+"px"}else{return Math.max(this.MIN_HEIGHT,t)+"px"}},setTransition:function(e){toggleClass(this.element,"jivo-no-transition",!e);return this},animate:function(e,t){var i=this.getChatPosition(),n=this.element.style;if(this.expandTo){i.height=parseInt(this.expandTo)+"px";this.expandTo=false}if(e==="expand"){n.width="300px"}log("JIVOFRAMECONTAINER animate",e,this.expandTo,i.height);switch(config.widget_orientation){case"left":if(e==="expand"){n.marginLeft="30px";n.top="";n.bottom="0px";n.left=i.left;n.height=i.height;n.marginBottom="0"}else if(e==="collapse"){n.marginLeft="0";n.left="0";n.marginBottom=this.widgetMarginBottom;if(config.widget_padding=="0"){n.bottom="100%"}else if(config.widget_padding=="50"){n.bottom="50%"}else if(config.widget_padding=="100"){n.bottom="10px"}n.height=f.gui.widget.widgetHeight;n.width=this.widgetWidth+"px"}break;case"right":if(e==="expand"){n.marginRight="30px";n.marginBottom="0";n.top="";n.bottom="0px";n.right=i.right;n.height=i.height}else if(e==="collapse"){n.marginRight="0";n.left="auto";n.right="0";n.marginBottom=this.widgetMarginBottom;if(config.widget_padding=="0"){n.bottom="100%"}else if(config.widget_padding=="50"){n.bottom="50%"}else if(config.widget_padding=="100"){n.bottom="10px"}n.height=f.gui.widget.widgetHeight;n.width=this.widgetWidth+"px"}break;case"top":if(e==="expand"){n.top="auto";n.bottom="0";n.height=i.height;n.marginBottom="0";if(config.widget_padding=="0"){n.left=i.left}else if(config.widget_padding=="50"){n.margin="";if(!i.left&&!i.right){n.right="30px"}else{n.right=i.right}}else if(config.widget_padding=="100"){n.right=i.right}}else if(e==="collapse"){n.bottom="100%";n.marginBottom="-34px";if(config.widget_padding=="0"){n.right="";n.left="30px"}else if(config.widget_padding=="50"){n.left="";n.marginRight=this.widgetWidth/2*-1+"px";n.right=config.widget_padding+"%"}else if(config.widget_padding=="100"){n.left="";n.right="30px"}n.height=this.widgetHeight+"px";n.width=f.gui.widget.widgetWidth}break;case"bottom":if(e==="expand"){n.height=parseInt(i.height)+"px";if(config.widget_padding=="0"){n.left=i.left}else if(config.widget_padding=="50"){if(!i.left&&!i.right){n.right="30px";n.marginRight=""}else{n.right=i.right;n.margin=""}}else if(config.widget_padding=="100"){if(i.right){n.right=i.right}}}else if(e==="collapse"){if(config.widget_padding=="0"){n.right="";n.left="30px"}else if(config.widget_padding=="50"){n.left="";n.marginRight=this.widgetWidth/2*-1+"px";n.right=config.widget_padding+"%"}else if(config.widget_padding=="100"){n.left="";n.right="30px"}n.height=this.widgetHeight+"px";n.width=f.gui.widget.widgetWidth}break}f.transferProportion({width:parseFloat(n.width),height:parseFloat(n.height)});this._scheduleEvent("animate_finished",this.TIMEOUT_TRANSITION);if(t){setTimeout(function(){t()},this.TIMEOUT_TRANSITION)}},getChatPosition:function(){var e={};if(config.chat_mode==="online"&&f.gui.mode!="offline"&&!chat_view_offline.getFormView()){if(cookie("left")){e.left=cookie("left")}if(cookie("right")){e.right=cookie("right")}if(cookie("height")){e.height=parseInt(cookie("height"))+"px";if(parseInt(cookie("height"))<215)e.height=215+"px"}else{e.height="410px"}log("getChatPosition",config.contacts_ask==1&&!f.invitationText&&$("#introduce-form").css("display")=="block");if(config.contacts_ask==1&&!f.invitationText&&$("#introduce-form").css("display")=="block"){e.height=this.getOnlineFormHeight()}}else if(config.chat_mode==="offline"||f.gui.mode==="offline"||chat_view_offline.getFormView()){e.height=this.getOfflineFormHeight()}if(f.isTablet()&&!f.isSeparateWindow()){e.height="350px"}return e},states:{EXPANDED:{_onEnter:function(){this._scheduleEvent("reset",this.TIMEOUT_TRANSITION);this._cancelEvent("animate_finished");this.emit("expanded")},reset:"INITIALIZED"},COLLAPSED:{_onEnter:function(){switch(config.widget_orientation){case"top":{this.element.style.top="0";this.element.style.marginBottom="";break}}this.handle("reset");this._cancelEvent("animate_finished");this.emit("collapsed")},reset:"INITIALIZED"},INITIALIZED:{_onEnter:function(){log("JIVO_CONTAINER INITIALIZED")},expand:function(){this.animate("expand");this.transition("EXPANDING")},collapse:function(e){this.animate("collapse",e);this.transition("COLLAPSING")}},EXPANDING:{animate_finished:"EXPANDED"},COLLAPSING:{animate_finished:"COLLAPSED"}}});var g=i.extend({namespace:"JIVO_LABEL_BUTTONS",JIVO_LABEL_BUTTONS_ID:"jivo-label-buttons",initialState:"HIDDEN",copyright_disabled:false,enabled:false,initialize:function(){this._templateData={orientation:config.widget_orientation,chat_button_text:this.getButtonText(),seconds:config.callback_widget,text_seconds:this.getTextSeconds(config.callback_widget)};if(!utils.showAd()){this.copyright_disabled=true}this._widgetContainer=window.parent.document.getElementById("jivo-iframe-container");this._widgetHeight=parseFloat(config.widget_height);this._widgetWidth=this._widgetContainer.offsetWidth;this._label=document.getElementById("jivo-label");var e=this.element=document.createElement("div"),i=document.createElement("div");e.innerHTML=t.label_buttons(this._templateData);e.id=this.JIVO_LABEL_BUTTONS_ID;e.style.display="none";document.body.appendChild(e);this._innerLabelWrapper=document.getElementById("jivo-label-inner-wrapper");this._showCallText=document.getElementById("jivo-show-callme-text");this._showChatText=document.getElementById("jivo-show-chat-text");i.setAttribute("id","jivo-label-buttons-corner");i.setAttribute("class","jivo-"+config.widget_orientation);e.setAttribute("class","jivo-"+config.widget_orientation);addClass(this.element,config.widget_font_color);switch(config.widget_orientation){case"top":i.style.borderBottomColor=config.widget_color;break;case"left":i.style.borderRightColor=config.widget_color;break;case"right":i.style.borderLeftColor=config.widget_color;break;case"bottom":i.style.borderTopColor=config.widget_color;break}e.style.backgroundColor=config.widget_color;e.appendChild(i);var n=f.getTextColor();this._showChatText.style.color=n;this._showCallText.style.color=n;this._showCallText.onclick=underscore.bind(this.handle,this,"showCallWidget")},getButtonText:function(){if(config.chat_mode==="online"){return translate("cw_typeInChat")}else{return translate("lblLeaveMessage")}},getTextSeconds:function(e){var t=[translate("cw_form_second"),translate("cw_form_seconds"),translate("cw_form_secondd")],i=[2,0,1,1,1,2];return t[e%100>4&&e%100<20?2:i[e%10<5?e%10:5]]},enable:function(){this.enabled=true;if(!f.isMobile()){this._innerLabelWrapper.onmouseover=underscore.bind(this.handle,this,"label_text_mouseover");this._innerLabelWrapper.onmouseout=underscore.bind(this.handle,this,"label_text_mouseout");this.element.onmouseover=underscore.bind(this.handle,this,"label_buttons_mouseover");this.element.onmouseout=underscore.bind(this.handle,this,"label_buttons_mouseout")}},disable:function(){this._innerLabelWrapper.onmouseover=null;this._innerLabelWrapper.onmouseout=null;this.element.onmouseover=null;this.element.onmouseout=null;this.enabled=false;this.handle("hide")},getPopoverSize:function(){var e=getElementPosition(document.getElementById(this.JIVO_LABEL_BUTTONS_ID));return{width:e.width,height:e.height}},getPopoverPosition:function(e){var t=getElementPosition(e),i=getElementPosition(document.getElementById(this.JIVO_LABEL_BUTTONS_ID)),n={top:0,left:0},o;switch(config.widget_orientation){case"left":o=10;n={bottom:0,left:t.left+t.width+o};if(ie8){n={top:t.top+100,left:t.left+t.width+10}}break;case"right":o=config.iconLocale==="en"?80:60;n={bottom:0,right:i.width-o};break;case"top":n={top:t.top+(t.height+15),left:t.left+40};break;case"bottom":n={bottom:t.height+10,left:0};break}return n},states:{VISIBLE:{_onEnter:function(){log("VISIBLE BUTTONS");if(!this.copyright_disabled){f.gui.copyright.transition("HIDDEN");f.gui.copyright.jivo_copyright.style.display="none"}addClass(this._widgetContainer,"jivo-no-transition");removeClass(this._widgetContainer,"jivo-state-widget-collapsed");addClass(this._widgetContainer,"jivo-state-widget-expanded");addClass(this._label,"jivo-grey-opacity");this.element.style.display="block";this._widgetContainer.style.width=f.gui.jivoframecontainer.widgetWidth;var e=this.getPopoverPosition(document.getElementById("jivo-label")),t=this.getPopoverSize(),i;switch(config.widget_orientation){case"left":case"right":i=50;this._widgetContainer.style.width=this._widgetWidth+t.width+i+"px";break;case"top":case"bottom":i=20;this._widgetContainer.style.height=this._widgetHeight+t.height+i+"px";break}switch(config.widget_orientation){case"left":this.element.style.left=e.left+"px";break;case"right":this.element.style.right="50px";break;case"bottom":this.element.style.left="0px";break;case"top":this.element.style.right="0px";break}if(typeof e.bottom!="undefined"){this.element.style.bottom=e.bottom+"px"}else{this.element.style.top=e.top+"px"}},hide:"HIDDEN",label_text_mouseover:function(){this._cancelEvent("hide")},label_text_mouseout:function(){this._scheduleEvent("hide",700)},label_buttons_mouseover:function(){this._cancelEvent("hide")},label_buttons_mouseout:function(){this._scheduleEvent("hide",700)},showCallWidget:function(){callWidgetPing(function(e){if(e.show_form==1){f.handle("gui_callwidget")}else{f.gui.labelButtons.disable()}})}},HIDDEN:{_onEnter:function(){log("HIDDEN BUTTONS");removeClass(this._widgetContainer,"jivo-state-widget-expanded");addClass(this._widgetContainer,"jivo-state-widget-collapsed");this.element.style.display="none";removeClass(this._label,"jivo-grey-opacity");if(f.gui&&f.gui.state=="CALLWIDGET"){return}switch(config.widget_orientation){case"left":case"right":this._widgetContainer.style.width=this._widgetWidth+"px";break;case"top":case"bottom":this._widgetContainer.style.height=this._widgetHeight+"px";break}},show:"VISIBLE",label_text_mouseover:function(){this.transition("VISIBLE")}}}});var p={_yaCounter:false,_trackedEvents:[],_trackEvent:function(e,t){if(underscore.indexOf(this._trackedEvents,e)>=0){return}this._trackedEvents.push(e);log("ANALYTICS _trackEvent: "+e+"/"+t);var i=f.getPageWindow();if(typeof i._gaq!=="undefined"){i._gaq.push(["_trackEvent","JivoSite",e,t,undefined,true])}if(typeof i.ga==="function"){i.ga("send","event","JivoSite",e,t,{nonInteraction:1})}if(this._yaCounter){e=["Jivo"].concat(e.split(" ")).join("_");f.getPageWindow()[this._yaCounter].reachGoal(e)}},_setCustomVar:function(e,t){log("ANALYTICS _setCustomVar: "+e+"/"+t);var i=f.getPageWindow();if(typeof i._gaq!=="undefined"){i._gaq.push(["_setCustomVar",1,e,t,1])}if(typeof i.ga==="function"){i.ga("set",e,t)}if(this._yaCounter){var n={};n[e]=t;i[this._yaCounter].params(n)}},findYaCounter:function(){try{var e=f.getPageWindow();for(var t in e){if(t.indexOf("yaCounter")==0&&typeof e[t].reachGoal=="function"){this._yaCounter=t}}}catch(i){log("ANALYTICS: "+i.toString())}},trackChatOpenedByClick:function(){this._trackEvent("Chat requested","User clicked chat widget")},trackOfflineFormOpenedByClick:function(){this._trackEvent("Offline form shown","User offline form")},trackOfflineMessageSent:function(){this._trackEvent("Offline message sent","User sent message via offline form")},trackProactiveInvitationShown:function(e){this._trackEvent("Proactive invitation shown",e)},trackProactiveInvitationAccepted:function(e){this._trackEvent("Proactive invitation accepted",e)},trackProactiveInvitationRejected:function(e){this._trackEvent("Proactive invitation rejected",e)},trackChatConnected:function(){this._trackEvent("Chat established","User connected to agent")},trackGaveContacts:function(){this._trackEvent("User gave contacts during chat","User gave contacts during chat")},trackCallWidgetInvitationShown:function(e){this._trackEvent("Callback invitation shown",e)},trackCallWidgetRequested:function(e){this._trackEvent("Callback requested",e)},setABTestGroupContacts:function(e,t){this._setCustomVar(e,t)},trackSystemMessageEmailShown:function(){this._trackEvent("In-chat email form shown","In-chat email form shown.")},trackSystemMessageEmailSubmitted:function(){this._trackEvent("In-chat email form submitted","In-chat email form submitted.")}};var m=window.jivo_api=window.parent.jivo_api={open:function(e){var t=f.getCallWidget(),i=f.getPageWindow();if(typeof e==="object"&&e.start==="call"&&t){callWidgetPing(underscore.bind(function(i){if(i.show_form&&f.gui.state==="WIDGET"){f.handle("gui_callwidget")}else{f.handle("api_open",e)}t.analyticsTitle="apiCall"},this),{title:false,invitation:"jivo_api.open"})}else{cookie("collapsed",null);f.handle("api_open",e)}if(i.jivo_cstm_widget&&f.isMobile()&&!f._isBlacklisted()){i.jivo_cstm_widget.style.display="block"}},getContactInfo:function(){var e={};underscore.each(utils.fields,function(t){if(cookie(t)){e[t==="client_name"?"name":t]=cookie(t)}});return e},getVisitorNumber:function(e){var t=cookie("client_id");if(t&&t.indexOf(".")>0&&typeof e==="function"){setTimeout(function(){e(null,t.split(".").shift())},0);return}getJSONPWithData(chatServerUrl(config.widget_id,config.site_id),{name:"visitor_number"},function(t){if(typeof t==="object"&&t.result&&"client_id"in t){cookie("client_id",t.client_id,{expires:365,path:"/"});if(typeof e==="function"){e(null,t.client_id.split(".").shift());return}e(new Error("Error fetching visitor number"))}})},setUserToken:function(e){if(typeof e==="string"||e instanceof String){n.setUserToken(e)}},setCustomData:function(e){if(Object.prototype.toString.call(e)==="[object Array]"){n.setCustomData(e)}},sendMessage:function(e,t){if(Object.prototype.toString.call(e)==="[object Object]"){setImplicitGuiMessage(e,t+" \n")}},setContactInfo:function(e){if(e&&typeof e==="object"){for(var t in e){var i=e[t],n={},o=false;if(underscore.find(utils.fields,function(e){return e==="client_name"?t==="name":e===t})&&!cookie(t==="name"?"client_name":t)&&utils["isValidValue_"+t](i)){n[t]=i;o=true}if(o){f.handle("gui_introduced",n,true)}}}},showProactiveInvitation:function(e,t){s.showProactive(e,t,"jivo_api.showProactiveInvitation")},highlightCobrowse:function(e){f.handle("highlight_cobrowse",e)},setRules:function(e){if(e&&typeof e==="object"){config.rules=e}},chatMode:function(){return config.chat_mode}};var v=function(){var e=f.getPageWindow().document||document,t=underscore.bind(e.querySelectorAll,e),i=t("form");log("JIVO OBSERVER, FORMS:",i);function n(e){log("JIVO SUBMIT EVENT",e);var t=e.target;var i="Form"+(t.id?' id="'+t.id+'"':"")+(t.action?' action="'+t.action+'"':"")+" submitted: \n";var n={};underscore.each(t.elements,function(e){if(e.name){n[e.name]=e.value}},this);setImplicitGuiMessage(n,i)}underscore.each(i,function(e){if(e.elements.length>0&&!underscore.findWhere(e.elements,{type:"password"})){log("FORM Observer: ",e);addListener(e,"submit",n);var t=e.submit;e.submit=function(){try{n({target:this})}catch(e){reportException(e)}t.call(this)}}})};var _={frm:0,create:function(){if(config.disable_iframe){log("Magic iframe is disabled");return}if(this.frm){log("Magic iframe already created");return}if(cookie("mframe")){log("Magic iframe create cancelled, page may be protected from iframe");return}cookie("mframe",1);log("Creating iframe");window.parent.jivo=f;var e=window.parent.document.createElement("iframe");e.setAttribute("id","jivo_magic_iframe");e.setAttribute("class","jivo-frame-hidden");e.setAttribute("frameborder","0px");e.setAttribute("name","col_old_page");window.parent.document.body.appendChild(e);e.contentWindow.location=window.parent.window.location;this.frm=e;setIframeLoadCallback(e,underscore.bind(this.onFrameLoaded,this))},onFrameLoaded:function(){log("Magic frame content loaded. Time to show the frame...");var e=document.getElementById("jivo_top_wrap");window.parent.document.body.setAttribute("id","jivo_outer_body");window.parent.document.body.style.overflow="hidden";window.parent.document.body.scroll="no";var t=window.parent.document.getElementsByTagName("iframe");for(var i=0;i<t.length;i++){var n=t[i];if(n.id!="jivo_magic_iframe"&&n.id!="jivo_container"){n.style.display="none"}}this.frm.setAttribute("class","jivo-frame-visible");this.frm.style.display="block";if(this.hasScroll().vScrollbar){var o=this.getScrollBarWidth()+"px";log("Adjusting right margin. Scroll width="+o);document.getElementById("jivo-chat").style.marginRight=o;document.getElementById("jivo-label").style.marginRight=o}this.syncPageScroll()},navigate:function(e){log("navigating iframe to ",e);this.frm.contentDocument.location.href=e},getDoc:function(){var e=this.frm.contentWindow.document;if(!e)e=this.frm.contentDocument;if(!e){log("Cannot find document!! :(");return 0}return e},syncPageScroll:function(){var e=0,t=0;var i=window.parent.window;if(typeof i.pageYOffset=="number"){t=i.pageYOffset;e=i.pageXOffset}else if(i.document.body&&(i.document.body.scrollLeft||i.document.body.scrollTop)){t=i.document.body.scrollTop;e=i.document.body.scrollLeft}else if(i.document.documentElement&&(i.document.documentElement.scrollLeft||i.document.documentElement.scrollTop)){t=i.document.documentElement.scrollTop;e=i.document.documentElement.scrollLeft}log("scroll pos x="+e+" y="+t);this.frm.contentWindow.scrollTo(e,t)},getScrollBarWidth:function(){var e=document.createElement("div");e.style.visibility="hidden";e.style.width="100px";document.body.appendChild(e);var t=e.offsetWidth;e.style.overflow="scroll";var i=document.createElement("div");i.style.width="100%";e.appendChild(i);var n=i.offsetWidth;e.parentNode.removeChild(e);return t-n},hasScroll:function(){var e={vScrollbar:true,hScrollbar:true};try{var t=document.compatMode=="BackCompat"?document.body:document.documentElement;e.vScrollbar=t.scrollHeight>t.clientHeight;e.hScrollbar=t.scrollWidth>t.clientWidth}catch(i){}return e}};(function(e,t){e.VMasker=t()})(this,function(){var e="9",t="A",i="S",n=[8,9,16,17,18,36,37,38,39,40,91,92,93],o=function(e){for(var t=0,i=n.length;t<i;t++){if(e==n[t]){return false}}return true},a=function(e){e=e||{};e={precision:e.hasOwnProperty("precision")?e.precision:2,separator:e.separator||",",delimiter:e.delimiter||".",unit:e.unit&&e.unit.replace(/[\s]/g,"")+" "||"",suffixUnit:e.suffixUnit&&" "+e.suffixUnit.replace(/[\s]/g,"")||"",zeroCents:e.zeroCents,lastOutput:e.lastOutput};e.moneyPrecision=e.zeroCents?0:e.precision;return e},s=function(n,o,a){for(;o<n.length;o++){if(n[o]===e||n[o]===t||n[o]===i){n[o]=a}}return n};var r=function(e){this.elements=e};r.prototype.unbindElementToMask=function(){for(var e=0,t=this.elements.length;e<t;e++){this.elements[e].lastOutput="";this.elements[e].onkeyup=false;this.elements[e].onkeydown=false;if(this.elements[e].value.length){this.elements[e].value=this.elements[e].value.replace(/\D/g,"")}}};r.prototype.bindElementToMask=function(e,t){var i=this,n=function(n){n=n||window.event;var a=n.target||n.srcElement;if(o(n.keyCode)){setTimeout(function(){i.opts.lastOutput=a.lastOutput;a.value=l[e](a.value,i.opts);a.lastOutput=a.value;if(a.setSelectionRange&&i.opts.suffixUnit){a.setSelectionRange(a.value.length,a.value.length-i.opts.suffixUnit.length)}},0)}if(t&&typeof t==="function"){t(n)}};for(var a=0,s=this.elements.length;a<s;a++){this.elements[a].lastOutput="";this.elements[a].onkeyup=n;if(this.elements[a].value.length){this.elements[a].value=l[e](this.elements[a].value,this.opts)}}};r.prototype.maskPattern=function(e,t){this.opts={pattern:e};this.bindElementToMask("toPattern",t)};var l=function(e){if(!e){throw new Error("VanillaMasker: There is no element to bind.")}var t="length"in e?e.length?e:[]:[e];return new r(t)};l.toPattern=function(n,o){var a=typeof o==="object"?o.pattern:o,r=a.replace(/\W/g,""),l=a.split(""),c=n.toString().replace(/\W/g,""),d=c.replace(/\W/g,""),u=0,f,h=l.length,g=typeof o==="object"?o.placeholder:undefined;for(f=0;f<h;f++){if(u>=c.length){if(r.length==d.length){return l.join("")}else if(g!==undefined&&r.length>d.length){return s(l,f,g).join("")}else{break}}else{if(l[f]===e&&c[u].match(/[0-9]/)||l[f]===t&&c[u].match(/[a-zA-Z]/)||l[f]===i&&c[u].match(/[0-9a-zA-Z]/)){l[f]=c[u++]}else if(l[f]===e||l[f]===t||l[f]===i){if(g!==undefined){return s(l,f,g).join("")}else{return l.slice(0,f).join("")}}}}return l.join("").substr(0,f)};return l});var w={callWidgetForm:underscore.template(["<div class='jivo-call-form jivo-call-form-low' style='display:none;'>","<div class='jivo-form-box'>","<div class='jivo-form-inner' style='display: none;'>","<div class='jivo-form-header'>","<div class='jivo-call-text'>","<span class='jivo-text-center'>"+translate("cw_weRecallAfter")+" <span class='jivo-text-time'>28</span> <span class='jivo-text-sec'>"+translate("cw_seconds")+"</span>!</span>","</div>","<div class='jivo-error-header'>","<div class='jivo-error-header-wrapper'>","<div class='jivo-title-ce'>"+translate("cw_unableToConnect")+"</div>","<div class='jivo-err-info'>"+translate("cw_errInfoText")+"</div>","</div>","</div>","<div class='jivo-call-end'>","<div class='jivo-thx-text'>"+translate("cw_thxForCall")+"</div>","</div>","</div>","<div class='jivo-call-content'>","<div id='jivo-call-form'>","<div class='jivo-call-form-shadow'>","<div class='jivo-tel-box'>","<div class='jivo-tel-placeholder'>"+translate("cw_enterPhonePlaceholder")+"</div>","<span class='jivo-tel-pre-code'>+7</span>","<input id='jivo-call-tel' type='tel' value='' name='jivo-tel' maxlength='14' placeholder='926 123 4567'/>","</div>","</div>","<a id='jivo-save-tel' title='"+translate("cw_callButtonText")+"'><i class='jivo-call-icon'></i>"+translate("cw_callButtonText")+"</a>","<a href='#' class='jivo-btn-recall' style='display:none;'>"+translate("cw_repeatCallAgain")+"</a>","</div>","</div>","<div class='jivo-call-copy'>","<a href='#' class='jivo-start-chat'><i class='jivo-ico-start-chat'></i>{{ sendMessage }}</a>","</div>","<a href='http://jivosite.ru/?utm_source=megashop.ru&utm_medium=link&utm_content=callback_popup&utm_campaign=self_ad' target='_blank' title='Jivosite' class='jivo-logo'><span class='j1'>jivo</span><span class='j2'>site</span></a>","</div>","<div id='jivo-call-container'></div>","</div>","</div>"].join("\n")),callWidgetActions:underscore.template(["<div class='jivo-call-action jivo-hidden' style='display: none;'>","<div class='jivo-call-step jivo-call-wait'>","<div class='jivo-text-ca'>"+translate("cw_callAfter")+"</div>","<div id='jivo-timer-block' class='jivo-timer-block'>","<div class='jivo-call-loader' data-anim='base wrapper'>","<div class='jivo-call-circle' data-anim='base left'></div>","<div class='jivo-call-circle' data-anim='base right'></div>","</div>","<div class='jivo-action-timer'>","<span id='jivo-time' class='jivo-time'>28</span>","</div>","</div>"+translate("cw_seconds")+"</div>","<div class='jivo-call-step jivo-call-connecting'>","<div class='jivo-call-box-wrap'>","<div class='jivo-call-box'>","<i class='jivo-connecting-icon'></i>","</div>","</div>","<div class='jivo-text-conn'>"+translate("cw_connecting")+"</div>","</div>","<div class='jivo-call-step jivo-call-connected'>","<div class='jivo-call-box'>","<div class='jivo-call-up'>","<i class='jivo-calling-icon'></i>translate('cw_weCalling')<br>","<span class='jivo-calling-up-phone'>"+translate("cw_pickUpPhone")+"</span>","</div>","<div class='jivo-call-online'>","<div class='jivo-operator-icon'>","<img id='jivo-operator-icon' src='"+config.base_url+"/images/jivo-ico-operator.png' alt=''/>","<i class='jivo-operator-icon-mobile'></i>","</div>","<div class='jivo-operator-name'>","Константин<br>","Манженко","<small>Менеджер-консультант</small>","</div>","<div class='jivo-connected-show-chat'><i class='jivo-ico-start-chat'></i>{{ sendMessage }}</div>","</div>","</div>","</div>","<a href='http://jivosite.ru/?utm_source=megashop.ru&utm_medium=link&utm_content=callback_popup&utm_campaign=self_ad' target='_blank' title='Jivosite' class='jivo-logo'><span class='j1'>jivo</span><span class='j2'>site</span></a>","</div>","<div class='jivo-call-error jivo-call-step' style='display: none;'>","<div class='jivo-end-close'></div>","<div class='jivo-title-ce'>"+translate("cw_unableToConnect")+"</div>","<div class='jivo-call-repeat'>","<div class='jivo-err-info'>"+translate("cw_errInfoText")+"</div>","</div>","<div id='jivo-call-form'>","<div class='jivo-call-form-shadow'>","<div class='jivo-tel-box'>","<div class='jivo-tel-placeholder'>"+translate("cw_enterPhonePlaceholder")+"</div>","<span class='jivo-tel-pre-code'>+7</span>","<input id='jivo-call-tel' type='tel' name='jivo-tel' maxlength='14' placeholder='926 123 4567'/>","</div>","</div>","<a id='jivo-save-tel' title='"+translate("cw_callButtonText")+"'><i class='jivo-call-icon'></i>"+translate("cw_callButtonText")+"</a>","</div>","<div class='jivo-call-copy'>","<a href='#' class='jivo-start-chat'><i class='jivo-ico-start-chat'></i>{{ sendMessage }}</a>","</div>","<a href='http://jivosite.ru/?utm_source=megashop.ru&utm_medium=link&utm_content=callback_popup&utm_campaign=self_ad' target='_blank' title='Jivosite' class='jivo-logo'><span class='j1'>jivo</span><span class='j2'>site</span></a>","<div class='jivo-report-form'>","<p>"+translate("cw_reportPlaceholder")+"</p>","<!--div class='jivo-text-right'>","<a href='#' class='jivo-btn jivo-btn-report'>"+translate("cw_textSend")+"</a>","</div-->","</div>","</div>"].join("\n"))};var b=i.extend({initialState:"CLOSED",namespace:"CALLWIDGET",formType:2,templateForm:w.callWidgetForm,templateCall:w.callWidgetActions,containerForm:"jivo-form-container",containerCall:"jivo-call-container",form:null,call:null,phone:0,timer:0,clickClosedForm:true,initTel:function(){var e=this.phone=document.getElementById("jivo-call-tel");var t=cookie("phone"),i;if(t){t=t.substring(2,12);i=document.getElementById("jivo-call-tel");i.value=t;removeClass(i,"jivo-disabled")}this.actionForElements(".jivo-start-chat",function(e){e.onclick=underscore.bind(function(e){e.preventDefault();this.hideContentCallWidget()},this)});this.initMask()},checkTel:function(e){var t=this.phone=document.getElementById("jivo-call-tel");var i=e.keyCode||e.whitch;if(t.value.toString().length===12){removeClass(t,"jivo-disabled")}if(i===13){document.getElementById("jivo-save-tel").click()}},initMask:function(){VMasker(this.phone).maskPattern("999 999 9999",this.checkTel)},guiMaximize:function(){f.isClicked=true;f.handle("gui_maximize")},actionForElements:function(t,i){if(t.charAt(0)==="."){underscore.each(e(t.substr(1)),i,this)}else{underscore.each([document.getElementById(t.substr(1))],i,this)}},showElement:function(e){if(!underscore.isArray(e)){var t=[];t.push(e);e=t}underscore.each(e,function(e){this.actionForElements(e,function(e){e.style.display="block"})},this)},hideElement:function(e){if(!underscore.isArray(e)){var t=[];t.push(e);e=t}underscore.each(e,function(e){this.actionForElements(e,function(e){e.style.display="none"})},this)},addClass:function(e,t){this.actionForElements(e,function(e){addClass(e,t)})},removeClass:function(e,t){this.actionForElements(e,function(e){removeClass(e,t)})},showAction:function(){this.showElement(".jivo-call-action")},drawTimer:function(t){var i=360/100*t,n=".jivo-call-loader",o="jivo-call-circle";if(t>50){this.addClass(n,"gt50");underscore.each(e(o),function(e,t){if(t===1){addClass(e,"fill")}},this)}else{this.removeClass(n,"gt50");underscore.each(e(o),function(e,t){if(t===1){removeClass(e,"fill")}},this)}this.actionForElements("."+o,function(e){e.style.webkitTransform="rotate("+i+"deg)";e.style.MozTransform="rotate("+i+"deg)";e.style.msTransform="rotate("+i+"deg)";e.style.OTransform="rotate("+i+"deg)";e.style.transform="rotate("+i+"deg)"})},center:function(e){e.css({position:"fixed",top:"50%",left:"50%",margin:"-"+282/2+"px 0 0 -"+e.width()/2+"px"})},secOfNum:function(e){var t=[translate("cw_form_second"),translate("cw_form_seconds"),translate("cw_form_secondd")],i=[2,0,1,1,1,2];return t[e%100>4&&e%100<20?2:i[e%10<5?e%10:5]]},showCloseButton:function(e){var t=this;setTimeout(function(){f.gui.jivoframecontainer.closeButton.style.display=e?"block":"none"},500)},initialize:function(){if(document.getElementById(this.containerCall)){log("JivoCall already initialized.")}else{var e=config.chat_mode==="online"?translate("cw_typeInChat"):translate("lblLeaveMessage"),t={sendMessage:e};this.form=document.createElement("div");this.form.setAttribute("id",this.containerForm);this.form.innerHTML=this.templateForm(t);document.getElementById("jivo_iframe_placeholder").appendChild(this.form);this.call=document.getElementById(this.containerCall);this.call.innerHTML=this.templateCall(t);this.showElement(["#"+this.containerCall]);this.actionForElements(".jivo-call-form",function(e){e.onclick=underscore.bind(function(e){if(e){e.preventDefault();e.stopPropagation()}this.transition("FORMHIDDEN")},this)});this.actionForElements(".jivo-form-box",function(e){e.onclick=underscore.bind(function(e){if(e){e.stopPropagation()
}},this)});var i=f.getTextColor();this.actionForElements(".jivo-text-center",function(e){e.style.color=i});this.actionForElements(".jivo-title-ce",function(e){e.style.color=i});this.actionForElements(".jivo-err-info",function(e){e.style.color=i})}if(cookie("chat_call")!==1){underscore.each(["cw_wait","cw_connecting","cw_calling","cw_connected","cw_error","cw_call_end","cw_show_form"],underscore.bind(function(e){f.on(e,underscore.bind(function(t){this.handle(e,t)},this))},this));f.on("startup_ok",underscore.bind(function(e){if(this.resumed_context.client_info.cw_call){this.handle(this.resumed_context.client_info.cw_call.status,e)}},this))}this.initTel();this.actionForElements(".jivo-close-form",function(e){e.onclick=underscore.bind(function(e){e.preventDefault();$("#jivo-iframe-container",window.parent.document).removeClass("jivo-callwidget");$("#jivo-iframe-container",window.parent.document).addClass("jivo-closing");this.transition("FORMHIDDEN")},this)});this.actionForElements("#jivo-save-tel",function(e){e.onclick=underscore.bind(this.clickTel,this)});this.actionForElements(".jivo-call-close",function(e){e.onclick=underscore.bind(function(e){e.preventDefault();this.transition("FORMHIDDEN")},this)});this.actionForElements(".jivo-btn-recall",function(e){e.onclick=underscore.bind(this.clickTel,this)});this.actionForElements(".jivo-btn-start-chat",function(e){e.onclick=underscore.bind(function(e){e.preventDefault();this.hideElement(".jivo-call-end");this.transition("FORMHIDDEN");this.guiMaximize()},this)});this.actionForElements(".jivo-btn-report",function(e){e.onclick=underscore.bind(function(e){e.preventDefault();this.hideElement(".jivo-call-error");this.showLabel();f.handle("gui_maximize")},this)});this.actionForElements(".jivo-connected-show-chat",function(e){e.onclick=underscore.bind(function(e){e.preventDefault();this.hideCallWidget();f.gui.enableAnimation(false);if(f.state=="OFFLINE"){f.gui.jivoframecontainer.expandTo=parseInt(f.gui.jivoframecontainer.getOfflineFormHeight());log("handle expand from callwidget type in chat.");f.gui.jivoframecontainer.handle("expand");f.gui.transition("CHAT")}else{cookie("collapsed",null);removeClass(f.gui.jivoframecontainer.element,"jivo-no-transition");this.hideElement("#jivo-form-container");f.gui.jivoframecontainer.handle("expand");f.gui.transition("CHAT")}},this)});this.actionForElements(".jivo-show-chat",function(e){e.onclick=underscore.bind(function(e){if(e){e.preventDefault()}f.gui.enableAnimation(false);this.guiMaximize()},this)});this.trackLogo()},trackLogo:function(){var e="https://www.jivochat.com/",t=jivo_config.locale;if(t==="ru_RU"){e="http://www.jivosite.ru/"}else if(t==="pt_PT"||t==="pt_BR"){e="http://www.jivochat.com.br"}this.actionForElements(".jivo-logo",function(t){t.setAttribute("href",e+"calls?utm_source="+window.location.host+"&utm_medium=link&utm_content=callback_popup&utm_campaign=self_ad")})},clickTel:function(e){e.preventDefault();var t=document.getElementById("jivo-call-tel").value.replace(/\D/g,"");if(t.toString().length===10){removeClass(this.phone,"jivo-disabled");this.phone_number="+7"+t.toString();this.setTimerNull();this.transition("FORMANIMATE")}else{addClass(this.phone,"jivo-disabled");this.phone.focus()}},setTimerNull:function(){clearInterval(this.timer);cookie("cw_timer",null);this.removeClass(".jivo-timer-block","jivo-timer-show")},hideContentCallWidget:function(){this.transition("CHAT_ANIMATED")},hideCallWidget:function(){var e=".jivo-call-form";this.actionForElements(e,function(e){e.style.opacity="0"});if(config.chat_mode==="offline"){this.actionForElements(".jivo-bottom-left-square",function(e){if(e.style.background)e.style.background="";e.style.backgroundColor=this.backgroundColorTriangle})}this.hideElement(e);this.hideElement("#jivo-form-container")},showCallWidget:function(){var e=".jivo-call-form";this.showElement("#"+this.containerForm);this.actionForElements(e,function(e){e.style.opacity="1"});this.showElement(e);if(this.state==="CLOSED"||this.state==="CHAT_ANIMATED"){this.transition("FORMVISIBLE")}this.actionForElements("#jivo-call-tel",function(e){e.focus()});if(underscore.indexOf(["FORMVISIBLE","cw_call_end","cw_error"],this.state)>=0){this.showCloseButton(true)}if(config.chat_mode==="offline"){this.actionForElements(".jivo-bottom-left-square",function(e){if(!this.backgroundColorTriangle)this.backgroundColorTriangle=e.style.backgroundColor;e.style.background="#44bb6e"})}},showLabel:function(){f.gui.showLabelForCallWidget()},hideLabel:function(){if(cookie("chat_call")!=1){f.handle("gui_callwidget")}},states:{CLOSED:{_onEnter:function(){this.hideElement(".jivo-call-action");this.hideCallWidget();log(f.state,f.gui.widget.state,f.gui.state);if(f.gui.state==="CALLWIDGET"){this.showLabel()}},cw_show_form:function(e){this.showform=e;if(this.currentState==="cw_wait"){this.handle("cw_wait",e);return}if(this.showform.show_form===1){this.transition("FORMVISIBLE")}},start_timer:"WAIT",cw_connecting:function(){this.currentState="cw_connecting";this.transition("CALL")},cw_connected:function(){this.currentState="cw_connected";this.transition("CALL")},cw_wait:function(){cookie("cw_timer",null);this.transition("WAIT")},setPhoneNumber:function(e){this.phone.value=e.replace(/^8|^\+7|^7/,"");this.initMask();this.analyticsTitle="phoneEnter";document.getElementById("jivo-save-tel").click()}},FORMVISIBLE:{_onEnter:function(){this.hideLabel();this.removeClass(".jivo-call-content","jivo-call-content-animate");this.removeClass(".jivo-call-content","jivo-call-content-animate-offline");var e="410px";clearInterval(this.timer);this.currentState="";this.clickClosedForm=false;this.hideElement([".jivo-call-action",".jivo-call-error"]);this.actionForElements(".jivo-text-time",function(e){e.innerHTML=this.seconds});this.actionForElements(".jivo-text-sec",function(e){e.innerHTML=this.secOfNum(this.seconds)});if(config.widget_font_color){this.addClass(".jivo-form-header","header-color-"+config.widget_font_color);this.addClass(".jivo-logo","jivo-logo-"+config.widget_font_color)}this.hideElement(".jivo-error-header",".jivo-btn-recall");this.showElement([".jivo-form-inner",".jivo-form-header",".jivo-call-copy",".jivo-call-text",".jivo-logo",".jivo-call-form-shadow","#jivo-save-tel"]);if(this.formType===1)this.center(this.form.find(".jivo-form-box"));this.actionForElements(".jivo-call-form",function(t){t.style.right="auto";f.gui.jivoframecontainer.setHeight(e+"px")});if(this.showform){if(this.showform.title&&typeof this.showform.title==="string"){telemetry("show_call_widget_invitation");this.actionForElements(".jivo-text-center",function(e){e.innerHTML=this.showform.title;this.analyticsTitle=this.showform.title})}else{telemetry("show_call_widget")}this.hideCallWidget();setTimeout(underscore.bind(function(){this.showCallWidget()},this),50)}this.actionForElements(".jivo-call-form",function(e){e.style.display="block"});this.actionForElements(".jivo-form-box",function(e){e.style.opacity="1"});this.showElement([".jivo-form-box",".jivo-call-text"]);this.showCloseButton(true)},cw_show_form:function(e){if(e.show_form){this.hideLabel();this.showCallWidget()}},cw_wait:function(){this.transition("WAIT")},start_timer:"WAIT",CLOSED:"CLOSED"},FORMHIDDEN:{_onEnter:function(){this.actionForElements(".jivo-call-form",function(e){e.style.bottom="-410px"});setTimeout(underscore.bind(function(){this.transition("CLOSED");this.showLabel();$("#jivo-iframe-container",window.parent.document).removeClass("jivo-closing")},this),200);this.showCloseButton(false)}},FORMANIMATE:{_onEnter:function(){this.showElement(".jivo-call-action");this.actionForElements(".jivo-call-action",function(e){e.style.opacity="1"});this.showCloseButton(false);this.handle("animatefinished")},animatefinished:function(){cookie("phone",this.phone_number);this.transition("WAIT");if(this.showform&&this.showform.title&&typeof this.showform.title==="string"){f.handle("cw_call",{tel:this.phone_number,invitation_text:this.showform.title})}else{f.handle("cw_call",{tel:this.phone_number})}},cw_error:function(){this.transition("cw_error")},cw_call_end:function(){this.transition("cw_call_end")}},WAIT:{"*":function(e){this.emit.apply(this,underscore.toArray(arguments))},_onEnter:function(){this.hideLabel();if(config.widget_font_color){this.removeClass(".jivo-logo","jivo-logo-light")}this.actionForElements(".jivo-chat-triangle",function(e){e.style.borderLeftColor="#fff"});this.showElement(".jivo-logo");clearInterval(this.timer);if(p&&this.analyticsTitle){p.trackCallWidgetRequested(this.analyticsTitle)}this.showCloseButton(false);this.handle("cw_wait")},cw_wait:function(){if(hasClass(document.getElementById("jivo-timer-block"),"jivo-timer-show")){return}this.removeClass(".jivo-timer-block","jivo-timer-show");this.hideElement([".jivo-form-inner",".jivo-call-action",".jivo-call-error"]);this.showElement(".jivo-call-form");this.actionForElements(".jivo-call-form",function(e){e.style.bottom="0px"});this.hideElement(".jivo-form-header");this.showElement("#"+this.containerCall);this.actionForElements(".jivo-call-wait",function(e){e.style.opacity="0"});this.hideElement([".jivo-call-step",".jivo-call-loader"]);this.showElement([".jivo-call-action",".jivo-call-wait",".jivo-call-loader"]);this.addClass(".jivo-timer-block","jivo-timer-show");if(this.seconds){this.handle("start_timer",this.seconds)}},_onExit:function(){this.actionForElements(".jivo-chat-triangle",function(e){e.style.borderLeftColor=config.widget_color})},start_timer:function(e){this.actionForElements("#"+this.containerForm,function(e){e.style.opacity="1"});e=this.seconds;this.showElement(".jivo-call-wait");var t=e*1e3;var i=document.getElementById("jivo-time");i.innerHTML=t/1e3;clearInterval(this.timer);this.timer=setInterval(underscore.bind(function(){if(!cookie("cw_timer")){cookie("cw_timer",(new Date).getTime())}else{var e=parseInt((new Date).getTime())-parseInt(cookie("cw_timer"));t=this.initTimer*1e3-e;t=(t/1e3).toFixed(1)*1e3;if(t<=0){clearInterval(this.timer);this.timer=false;this.handle("timer_finished");return}}this.actionForElements(".jivo-call-wait",function(e){e.style.opacity="1"});if(t/1e3%1===0&&Number(t)===t){i.innerHTML=t/1e3+".0"}else{i.innerHTML=t/1e3}var n=100-t/1e3/this.initTimer*100;this.drawTimer(n);t=t-100;if(t<=0){i.innerHTML=t;clearInterval(this.timer);this.timer=false;this.handle("timer_finished")}},this),100)},timer_finished:function(){this.handle("cw_connecting")},cw_connecting:function(e){this.agent_info=e;this.transition("CALL")},cw_connected:function(){this.currentState="cw_connected";this.transition("CALL")},cw_error:function(e){if(e&&e.reason){this.error_reason=e.reason}this.transition("cw_error")},cw_call_end:function(){this.transition("cw_call_end")}},CALL:{_onEnter:function(){this.actionForElements(".jivo-chat-triangle",function(e){e.style.borderLeftColor="#fff"});this.showElement("#"+this.containerCall);this.hideElement(".jivo-form-inner");this.showElement(".jivo-call-form");this.actionForElements(".jivo-call-form",function(e){e.style.bottom="0px"});this.showElement(".jivo-logo");if(f.gui.state==="CHAT"){this.hideCallWidget()}else{this.hideLabel()}this.showCloseButton(false);if(this.currentState){this.handle(this.currentState);this.currentState=false}else{this.handle("cw_connecting")}},_onExit:function(){this.currentState=false;this.actionForElements(".jivo-chat-triangle",function(e){e.style.borderLeftColor=config.widget_color})},cw_wait:function(e){this.handle("cw_connecting",e)},start_timer:function(){this.currentState="cw_wait";this.transition("WAIT")},timer_finished:function(){this.timer=false;this.handle("cw_connecting")},cw_connecting:function(e){if(!this.agent_info&&e){this.agent_info=e}f.gui.jivoframecontainer.setHeight("410px");this.removeClass(".jivo-call-error","jivo-error-visible");this.hideElement(".jivo-form-header");this.showAction();if(f.resumed_context&&f.resumed_context.agent_info){this.agent_info=f.resumed_context.agent_info}if(!this.timer){this.hideElement([".jivo-call-step",".jivo-call-end"]);this.actionForElements(".jivo-call-connected",function(e){e.setAttribute("style","")});this.removeClass(".jivo-call-box","jivo-operator-online");this.hideElement(".jivo-call-online");this.showElement(".jivo-call-connecting")}},cw_connected:function(){clearInterval(this.timer);this.currentState="cw_connected";this.actionForElements(".jivo-chat-triangle",function(e){e.style.borderLeftColor=config.widget_color});if(f.resumed_context&&f.resumed_context.agent_info){this.agent_info=f.resumed_context.agent_info}this.hideElement(".jivo-logo");this.showElement(".jivo-call-action");var e="124px";if(this.agent_info&&this.agent_info.state==0){e="70px"}else if(chat_view_online&&chat_view_online.getChatModel().get("agent.online")){e="124px"}if(f.gui.state!=="CHAT"){f.gui.jivoframecontainer.setTransition(true);f.gui.jivoframecontainer.setHeight(e)}if(this.agent_info){if(this.agent_info.avatar_url!=null){document.getElementById("jivo-operator-icon").setAttribute("src",config.avatar_url+"/avatars/"+this.agent_info.avatar_url)}else{if(config.widget_color&&!isLightColor(config.widget_color)){document.getElementById("jivo-operator-icon").setAttribute("src",config["base_url"]+"/images/icon_ava_dark.png")}else{document.getElementById("jivo-operator-icon").setAttribute("src",config["base_url"]+"/images/icon_ava_light.png")}}if(this.agent_info["display_name"]){this.actionForElements(".jivo-operator-name",function(e){e.innerHTML=this.agent_info["display_name"]+" <small>"+this.agent_info.title+"</small>"})}}this.hideElement([".jivo-form-header",".jivo-error-header",".jivo-call-step",".jivo-call-up",".jivo-call-end"]);this.showElement([".jivo-call-connected",".jivo-call-online"]);this.actionForElements(".jivo-call-connected",function(e){e.style.color=f.getTextColor()});this.handle("operator_online")},operator_online:function(){clearInterval(this.timer);this.showElement(".jivo-call-online")},cw_error:function(){this.transition("cw_error")},cw_call_end:function(){this.transition("cw_call_end")},CLOSED:function(){this.transition("CLOSED")},cw_show_form:"cw_connected"},cw_call_end:{_onEnter:function(){log(f.resumed_context);f.resumed_context=false;if(f.gui.state!=="CHAT"){this.hideLabel();f.gui.jivoframecontainer.setHeight("410px")}this.addClass(".jivo-logo","jivo-logo-"+config.widget_font_color);this.setTimerNull();if(config.widget_font_color){this.addClass(".jivo-thx-text","header-color-"+config.widget_font_color)}this.actionForElements(".jivo-thx-text",function(e){e.style.color=f.getTextColor()});this.showElement(["#"+this.containerForm,".jivo-form-inner",".jivo-form-header",".jivo-logo",".jivo-btn-recall"]);this.hideElement(["#"+this.containerCall,"#jivo-save-tel",".jivo-call-text",".jivo-call-action ",".jivo-error-header",".jivo-call-step",".jivo-call-up",".jivo-call-connected"]);this.removeClass(".jivo-call-box","jivo-operator-online");this.addClass(".jivo-call-box","jivo-operator-call-end");this.hideElement([".jivo-call-online",".jivo-call-online"]);this.showElement(".jivo-call-end");this.showCloseButton(true);if(f.gui.state=="CHAT"){this.hideElement("#"+this.containerForm)}},start_timer:function(){this.currentState="cw_wait";this.transition("WAIT")},cw_show_form:function(){this.transition("FORMVISIBLE")},cw_wait:function(){this.transition("wait")},cw_connected:function(){this.currentState="cw_connected";this.transition("CALL")},CLOSED:"CLOSED",_onExit:function(){this.hideElement(".jivo-btn-recall");this.showElement("#jivo-save-tel")}},cw_error:{_onEnter:function(){if(f.gui.state==="CHAT"){return}this.hideLabel();f.resumed_context=false;this.setTimerNull();this.hideElement("#"+this.containerCall);this.hideElement(".jivo-call-text");this.showElement([".jivo-form-header",".jivo-logo",".jivo-error-header",".jivo-form-inner"]);this.actionForElements("#jivo-call-tel",function(e){e.value=this.phone.value});this.addClass(".jivo-logo","jivo-logo-"+config.widget_font_color);this.hideElement([".jivo-call-step",".jivo-call-action"]);if(this.error_reason){this.actionForElements(".jivo-title-ce",function(e){e.innerHTML=translate(this.error_reason)});this.actionForElements(".jivo-err-info",function(e){e.innerHTML=""});delete this.error_reason}else{this.actionForElements(".jivo-title-ce",function(e){e.innerHTML=translate("cw_unableToConnect")});this.actionForElements(".jivo-err-info",function(e){e.innerHTML=translate("cw_errInfoText")})}this.showCloseButton(true);if(f.gui.state!=="CHAT"){f.gui.jivoframecontainer.setTransition(true);f.gui.jivoframecontainer.setHeight("410px")}setTimeout(underscore.bind(function(){this.addClass(".jivo-call-error","jivo-error-visible")},this),5)},_onExit:function(){this.hideElement(".jivo-call-error")},cw_show_form:"FORMVISIBLE"},CHAT_ANIMATED:{_onEnter:function(){this.hideElement([".jivo-call-copy",".jivo-error-header",".jivo-call-text",".jivo-logo",".jivo-call-form-shadow","#jivo-save-tel",".jivo-btn-recall"]);if(f.state==="ONLINE"){chat_view_online.getIntroduceView().collection.reset()}else{chat_view_offline.instance.views.form.collection.reset();removeClass(f.gui.jivoframecontainer.element,"jivo-no-transition");f.gui.jivoframecontainer.setHeight(f.gui.jivoframecontainer.getOfflineFormHeight())}if(f.gui.animationIsSupported()){if(f.state==="OFFLINE"){this.addClass(".jivo-call-content","jivo-call-content-animate-offline")}else{this.addClass(".jivo-call-content","jivo-call-content-animate")}this._scheduleEvent("callFormAnimate",350)}else{this.hideCallWidget();this.transition("CLOSED");f.gui.transition("CHAT")}},callFormAnimate:function(){$("#inner-chat").css({display:"block",visibility:"visible"});this.actionForElements(".jivo-call-form",function(e){e.style.opacity="0"});this._scheduleEvent("transitionToChat",100)},transitionToChat:function(){this.hideElement("#jivo-form-container");this.hideElement(".jivo-call-form");this.transition("CLOSED");if(f.state==="ONLINE"&&jivo_config.contacts_ask==1&&chat_view_online.getMessagesView().isIntroduceRequired()){f.gui.jivoframecontainer.expandTo=parseInt(f.gui.jivoframecontainer.getOnlineFormHeight());f.gui.jivoframecontainer.handle("expand")}f.gui.transition("CHAT")},cw_show_form:"FORMVISIBLE"}}})})();var coBrowserIframeCreater=window.parent.coBrowserIframeCreater=function(){var e,t,i=false,n=[],o=false,a,s={},r=function(e,t){a=setTimeout(function(){i=true;r()},5);if(!i){n.push({name:e,params:t});return}if(n.length){var l=n.shift();e=l.name;t=l.params}var c;if(o){log("controller of childSandboxBridge set as for NodeWebkit");c=jqueryFrameControllerForAir;c.setLangpack(s);c.init()}else{c=jqueryFrameController}if(c[e]&&e!="is_node_webkit"){clearInterval(a);c[e](t)}if(n.length){r()}};addListener(window.parent,"message",function(i){if(!i){log("Error receive postMessage, window message event is empty.");return}var n=i.data;n.langpack=JSON.parse(cookie("langpack"));if(underscore.indexOf(["startSelection","stopSelection","in_node_webkit"],n.name)!==-1&&i.source&&i.origin){e=i.source;t=i.origin;o=true;s=n.langpack;r(n.name,n)}},false);return{process:function(e,t){r(e,t)},postMessage:function(e){setTimeout(function(){window.parent.jivo_cobrowse.source.postMessage(e,window.parent.jivo_cobrowse.origin)},0)},isNodeWebkit:function(){return o}}}();var lblDefaultCobrowseComment=translate("lblDefaultCobrowseComment");(function(e){var t=function(e){if(typeof console==="object"&&console.log){console.log(e)}};window.jqueryFrameController={is_inited:false,highlight:function(i){if(!this.is_inited){var n=window.document.createElement("link");n.setAttribute("rel","stylesheet");n.setAttribute("href",staticUrl("/css/for_air.css"));e.body.appendChild(n);this.is_inited=true}var o=typeof i.element=="string"?$(i.element,e):i.element;if($("#jivo_cobrowsing_element_id_"+i.hash,e).length>0){return this.animateScroll(i)}$(".jivo_cobrowsing_element",e).remove();$(".jivo_cobrowsing_tooltip",e).remove();var a=o.offset(),s=o.outerWidth(),r=o.outerHeight(),l;function c(e,i,n){t(e,i,n);l.css({top:e.top-3,left:e.left-12,height:n+10,width:i+10})}function d(){if(!l){l=$("<div/>",{"class":"jivo_cobrowsing_element",id:"jivo_cobrowsing_element_id_"+i.hash}).appendTo(o.parents("body"))}}function u(){$("<div/>",{"class":"jivo_cobrowsing_element_inner"}).appendTo(l)}if(o[0]){d();c(a,s,r);u()}var f=function(){o=typeof i.element=="string"?$(i.element,e):i.element;if(!l){d();u()}if(o[0]){var t=o.offset(),n=o.outerWidth(),a=o.outerHeight();c(t,n,a)}if(l)return l};setInterval(function(){f()},50);if(l)return l},renderTooltip:function(t){var i=$("#jivo_cobrowsing_tooltip_"+t.hash,e);if(i.length>0){this.animateScroll(t);return i}var n=typeof t.element=="string"?$("#jivo_cobrowsing_element_id_"+t.hash,e):t.element,o=$("<div/>",{"class":""}).css({width:"100%",height:"auto"}),i=$("<div/>",{"class":"jivo_cobrowsing_tooltip",id:"jivo_cobrowsing_tooltip_"+t.hash});i.append(o);if(t.show)i=this.addTooltipContent(i,t,n);return i},appendTooltip:function(t,i){var n=t.children().first();t.appendTo($("body",e));_onResize=function(){n.addClass("bottom");n.removeClass("top left right");if(i[0]){var e=30,o=i.outerWidth(),a=i.outerHeight(),s=i.offset(),r=s.left+o/2-e/2,l=s.top-e+15,c=t.width()/2*-1;if(l<n.height()+10){l=s.top+a;n.addClass("top")}else{n.css({position:"absolute",bottom:"0px"})}if(r+c<10){r=s.left;c=0;n.addClass("left")}if(r+t.outerWidth()>$(window.parent.window).outerWidth()){c=t.width()*-1;r=s.left+o-e;n.addClass("right")}t.css({left:r,top:l,"margin-left":c})}};_onResize();t.animate({opacity:1},150);this.animateScroll(null,i,n);setInterval(function(){_onResize()},50)},addTooltipContent:function(t,i,n){var o=t.find(":first-child");var a=jivo_config.options&32&&typeof i.agent.avatar_url=="string"&&i.agent.avatar_url.length>0;if(a){if(jivo_config.avatar_url)i.agent.avatar_url=jivo_config.avatar_url+"/avatars/"+i.agent.avatar_url}var s=$("<div/>",{id:"jivo_action"}).appendTo(o);$("<div/>",{id:"jivo_close_button"}).appendTo(s);$("<div/>",{text:i.agent.display_name,"class":"jivo_cobrowsing_tooltip_agent"}).appendTo(o);$("<div/>",{html:i.comment.split("\n").join("<br />"),"class":"jivo_cobrowsing_tooltip_text"}).appendTo(o);s.find("div").bind("click",function(){switch($(this).attr("id")){case"jivo_close_button":$("#jivo_cobrowsing_element_id_"+i.hash,e).remove();jivo.handle("gui_close_cobrowse",i.hash);t.remove();break}});this.appendTooltip(t,n);return t},animateScroll:function(t,i,n){if(t){var i=$("#jivo_cobrowsing_element_id_"+t.hash,e);var n=$("#jivo_cobrowsing_tooltip_"+t.hash,e).find("div:first-child")}if(n&&n.hasClass("top")){var o=i.offset().top}else{var o=n.offset().top}$("html, body",e).queue("fx",[]);$("html, body",e).animate({scrollTop:o-300},800);$(window,e).bind("scroll.jivo",function(e){e.preventDefault()});setTimeout(function(){$(window,e).unbind("scroll.jivo")},1e3)}};window.jqueryFrameControllerForAir={is_selecting:false,is_tooltip_open:false,is_inited:false,langpack:{},init:function(){if(!this.is_inited){var t=window.document.createElement("link");t.setAttribute("rel","stylesheet");t.setAttribute("href",staticUrl("/css/for_air.css"));e.body.appendChild(t);$(window,e).unbind("keydown").bind("keydown",function(e){if(e.keyCode==27){jqueryFrameControllerForAir.onEsc()}});this.is_inited=true}},setLangpack:function(e){this.langpack=e},i18n:function(e){return this.langpack[e]?this.langpack[e]:e},startSelection:function(){$("body",e).addClass("jivo_selecting");this.is_selecting=true;$("input, textarea, select, button",e).prop("disabled",true).each(function(){var t=$("<div/>"),i=$(this).offset(),n=$(this).outerWidth(),o=$(this).outerHeight();t.css({position:"absolute",top:i.top,left:i.left,width:n,height:o});t[0].realNode=this;$("body",e).append(t)});$("body *",e).on("mouseover.co_browser",function(e){if(this.tagName=="OPTION")return false;jqueryFrameControllerForAir.clearSelection();jqueryFrameController.highlight({element:$(e.target)});jqueryFrameControllerForAir.stopTagsA();$(e.target).unbind("click.co_browser").bind("click.co_browser",function(e){e.preventDefault();e.stopPropagation();var t=this.realNode?this.realNode:this;jqueryFrameControllerForAir.stopSelection();jqueryFrameControllerForAir.toolTip($(t))})});$("body *",e).on("mouseout.co_browser",function(e){jqueryFrameControllerForAir.clearSelection()})},stopTagsA:function(){$("body a",e).on("click.co_browser",function(e){e.preventDefault();e.stopPropagation();return false})},stopSelection:function(){$("body",e).removeClass("jivo_selecting");$("input, textarea, select, button",e).prop("disabled",false);$(".fake_cb_element",e).remove();$("body *",e).unbind("mouseover.co_browser").unbind("mouseout.co_browser").unbind("click.co_browser");jqueryFrameControllerForAir.clearSelection();this.is_selecting=false},clearSelection:function(){$("body .jivo_cobrowsing_element",e).remove();$(".jivo_cobrowsing_tooltip",e).remove()},toolTip:function(e){var t=jqueryFrameController.highlight({element:e});var i=jqueryFrameController.renderTooltip({element:e});var n=i.find(":first-child");i.addClass("air").css("width","auto");n.css({padding:"8px",width:"auto","background-color":""});var o=this.textInput=$("<textarea></textarea>",{id:"cobrowsing_textarea_comment",placeholder:this.i18n("cb_enterComment"),keypress:function(t){if(t.keyCode==13){t.preventDefault();t.stopPropagation();jqueryFrameControllerForAir.send(e)}}});o.autoResize({animate:false,minSize:19,maxSize:100,extraSpace:12});var a=$('<button class="btn btn-mimi blue on_dark large">'+this.i18n("cb_send")+"</button>").css({"float":"right",position:"relative","margin-right":"8px"}).on("click",function(){jqueryFrameControllerForAir.send(e)});var s=$('<button class="btn btn-mimi grey on_dark large">'+this.i18n("cb_cancel")+"</button>").css({"float":"right","margin-right":"5px",position:"relative"}).on("click",function(){jqueryFrameControllerForAir.closeTooltip()});n.append(o);n.append(s);n.append(a);n.append($("<div/>",{style:"clear:both"}));jqueryFrameController.appendTooltip(i,e);o.val(" ").data("AutoResizer").check();o.val(lblDefaultCobrowseComment);o[0].focus();o[0].select();this.is_tooltip_open=true},send:function(e){if($.trim(this.textInput.val())!=""){var t=i(e[0]);var n={name:"on_send",page_element:t,page_url:window.location.href,comment:this.textInput.val()};coBrowserIframeCreater.postMessage(n)}},closeTooltip:function(){jqueryFrameControllerForAir.stopSelection();jqueryFrameControllerForAir.is_tooltip_open=false;jqueryFrameControllerForAir.startSelection();coBrowserIframeCreater.postMessage({name:"on_cancel"})},onEsc:function(){if(jqueryFrameControllerForAir.is_tooltip_open){jqueryFrameControllerForAir.closeTooltip()}else if(jqueryFrameControllerForAir.is_selecting){jqueryFrameControllerForAir.stopSelection();coBrowserIframeCreater.postMessage({name:"reset"})}else{coBrowserIframeCreater.postMessage({name:"close"})}}};function i(e){var t=[];while(e.parentNode){if(e.id){t.unshift("#"+e.id);break}else{if(e==e.ownerDocument.documentElement)t.unshift(e.tagName);else{for(var i=1,n=e;n.previousElementSibling;n=n.previousElementSibling,i++);t.unshift(e.tagName+":nth-child("+i+")")}e=e.parentNode}}return t.join(" > ")}})(window.parent.document);var VOXIMPLANT_URL="//cdn.voximplant.com/voximplant.min.js";var WebPhone=machina.Fsm.extend({namespace:"WP",autoCall:false,agentId:"",states:{uninitialized:{call:function(){this.autocall=true;this.transition("initializing")},init:function(){this.transition("initializing")}},initializing:{_onEnter:function(){loadScript(VOXIMPLANT_URL,underscore.bind(this.handle,this,"script_loaded"),underscore.bind(this.handle,this,"script_load_error"))},script_loaded:function(){this.emit("WebPhoneInitializing",{name:"WebPhoneInitializing"});this.vox=VoxImplant.getInstance();this.vox.init({useFlashOnly:false,micRequired:true,swfContainer:"rtc_placeholder",progressTone:true});this.vox.addEventListener(VoxImplant.Events.SDKReady,underscore.bind(this.handle,this,"vox_init"))},script_load_error:function(e){reportException({message:"Error loading voximplant script",fileName:"web_phone.js"})},vox_init:function(){this.transition("connecting")},call:function(){this.autocall=true}},initialized:{_onEnter:function(){this.emit("WebPhoneInitialized",{name:"WebPhoneInitialized"})},call:function(){this.autocall=true;this.transition("connecting")},init:function(){this.transition("connecting")}},connecting:{_onEnter:function(){this.emit("WebPhoneConnecting",{name:"WebPhoneConnecting"});this.vox.connect();this.vox.addEventListener(VoxImplant.Events.MicAccessResult,underscore.bind(function(e){if(!e.result){this.handle("vox_mic_access_denied")}},this));this.vox.addEventListener(VoxImplant.Events.ConnectionEstablished,underscore.bind(function(e){this.handle("vox_connected")},this));this.vox.addEventListener(VoxImplant.Events.ConnectionFailed,underscore.bind(function(e){reportException({message:"Vox to connecting failed",fileName:"web_phone.js"});this.handle("vox_connection_failed")},this));this.vox.addEventListener(VoxImplant.Events.ConnectionClosed,underscore.bind(function(e){this.handle("vox_connection_closed")},this))},vox_connected:function(){this.transition("authenticating")},vox_connection_failed:function(){this.transition("initialized")},vox_connection_closed:function(){this.transition("initialized")},vox_mic_access_denied:function(){this.transition("mic_disabled")},call:function(){this.autocall=true},hangup:function(){this.transition("initialized")}},connected:{_onEnter:function(){this.emit("WebPhoneConnected",{name:"WebPhoneConnected"})},call:function(){this.autocall=true;this.transition("authenticating")},init:function(){this.transition("authenticating")}},authenticating:{_onEnter:function(){this.emit("WebPhoneAuthenticating",{name:"WebPhoneAuthenticating"});this.vox.addEventListener(VoxImplant.Events.AuthResult,underscore.bind(function(e){if(e.result){this.handle("vox_authenticated")}else{if(e.code==302){this.handle("vox_key_received",e.key)}else{this.handle("vox_authentication_failed")}}},this));this.vox.requestOneTimeLoginKey(config.vox_login)},vox_key_received:function(e){var t=config.base_url+"/script/sign?cb=?&key="+e;getJSONP(t,underscore.bind(function(e){if(e.result){this.handle("vox_hash_received",e.hash)}else{this.handle("vox_authentication_failed")}},this))},vox_hash_received:function(e){this.vox.loginWithOneTimeKey(config.vox_login,e)},vox_authenticated:function(){if(this.autocall){this.transition("progressing")}else{this.transition("idle")}},vox_authentication_failed:function(){reportException({message:"Vox to authentication failed",fileName:"web_phone.js"});this.transition("connected")},call:function(){this.autocall=true},hangup:function(){this.transition("connected")}},idle:{_onEnter:function(){var e="WebPhoneIdle";if(this.priorState==="authenticating"){e="WebPhoneAuthenticated"}this.emit(e,{name:e})},call:function(){this.transition("progressing")},disconnect:function(){this.vox.disconnect();this.transition("initialized")}},progressing:{_onEnter:function(){this.emit("WebPhoneProgressing",{name:"WebPhoneProgressing"});this.voxCall=this.vox.call(this.agentId,false,"",{"X-jv-sessid":cookie("sess_id")});this.voxCall.addEventListener(VoxImplant.CallEvents.Connected,underscore.bind(function(e){this.handle("vox_call_connected")},this));this.voxCall.addEventListener(VoxImplant.CallEvents.Failed,underscore.bind(function(e){this.handle("vox_call_failed")},this));this.voxCall.addEventListener(VoxImplant.CallEvents.Disconnected,underscore.bind(function(e){this.handle("vox_call_disconnected")},this))},vox_call_connected:function(){this.transition("joined")},vox_call_failed:function(){this.transition("idle")},hangup:function(){this.voxCall.hangup();this.transition("idle")}},joined:{_onEnter:function(){this.emit("WebPhoneJoined",{name:"WebPhoneJoined"})},vox_call_disconnected:function(){this.transition("idle")},hangup:function(){this.voxCall.hangup();this.transition("idle")}},mic_disabled:{_onEnter:function(){this.emit("WebPhoneMicDisabled",{name:"WebPhoneMicDisabled"})}}},setAgentId:function(e){this.agentId=e}});window.onerror=function(e,t,i){reportException({message:e,lineNumber:i,fileName:t})
};var chat_contents={isInit:false,init:function(e,t){log("CHAT_CONTENTS: init",t);if(this.isInit){log("CHAT_CONTENTS already inited.");return}this.isInit=true;this.view_settings={backgroundColor:config.widget_color,borderColor:adjustLightness(config.widget_color,.6,1),isDarkText:config.widget_font_color=="dark",lastClientMessage:null};if(this.view_settings.isDarkText){this.view_settings.shadowCss=adjustLightness(this.view_settings.backgroundColor,1.15,.7)+" 0 1px";this.view_settings.textColor=adjustLightness(this.view_settings.backgroundColor,.1,.5)}else{this.view_settings.shadowCss=adjustLightness(this.view_settings.backgroundColor,.6,1)+" 0 -1px";this.view_settings.textColor="#ffffff"}if(e==="online"){chat_view_online.create(this.view_settings);if(typeof t==="object"&&t.start==="call"&&config.options&128){if(jivo.getCallWidget()){jivo.handle("cw_ping",{title:false,invitation:"jivo_api.open"})}else{this.wpInit()}}}else{chat_view_offline.create(this.view_settings)}if(!jivo.isMobileOrTablet()){this.callWidgetButtonInit()}},updateAgent:function(e){log("updateAgent",e);var t={"agent.id":e.agent_id||false,"agent.avatar":e.avatar_url||null,"agent.name":e.display_name||false,"agent.title":e.title||false,"agent.vox_name":e.vox_name||false,"agent.online":true,"agent.disableAnimation":e.disableAnimation?true:false,"agent.state":e.state};if(e.state&&!jivo.getCallWidget()){t["agent.calls"]=e.state.available_for_calls}else{this.callWidgetButtonInit()}if(jivo.state==="OFFLINE"){chat_view_offline.setChatAttr(t)}else{chat_view_online.setChatAttr(t)}},callInit:function(e){this.callWidgetButtonInit();if(typeof e==="object"&&e.start==="call"){if(jivo.getCallWidget()){jivo.handle("cw_ping",{title:false,invitation:"jivo_api.open"})}else{if(chat_view_online.getChatModel().get("agent.id")){if(chat_view_online.getChatModel().get("agent.calls")){chat_view_online.getCallView().addMessage(translate("c_callProcessing"));chat_view_online.getCallModel().getWebPhone().handle("call")}else{chat_view_online.getCallView().addMessage(translate("lblWebPhoneNotConnected"))}}else{if(config.options&128){this.wpInit()}}}}},callWidgetButtonInit:function(){var e=config.chat_mode==="online"?chat_view_online:chat_view_offline,t=jivo.getCallWidget();if(t&&t.state!=="CALL"){callWidgetPing(function(t){var i=t.show_form?true:false;if(i&&!ie8){jivo.gui.labelButtons.enable()}var n=chat_view_online.getMessagesCollection(),o=0;if(n?n.toJSON().length:0>0){o=underscore.where(n.toJSON(),{type:"clientMessage"}).length}e.setChatAttr({"agent.calls":i,can_enter_phone:!o&&i})})}},expandAfterCall:function(){log("expandAfterCall");this.updateAgent(false);chat_view_online.getChatView().toolbarToggle("show");chat_view_online.getChatView().enableDragging();jivo.gui.handle("maximize")},wpInit:function(){var e=chat_view_online.getCallModel();if(!e.isInit){this.wp_ready_hook=e.getWebPhone().on("WebPhoneAuthenticated",underscore.bind(this.wpReady,this));this.wp_fail_hook=e.getWebPhone().on("WebPhoneMicDisabled",underscore.bind(this.wpFail,this));e.getWebPhone().handle("init");chat_view_online.addConnectionError(translate("lblWaitForOperator"));e.isInit=true}},wpReady:function(){this.wp_ready_hook.off();this.wp_fail_hook.off();this.auto_call=true;jivo.handle("gui_start_call")},wpFail:function(){this.wp_ready_hook.off();this.wp_fail_hook.off();chat_view_online.addConnectionError(translate("lblWebPhoneMicError"))},focusChat:function(e){if(e==="offline"&&chat_view_offline.getFormView()){chat_view_offline.getFormView().inputFocus()}else{chat_view_online.chatMaximized()}},handle:function(e,t,i){log("CHAT_CONTENTS: handling "+e,t,i);switch(e){case"agent_typing":chat_view_online.setChatAttr({"agent.typing":t.typing});break;case"agent_message":chat_view_online.setChatAttr({"agent.typing":false});if(jivo.isVisitorsInsight()){chat_view_online.setChatAttr({inputEnabled:true})}if(t.invitation&&$(".agentMessage").length>0){chat_view_online.hideInvitationMessage()}chat_view_online.addAgentMessage(t.message);jivo.handle("gui_agent_message_ack",[t.msg_id]);if(jivo.isVisitorsInsight()&&$(".connectionError").length>0){chat_view_online.hideConnectionError()}break;case"system_message_email":jivo.handle("gui_email_form_show");chat_view_online.addSystemMessageEmail(t.message);break;case"system_message":chat_view_online.addSystemMessage(t.message);break;case"agent_service_message":handleServiceMessage(t);break;case"invitation":jivo.gui._event_queue.push(["accept",{agent_info:t}]);jivo.gui._event_queue.push(["agent_message",{message:i,invitation:true}]);break;case"accept":this.updateAgent(t.agent_info);if(this.auto_call){this.auto_call=false;chat_view_online.getCallModel().getWebPhone().handle("call")}if(config.contacts_ask===1&&jivo.invitationText){chat_view_online.getIntroduceView().close()}if(config.departments){chat_view_online.getDepartmentsView().close()}break;case"agent_chat_close":var n=[],o=['<input type="button" class="jivoBtn reject reject-chat-btn" id="close-chat-btn" value="'+translate("lnkCloseThisWindow")+'" />'];chat_view_online.hideConnectionError();if(!jivo.isSeparateWindow()){o.unshift('<input type="button" class="jivoBtn accept accept-chat-btn" id="restart-chat-btn" value="'+translate("lnkRestartChat")+'" />')}if(!(t&&t.reason&&t.reason===8)){n.push(translate("lblAgentDisconnected"));n.push(o.join(""));chat_view_online.setChatAttr({inputEnabled:false});chat_view_online.addConnectionError(n.join("<br>"))}chat_view_online.setChatAttr({"agent.calls":false,"agent.typing":false});chat_view_online.getCallModel().getWebPhone().handle("disconnect");$(".reject-chat-btn").on("click",function(){jivo.handle("gui_minimize")});$(".accept-chat-btn").on("click",function(){jivo.handle("gui_resume")});break;case"gui_resume":chat_view_online.setChatAttr({inputEnabled:true});chat_view_online.hideConnectionError();chat_view_online.chatMaximized();break;case"resume_ok":var a=t.agent_info,s=t.client_info;if(typeof a==="object"){a.disableAnimation=true;this.updateAgent(t.agent_info);if(config.departments){chat_view_online.getDepartmentsView().close()}}else{if(config.departments){chat_view_online.getChatModel().set("agent.name",translate("lblConnectedToAgent"))}}chat_view_online.setChatAttr({"client.name":s.name,inputEnabled:true});var r=s.msg_history||[];chat_view_online.resetMessages(r);if(r.length){if(config.contacts_ask===1){chat_view_online.getIntroduceView().close()}if(config.departments){chat_view_online.getDepartmentsView().close()}if(underscore.findWhere(r,{type:"clientMessage"})){chat_view_online.setChatAttr({can_enter_phone:false})}var l=[];underscore.each(r,function(e){if(e.type==="agentMessage"&&!e.ack){l.push(e.msg_id)}},this);if(l.length){setTimeout(function(){jivo.handle("gui_agent_message_ack",l)},0)}}chat_view_online.getChatView().$el.find(".avatar").removeClass("connected");var c=s.cw_call;if(c&&c.status){if(cookie("chat_call")==1){log("handle call status");this.handle(c.status)}else{if(c.status=="cw_connected"){chat_view_online.getChatView().$el.find(".avatar").addClass("connected")}}}else{chat_view_online.getCallBackView().showFormBox();chat_view_online.getCallBackView().hideForm()}break;case"connect_failed":chat_view_online.getCallModel().getWebPhone().handle("disconnect");var o=[{title:translate("lblLeaveMessage"),event:"gui_leave_msg"}];if(utils.hideOffline()){o=[{title:translate("lnkCloseThisWindow"),event:"blacklist"}]}chat_view_msg.instance.models.message.set({msg:translate("lblNoOperators"),buttons:o});chat_view_msg.create(this.view_settings);jivo.gui.setOffline();if(cookie("collapsed")){cookie("collapsed",null);jivo.gui.jivoframecontainer.handle("expand");chat_view_online.getChatView().toolbarToggle("show")}break;case"gui_leave_msg":chat_view_offline.disableDragging();chat_view_offline.create(this.view_settings);break;case"focus_maximize":log("focus_maximize");this.focusChat(t);this.callWidgetButtonInit();break;case"show":this.callInit(t);if(jivo.isClicked){this.focusChat(t)}break;case"maximize":chat_view_online.getMessagesView().setScrollBottom(0);this.callInit(t);break;case"gui_message":this.view_settings.lastClientMessage=t||null;chat_view_online.addClientMessage(t);break;case"offline_success":chat_view_msg.instance.models.message.set({header:translate("lblOfflineMessageSend"),msg:translate("lblThankYouMessage"),buttons:[{title:translate("lnkCloseThisWindow"),event:"gui_minimize"}]});chat_view_msg.create(this.view_settings);chat_view_offline.cap_id=false;if(!jivo.isMobileOrTablet()){jivo.gui.jivoframecontainer.setHeight(jivo.gui.jivoframecontainer.getChatPosition().height)}break;case"offline_captcha":chat_view_offline.captcha(t);break;case"offline_failed":chat_view_msg.instance.models.message.set({header:"An error occured",msg:translate("lblMessageError"),buttons:[{title:translate("lnkCloseThisWindow"),event:"gui_minimize"}]});chat_view_msg.create(this.view_settings);break;case"transferred":chat_view_online.addConnectionError(translate("lblTransferred").replace("_AGENT_",t.agent_info.display_name));this.updateAgent(t.agent_info);break;case"update_agent_info":this.updateAgent(t.agent_info);break;case"cw_wait":if(cookie("chat_call")==1){chat_view_online.getCallBackView().showForm();chat_view_online.getCallBackView().showWait();$("#callme").css("display","block")}else{chat_view_online.setChatAttr({can_enter_phone:false})}if(!($(".callMessage").length>0&&$(".callMessage .callme-start").length==1)){chat_view_online.addCallMessage(translate("cw_call_to")+" "+cookie("phone"),"callme-start")}break;case"cw_connecting":if(cookie("chat_call")==1){chat_view_online.getCallBackView().showConnecting();chat_view_online.getCallBackView().showForm();$("#callme").css("display","block");if(t&&t.state==0){this.updateAgent(t);chat_view_online.getCallBackView().hideForm();chat_view_online.getChatView().toolbarToggle();chat_view_online.getChatView().disableDragging();jivo.gui.jivoframecontainer.setHeight($("#header-avatar").height()+"px")}}else{chat_view_online.setChatAttr({can_enter_phone:false})}break;case"cw_connected":if(chat_view_online.getChatView().$el.find(".avatar").parent().hasClass("has-avatar")){chat_view_online.getChatView().$el.find(".avatar").addClass("connected")}if(cookie("chat_call")==1){chat_view_online.getCallBackView().hideForm();chat_view_online.getCallBackView().callTimer.setTimerNull();if(chat_view_online.getChatModel().get("agent.state")===0){chat_view_online.getChatView().toolbarToggle();chat_view_online.getChatView().disableDragging()}}else{if(jivo.state==="ONLINE"){chat_view_online.setChatAttr({can_enter_phone:false})}else{$("#callme").css("display","none")}}$("#callme").css("display","none");break;case"cw_call_end":$("#callme").show();if(cookie("chat_call")==1){if(chat_view_online.getChatModel().get("agent.state")===0){this.expandAfterCall()}chat_view_online.setChatAttr({inputEnabled:true});chat_view_online.getChatView().$el.find(".avatar").removeClass("connected");chat_view_online.getCallBackView().showCallEnd();cookie("chat_call",null)}else{if(jivo.state==="OFFLINE"){chat_contents.updateAgent(false)}else{if(chat_view_online.getChatModel().get("agent.state")===0){this.expandAfterCall()}chat_view_online.setChatAttr({can_enter_phone:true});chat_view_online.getChatView().$el.find(".avatar").removeClass("connected")}}chat_view_online.addCallMessage(translate("c_callDisconnected"),"callme-end");break;case"cw_show_form":if(!t.show_form){chat_view_online.getCallView().addMessage(translate("lblWebPhoneNotConnected"))}break;case"cw_error":log("chat_contents cw_error",arguments);if(cookie("chat_call")==1||jivo.gui.state=="CHAT"){if(!t)t={};chat_view_online.getChatView().$el.find(".avatar").removeClass("connected");$("#callme").css("display","block");chat_view_online.getCallBackView().showError(t.reason||false);chat_view_online.getCallBackView().callTimer.handle("cancel_timer");cookie("chat_call",false);if(chat_view_online.getChatModel().get("agent.state")===0){this.expandAfterCall()}var d=translate(t.reason);if(!d){d=translate("cw_unableToConnect")+" "+translate("cw_errInfoText")}chat_view_online.addCallMessage(d,"callme-end");cookie("chat_call",null)}else{if(jivo.state==="OFFLINE"){chat_contents.updateAgent(false)}else{chat_view_online.getChatView().$el.find(".avatar").removeClass("connected")}}break;case"update_height":if(!jivo.isMobileOrTablet()){if(i||jivo.state==="OFFLINE"){jivo.gui.jivoframecontainer.expandTo=parseInt(t)>>0}if(jivo.state==="OFFLINE"){jivo.gui.jivoframecontainer.setHeight(t+"px")}else{jivo.gui.setChatHeight(t)}}break;default:log("CHAT_CONTENTS: unhandled "+e,t)}}};function handleServiceMessage(e){switch(e.service){case"file_transfer":if(e.event==="receive_file_request"){chat_view_online.addReceiveFile({fileUrl:e.file_url,fileName:e.file_name,fileId:e.file_id,state:"pending",agentName:chat_view_online.getChatAttr("agent.name")})}break;case"cobrowse":if(e.event==="highlight"){chat_view_online.addCobrowseHighlight({page_url:e.page_url,hash:e.hash,comment:stripBrackets(e.comment),state:"pending"})}break;default:log("CHAT_CONTENTS: unhandled agent_service_message",e)}}window.Jivo={Online:{Models:{},Views:{},Collections:{},Controller:{},MAX_MESSAGE_LENGTH:1e3},Offline:{Models:{},Views:{},Collections:{},Controller:{},MAX_MESSAGE_LENGTH:1200},Message:{Models:{},Views:{},Controller:{}},Model:{},View:{},Collection:{}};Jivo.Model.Field=Backbone.Model.extend({defaults:{formId:"default-form-id"},valid:function(){return!this.required()||this.value().length>0},required:function(){return this.show()&&config.contacts_settings[this.id].required},show:function(){return config.contacts_settings[this.id].show},value:function(){var e=$("#"+this.get("formId")).find("#"+this.id);if(e.length===0){return""}else{return $.trim(e.val())}}});Jivo.Model.Email=Jivo.Model.Field.extend({id:"email",valid:function(){var e=this,t=e.value();return t.length===0&&!e.required()||utils.isValidValue_email(t)}});Jivo.Model.Phone=Jivo.Model.Field.extend({id:"phone",valid:function(){var e=this,t=e.value();return t.length===0&&!e.required()||utils.isValidValue_phone(t)}});Jivo.Model.Name=Jivo.Model.Field.extend({id:"name"});Jivo.Model.Message=Jivo.Model.Field.extend({id:"message"});Jivo.Model.Error=Backbone.Model.extend({defaults:{name:"",messages:[]},idAttribute:"name"});Jivo.Collection.Errors=Backbone.Collection.extend({model:Jivo.Model.Error});Jivo.View.Form=Backbone.View.extend({events:{"click #submit":"submit","click #cancel":"cancel","keydown input:text,textarea":"onKeyDown"},initialize:function(){this.collection=new Jivo.Collection.Errors;this.collection.on("add",this.onErrorAdd,this);this.collection.on("remove",this.onErrorRemove,this);this.collection.on("reset",this.onReset,this);this.initializeSpecial()},initializeSpecial:function(){},valid:function(){var e=this;e.fields.each(function(t){if(t.valid()){e.collection.remove(t.id)}else{e.collection.add({name:t.id,messages:[]})}},e);return!e.collection.length},toggleError:function(e,t){var i=this;if(t){i.$("#"+e).parent().addClass("error-field")}else{i.$("#"+e).parent().removeClass("error-field")}},updateHeight:function(e){jivo.handle("update_height",this.getHeight(),e)},getHeight:function(){return 0},onErrorAdd:function(e){log("onErrorAdd");this.toggleError(e.get("name"),true)},onErrorRemove:function(e){log("onErrorRemove");this.toggleError(e.get("name"),false)},onReset:function(e,t){underscore.each(t.previousModels,function(e){this.toggleError(e.get("name"),false)},this)},onKeyDown:function(e){var t=this,i=$(e.target).attr("id");t.collection.remove(i);if(e.keyCode===13&&(e.target.tagName==="INPUT"||e.target.tagName==="TEXTAREA"&&!hasClass(e.target,"offline-message"))){e.preventDefault();t.submit()}}});Jivo.Offline.Models.Form=Backbone.Model.extend({defaults:{templateData:{type:config.widget_font_color,header:config.offline_form_title||config.offline_widget_label,text:config.offline_form_text,link:translate("lblPwrBy").replace("_URL_","?utm_source="+encodeURIComponent(location.hostname)+"&utm_medium=link&utm_content=offline_form&utm_campaign=self_ad"),nologo:!utils.showAd(),maxMessageLength:Jivo.Offline.MAX_MESSAGE_LENGTH,locale:getIconLocale(),agent:{id:2,name:config.offline_form_title||config.offline_widget_label,title:"",avatar:false,typing:false,online:false,disableAnimation:false,calls:false}}}});Jivo.Offline.Models.Error=Backbone.Model.extend({defaults:{name:"",messages:[]},idAttribute:"name"});Jivo.Offline.Collections.Errors=Backbone.Collection.extend({model:Jivo.Offline.Models.Error});Jivo.Offline.Models.Email=Jivo.Model.Email.extend({show:function(){return config.contacts_settings.email.show||this.phoneNotRequired()},required:function(){return config.contacts_settings.email.show&&config.contacts_settings.email.required||this.phoneNotRequired()},phoneNotRequired:function(){return!config.contacts_settings.phone.show||!config.contacts_settings.phone.required}});Jivo.Offline.Models.Message=Jivo.Model.Field.extend({id:"message",required:function(){return true},show:function(){return true}});Jivo.Offline.Views.Form=Jivo.View.Form.extend({el:"#inner-chat",tagName:"div",template:_templates.offline.form,height:362,inited:false,events:{"click #submit":"submit","click #cancel":"cancel",'keydown input:text,input[type="tel"],input[type="email"],textarea':"onKeyDown","input  #message":"messageInput","keydown input.cap_symbols":"capthaInput"},fields:new Backbone.Collection([new Jivo.Offline.Models.Message({formId:"inner-chat"}),new Jivo.Offline.Models.Email({formId:"inner-chat"}),new Jivo.Model.Phone({formId:"inner-chat"}),new Jivo.Model.Name({formId:"inner-chat"})]),initializeSpecial:function(){this.model.on("change:agent.calls",this.updateCallMe,this);this.model.on("change:templateData.header",this.updateHeader,this);this.model.on("change:templateData.text",this.updateText,this)},capthaInput:function(){this.$el.find(".captcha-container").removeClass("captcha-empty")},render:function(e,t){log("RENDER OFFLINE FORM",e,t);var i=this.model.get("templateData");i.fields=this.fields;this.$el.html(this.template(i));this.$el.addClass("offline");this.inited=true;this._actionButtonData={mobile:"desktop"};$(".jivo-desktop",parent.document).remove();$("#jivo-mouse-tracker",parent.document).remove();$("#jivo-drag-handle",parent.document).remove();$("#jivo-iframe-container",parent.document).append(_templates.actionButton(this._actionButtonData)).append(_templates.dragHandle());if(!jivo.isSeparateWindow()&&!jivo.isMobileOrTablet()){jivo.gui.jivoframecontainer.closeButton=window.parent.document.getElementById("jivo_action")}chat_view_offline.disableDragging();$("#jivo_action #jivo_close_button",parent.document).on("click",function(e){e.preventDefault();if(jivo.gui.state=="CALLWIDGET"){chat_view_online.getChatView().toolbarToggle();jivo.gui.handle("minimize")}else{chat_view_online.chatMinimized()}});if(!jivo.isSeparateWindow()&&!jivo.isTablet()){this.close_button=$("#jivo_close_button",parent.document);if(ie8){this.toolbarToggle("show")}$("#jivo-iframe-container",parent.document).mouseenter(underscore.bind(this.toolbarToggle,this,"show")).mouseleave(underscore.bind(this.toolbarToggle,this,"hide"))}$("input[placeholder], textarea[placeholder]").placeholder();if(utils.browser.msie&&utils.browser.mV<9){this.$("#message").on("keydown paste",underscore.bind(this.messageInput,this))}if(jivo.isSeparateWindow()){this.$el.on("focus blur","input[type=text],input[type=tel],input[type=email],textarea",JivoGui.handleSoftKeyboard)}if(e){$("#offline-form-inner").find(".description, .message, #email, #name, #phone, .buttons").hide();var n=$(".captcha-container");n.show();n.find("img").attr("src",config.avatar_url+"/captcha/"+e+".png");if(t){n.addClass("captcha-error").addClass("captcha-empty");n.find(".error").css("display","block")}n.find("#resend").on("click",underscore.bind(this.submit,this));$("#cancelCap").show().on("click",underscore.bind(this.cancelCaptcha,this));setTimeout(function(){$(".cap_symbols").focus()},0)}else{if(!jivo.isMobileOrTablet()&&jivo.gui.state==="CHAT"){jivo.gui.jivoframecontainer.setHeight(jivo.gui.jivoframecontainer.getOfflineFormHeight())}}if(chat_contents.view_settings.lastClientMessage){this.$el.find("#message").val(chat_contents.view_settings.lastClientMessage)}setTimeout(function(){if(ie8||ie9){$("#header-animate-container").css({marginTop:0})}else{$("#header-animate-container").addClass("header-animate")}},0);return this},updateHeader:function(){$(".agent-name").text(this.model.get("templateData.header"))},updateText:function(){$("#offline-form-fields").find(".description").text(this.model.get("templateData.text"))},inputFocus:function(){var e=this.$el.find("#message");setTimeout(function(){e.focus()},0);return e},messageInput:function(e){setTimeout(underscore.bind(function(){var e=$(this).attr("maxlength");if($(this).val().length>e){$(this).val($(this).val().substring(0,e))}},e.currentTarget),0)},submit:function(){if(this.valid()){var e={};this.fields.each(function(t){e[t.id]=t.value()},this);if(chat_view_offline.cap_id){e.cap_id=chat_view_offline.cap_id;e.cap_symbols=$(".cap_symbols").val();if(e.cap_symbols==""){this.$el.find(".captcha-container").addClass("captcha-empty");return}}jivo.handle("gui_offline_message",e)}else{this.requestRedraw();chat_view_offline.instance.views.form.el.scrollTop=0}},cancel:function(e){e.preventDefault();if(jivo.isTablet()&&jivo.isSeparateWindow()){window.close()}else if(jivo.isMobile()){history.back()}else{$("#jivo-iframe-container",parent.document).removeClass("jivo-no-transition");jivo.handle("gui_minimize")}},cancelCaptcha:function(){chat_view_offline.cap_id=false;this.$el.find(".captcha-container").hide();$("#cancelCap").hide();$("#offline-form-inner").find(".description, .message, #email, #phone, #name, .buttons").show()},getHeight:function(){return parseInt(jivo.gui.jivoframecontainer.getOfflineFormHeight())},toolbarToggle:function(e,t){if(!window)return;var i=this.close_button;if(i.hasClass("jivo_close_disabled")){i.fadeOut(500);return}i.finish();if(e==="show"){i.fadeIn(250)}else{i.fadeOut(250)}},disableClose:function(){$("#jivo_close_button",parent.document).hide().addClass("jivo_close_disabled")},enableClose:function(){$("#jivo_close_button",parent.document).removeClass("jivo_close_disabled")},requestRedraw:function(){var e=this.$("#offline-form-inner")[0];e.style.display="none";e.offsetHeight;e.style.display="block"},updateCallMe:function(){if(jivo.getCallWidget()&&this.model.get("agent.calls")){$("#header-avatar").addClass("avatar-with-icon");this.$el.find("#callme").show()}else{this.$el.find("#callme").hide();$("#header-avatar").removeClass("avatar-with-icon")}}});var chat_view_offline=Jivo.Offline.Controller=new function(){var e,t;this.instance={models:{form:new Jivo.Offline.Models.Form,error:new Jivo.Offline.Models.Error},collections:{errors:false},views:{form:false}};this.create=function(e){this.instance.collections.errors=new Jivo.Offline.Collections.Errors;this.instance.views.form=new Jivo.Offline.Views.Form({model:this.instance.models.form,collection:this.instance.collections.errors});this.instance.views.form.render();this.getCallView().render()};this.captcha=function(e){this.instance.views.form.render(e.cap_id,chat_view_offline.cap_id&&e.cap_id===chat_view_offline.cap_id);chat_view_offline.cap_id=e.cap_id};this.getHeight=function(){return this.instance.views.form.getHeight()};this.chatMinimized=function(){if(this.instance.views.form.collection){this.instance.views.form.collection.reset()}jivo.handle("gui_minimize")};this.getFormView=function(){if(!e){e=this.instance.views.form}return e};this.getCallView=function(){if(!t){t=new Jivo.Online.Views.Call({model:this.instance.views.form})}return t};this.setChatAttr=function(){return proxy(this.instance.models.form,"set",arguments)};this.disableDragging=function(){if(!jivo.isSeparateWindow()){$("#jivo-drag-handle",window.parent.document).hide()}}};Jivo.Online.Models.Chat=Backbone.Model.extend({defaults:{templateData:{pencilTitle:translate("lblPencilHint"),pencilSource:config.base_url+"/images/pencil.gif",callMe:translate("lblCallMe"),hangUp:translate("hangUp"),lblHangUpShort:translate("lblHangUpShort"),lblEvaluatePlease:translate("lblEvaluatePlease"),lblEvaluateThanks:translate("lblEvaluateThanks"),lblEvaluateCancel:translate("lblEvaluateCancel"),link:translate("lblPwrBy").replace("_URL_","?utm_source="+encodeURIComponent(location.hostname)+"&utm_medium=link&utm_content=offline_form&utm_campaign=self_ad"),nologo:!utils.showAd(),maxMessageLength:Jivo.Online.MAX_MESSAGE_LENGTH,locale:getIconLocale()},client:{id:1,name:cookie("client_name"),phone:cookie("phone"),email:cookie("email"),title:false,avatar:false,typing:false},agent:{id:null,name:translate("lblConnectedToAgent"),title:translate("lblOperatorsOnline"),avatar:false,calls:false,typing:false,online:false,disableAnimation:false,state:false},can_enter_phone:config.callback_widget?true:false,inputEnabled:true,evaluate:false,"size.height":362,"size.min-height":300,"size.width":267,"textarea.height":32,"textarea.width":226,"position.left":0,"position.right":0,"coordinates.x":0,"coordinates.y":0,"coordinates.dx":0,"coordinates.dy":0},initialize:function(){var e;if(jivo.isMobileOrTablet()){e=translate("lblMessageHere")}else if(jivo.getCallWidget()){e=translate("lblEnterMessageOrPhoneHere")}else{e=translate("lblEnterMessageHere")}this.defaults.templateData.lblEnterMessageHere=e},introduced:cookie("client_name")!==null||cookie("phone")!==null||cookie("email")!==null||false});Jivo.Online.Views.Chat=Backbone.View.extend({el:"#inner-chat",tagName:"div",previousScroll:0,template:_templates.online.chat,headerTimeout:[],events:{"keypress   #input-field":"inputFieldKeyPress","click      #input-button":"inputButtonClick","focusin    #input-field":"inputFieldFocus","input      #input-field":"messageInput","click      #header-avatar":"avatarClick"},initialize:function(){this.model.on("change:agent.name",this.setHeaderName,this);this.model.on("change:agent.title",this.setAgentTitle,this);this.model.on("change:agent.typing",this.agentTyping,this);this.model.on("change:agent.avatar",this.setAgentImage,this);this.model.on("change:client.typing",this.clientTyping,this);this.model.on("change:inputEnabled",this.setInputMode,this);this.model.on("change:agent.calls",this.updateCallMe,this);this.model.on("change:can_enter_phone",this.placeholderChange,this);if(config.typing_insight==1){setInterval(underscore.bind(this.notifyInputChanged,this),1e3)}},handleTyping:function(e){this.model.set({"client.typing":e})},lastInputValue:"",notifyInputChanged:function(){var e=this.$el.find("#input-field").val();if(this.lastInputValue!=e){jivo.handle("gui_typing_insight",e);this.lastInputValue=e}},avatarClick:function(e){log("avatarClick");if(e){e.stopPropagation();this.inputFocus()}if(jivo.isMobileOrTablet()||jivo.state=="OFFLINE"){return}if(cookie("chat_call")=="1"&&chat_view_online.getChatModel().get("agent.state")===0||!cookie("collapsed")){log("This is offline agent on chat call.");return}var t=$("#introduce-form");if(!(t.length&&t.is(":visible"))){chat_view_online.getChatView().enableDragging()}setTimeout(function(){chat_view_online.getChatView().toolbarToggle("show")});cookie("collapsed",null);jivo.gui.jivoframecontainer.setTransition(true);jivo.gui.jivoframecontainer.animate("expand");removeClass(jivo.gui.jivoframecontainer.element,"jivo-chat-state-collapsed")},render:function(){var e=this.$el;e.append(this.template(this.model.toJSON()));this.model.set("agent.name",translate("lblConnectedToAgent"));this.inputAutoResize();if(jivo.isSeparateWindow()){e.on("focus blur","input[type=text],input[type=tel],input[type=email],textarea",JivoGui.handleSoftKeyboard)}this._actionButtonData={mobile:"desktop"};$(".jivo-desktop",parent.document).remove();$("#jivo-mouse-tracker",parent.document).remove();$("#jivo-drag-handle",parent.document).remove();$("#jivo-iframe-container",parent.document).append(_templates.actionButton(this._actionButtonData));$("#jivo-iframe-container",parent.document).append(_templates.dragHandle());if(!jivo.isMobileOrTablet()){jivo.gui.jivoframecontainer.closeButton=window.parent.document.getElementById("jivo_action");jivo.gui.jivoframecontainer.dragHandle=window.parent.document.getElementById("jivo-drag-handle")}var t=jivo.getCallWidget(),i=document.getElementById("header-avatar");$("#jivo_action #jivo_close_button",parent.document).off("click").on("click",function(e){e.preventDefault();if(!jivo.isMobile()){removeClass(jivo.gui.jivoframecontainer.element,"jivo-no-transition")}if(chat_view_online.getChatModel().get("agent.id")&&!jivo.isMobileOrTablet()&&jivo.state!="OFFLINE"){chat_view_online.getChatView().disableDragging();chat_view_online.getChatView().toolbarToggle();if(jivo.gui.state=="CALLWIDGET"){t.hideCallWidget();jivo.gui._chatDiv.style.display="block";jivo.gui._chatDiv.style.visibility="visible";chat_view_online.getChatButton().show()}else{addClass(i,"expanded");$("#callme-form").hide()}jivo.gui.jivoframecontainer.setHeight("70px");addClass(jivo.gui.jivoframecontainer.element,"jivo-chat-state-collapsed");cookie("collapsed",1)}else{if(jivo.gui.state=="CALLWIDGET"){chat_view_online.getChatView().toolbarToggle();jivo.gui.handle("minimize")}else{chat_view_online.chatMinimized()}}});if(!jivo.isMobileOrTablet()){$("#jivo-chat").jivoDragEvent({handler:$("#jivo-drag-handle",window.parent.document),tracker:$("#jivo-mouse-tracker",window.parent.document)}).bind("jivo.drag.init",$.proxy(this,"startResize")).bind("jivo.drag.move",$.proxy(this,"resize")).bind("jivo.drag.stop",$.proxy(this,"stopResize"))}$("input[placeholder], textarea[placeholder]").placeholder();if(!jivo.isMobileOrTablet()&&!jivo.isSeparateWindow()){$(jivo.getPageWindow()).on("resize",underscore.bind(this.windowResize,this))}$("#messages-div-outer").on("scroll",underscore.bind(this.messagesScroll,this));if(utils.browser.msie&&utils.browser.mV<9){this.$("#input-field").on("keydown paste",underscore.bind(this.messageInput,this))}if(devicejs.ios()){$("#messages-div-inner").on("touchmove",function(){var e=$("#input-field");if(e.is(":focus")){e.trigger("blur")}})}this.requestRedraw();if(1===config.contacts_ask){this.showIntroduceForm(true)}else if(config.departments){this.showDepartmentsSelector()}return this},inputFocus:function(){var e=this.$el.find("#input-field"),t;setTimeout(function(){t=$("#introduce-form");if(!jivo.isSeparateWindow()){if(t.length&&t.is(":visible")){if(chat_view_online.getChatModel().introduced){e=t.find("#message")}else{e=t.find(".input-field:empty").first()}}e.focus()}},0);return e},inputAutoResize:function(){this.$el.find("#input-field").autoResize({extraSpace:jivo.isMobileOrTablet()?12:0,animate:false,maxSize:65,minSize:"original",onResize:underscore.bind(this.updateMessage,this),onAfterResize:underscore.bind(this.updateMessage,this)}).typing({start:underscore.bind(this.handleTyping,this,1),stop:underscore.bind(this.handleTyping,this,0),delay:5e3})},setHeaderName:function(){var e=this.$el,t=this.model.get("agent.name")?this.model.get("agent.name"):translate("lblConnectedToAgent"),i=this.model.get("agent.title")?this.model.get("agent.title"):translate("lblOperatorsOnline"),n=e.find("#header-animate-container"),o;for(o=this.headerTimeout.length;o--;){clearTimeout(this.headerTimeout[o])}n.removeClass("header-animate");if(this.model.get("agent.disableAnimation")){e.find(".header-animate-info").find(".agent-name").text(t);this.setAgentTitle()}else{e.find(".header-animate-first").find(".agent-name").text(t);e.find(".header-animate-first").find(".title").text(i);this.headerTimeout[0]=setTimeout(function(){n.addClass("header-animate")},0);this.headerTimeout[1]=setTimeout(function(){e.find(".header-animate-second").find(".agent-name").text(t);e.find(".header-animate-second").find(".title").text(i)},400);if(!jivo.isMobileOrTablet()){this.headerTimeout[2]=setTimeout(function(){n.removeClass("header-animate")},1500)}}$("#agent-typing").empty();this.agentTyping()},setAgentTitle:function(){var e=this.model.get("agent.title")?this.model.get("agent.title"):translate("lblOperatorsOnline");
this.$el.find(".title").text(e)},setAgentImage:function(){var e=this.$el.find(".avatar");e.find("img").remove();e.find(".light-avatar, .dark-avatar").remove();if(config.options&32){e.parent().addClass("has-avatar");if(config.widget_color&&!isLightColor(config.widget_color)){e.append($("<div class='dark-avatar'/>"));if(this.model.get("agent.avatar")!==null){e.find(".dark-avatar").append($("<img/>",{src:config.avatar_url+"/avatars/"+this.model.get("agent.avatar")}))}}else{e.append($("<div class='light-avatar'/>"));if(this.model.get("agent.avatar")!==null){e.find(".light-avatar").append($("<img/>",{src:config.avatar_url+"/avatars/"+this.model.get("agent.avatar")}))}}}},setInputMode:function(){var e=this.model.get("inputEnabled"),t=chat_view_online.getMessagesView(),i=t.getScrollBottom();this.$("#input-div").css("visibility",e?"visible":"hidden");this.$("#messages-div").css("bottom",e?80:0);t.setScrollBottom(i)},agentTyping:function(){var e=$("#agent-typing");if(this.model.get("agent.typing")){if(e.is(":empty")){e.append(_templates.online.typing({agentName:this.model.get("agent.name")}))}e.show()}else{e.hide()}},clientTyping:function(){chat_view_online.typing(this.model.get("client.typing"))},inputFieldKeyPress:function(e){if(e.keyCode===13){e.preventDefault();if(!this.model.get("agent.state")&&cookie("chat_call")==1){return}this.inputSendMessage(e.currentTarget.value,$(e.currentTarget),$("#input-button")[0])}},inputButtonClick:function(e){if(jivo.isTablet()&&!jivo.isSeparateWindow()){e.preventDefault();jivo.handle("gui_answer_proactive")}else{var t=$("#input-field");this.inputSendMessage(t.val(),t,$(e.currentTarget)[0])}},inputSendMessage:function(e,t,i){if($.trim(e).length!==0){var n=this.model.get("can_enter_phone");this.model.set("can_enter_phone",false);t.val("");if(n&&jivo.getCallWidget()&&!jivo.isMobileOrTablet()&&utils.isValidValue_mobilePhone(e)){jivo.handle("cw_ping");jivo.cw.callwidget.handle("setPhoneNumber",e.replace(/[^0-9]/gim,""));return}if(!chat_view_online.getChatModel().introduced&&(jivo.invitationText||jivo.isMobileOrTablet())&&1===config.contacts_ask){if(jivo.isMobileOrTablet()){t.blur()}this.showIntroduceForm(false,e)}else{Jivo.Online.Controller.sendMessage(e)}t.css("height","");i.disabled=true;this.updateMessage();if(devicejs.ios()){log("inputSendMessage init sound for ios.",devicejs.ios());chat_view_online.initSound()}}},inputFieldFocus:function(e){Jivo.Online.Controller.onFocus();if(devicejs.ios()){var t=$(e.target);t.on("focus",function(){$(document).unbind("scroll.on_focus");setTimeout(function(){$(document).bind("scroll.on_focus",function(e){t.trigger("blur")})},1500)});t.on("blur",function(){$(document).unbind("scroll.on_focus")})}},windowResize:function(){if(jivo.isMobileOrTablet()||!window)return;_window=jivo.getPageWindow();var e=_window.innerWidth||_window.document.documentElement.clientWidth||_window.document.body.clientWidth;var t=parseInt(jivo.gui.widget.widgetWidth)+10;var i=e-t;if(jivo.gui.state==="WIDGET"||!jivo.gui.jivoframecontainer||!jivo.gui.jivoframecontainer.element.getBoundingClientRect()){return}var n=jivo.gui.jivoframecontainer.element.getBoundingClientRect().left;if(n<30){jivo.gui.jivoframecontainer.element.style.left="30px";jivo.gui.jivoframecontainer.element.style.right="auto"}if(n>i){jivo.gui.jivoframecontainer.element.style.left="auto";jivo.gui.jivoframecontainer.element.style.right="30px"}},messagesScroll:function(){this.previousScroll=chat_view_online.getMessagesView().getScrollBottom()},messageInput:function(e){var t=e.currentTarget,i=e.currentTarget.value,n=$("#input-button")[0];setTimeout(underscore.bind(function(){var e=$(this).attr("maxlength");if($(this).val().length>e){$(this).val($(this).val().substring(0,e))}},t),0);n.disabled=i.length<=0},showIntroduceForm:function(e,t){log("showIntroduceForm",e,t);chat_view_online.getIntroduceView().render(e,t)},showDepartmentsSelector:function(){chat_view_online.getDepartmentsView().render();this.disableDragging()},updateCallMe:function(){log("updateCallme");if((chat_view_online.getCallModel().rtcSupported()||jivo.getCallWidget())&&this.model.get("agent.calls")&&(chat_view_online.getChatModel().introduced||config.contacts_ask!=1)){this.$el.find("#callme").css("display","block");this.$el.find(".title").css("width","75%")}else{if(chat_view_online.getCallModel().calling()){return}if(cookie("chat_call")==1){chat_view_online.getCallBackView().hidePin()}this.$el.find("#callme").css("display","none");this.$el.find(".title").css("width","100%")}},enableDragging:function(){if(!jivo.isSeparateWindow()){$("#jivo-drag-handle",window.parent.document.body).css("display","block")}},disableDragging:function(){if(!jivo.isSeparateWindow()){$("#jivo-drag-handle",window.parent.document.body).css("display","none")}},toolbarToggle:function(e){if(!jivo.isSeparateWindow()){var t=$("#jivo_action",window.parent.window.document.body);t.finish();if(e==="show"){t.fadeIn(250)}else{t.fadeOut(250)}}},requestRedraw:function(){var e=document.getElementById("inner-chat");e.style.display="none";e.offsetHeight;e.style.display="block"},startResize:function(e){var t=getElementPosition($("#jivo-iframe-container",window.parent.document.body)[0]);t.minLeft=30;t.maxLeft=$(window.parent).width()-t.width-30;if($("#introduce-popup").length>0){this.model.set("size.min-height",300+$("#introduce-popup").outerHeight())}else{this.model.set("size.min-height",300)}t.minHeight=this.model.get("size.min-height");t.maxHeight=$(window.parent).height();chat_view_online.getMessagesView().setScrollBottom(0);this._dragData=t},stopResize:function(e){var t=$("#jivo-iframe-container",window.parent.document.body);t.removeClass("jivo-no-transition");cookie("left",t.css("left"));cookie("right",t.css("right"));cookie("height",t.css("height"));delete this._dragData},resize:function(e){var t=this._dragData,i=t.left+e.dx,n=t.height-e.dy,o,a,s=$("#jivo-iframe-container",window.parent.document.body);s.addClass("jivo-no-transition");i=Math.max(t.minLeft,Math.min(t.maxLeft,i));n=Math.max(t.minHeight,Math.min(t.maxHeight,n));if(i!==e.currentTarget.offsetLeft){o=t.windowWidth-t.width-i;s.css({left:i,right:o,marginLeft:0,marginRight:0})}if(n!==this.model.get("size.height")&&(n>this.model.get("size.min-height")||n>this.model.get("size.height"))){this.model.set("size.height",n);jivo.transferProportion({width:s.css("width"),height:s.css("height")});s.css({height:n});if(navigator.userAgent.indexOf("Opera")>=0){this.requestRedraw()}chat_view_online.getMessagesView().setScrollBottom(0)}},updateMessage:function(){var e=this.model.get("inputEnabled"),t=chat_view_online.getMessagesView(),i=t.getScrollBottom();this.$("#input-div").css("visibility",e?"visible":"hidden");if(jivo.isMobileOrTablet()){this.$("#messages-div").css("bottom",e?$("#input-div").outerHeight():0)}else{this.$("#messages-div").css("bottom",e?80:0)}t.setScrollBottom(i,true)},placeholderChange:function(){if(!this.model.get("can_enter_phone")){var e=this.$("#input-field");if(jivo.isMobileOrTablet()){e.attr("placeholder",translate("lblMessageHere"))}else{e.attr("placeholder",translate("lblEnterMessageHere"))}if(utils.browser.msie&&utils.browser.version<10){e.val("")}}}});Jivo.Online.Views.Evaluation=Backbone.View.extend({el:"#chat-body",template:_templates.online.evaluation,events:{"click #evaluation-popup .evaluation-btn-container a":"sendRate"},render:function(){this.$el.append(this.template({}));var e=this.$("#evaluation-popup");if(jivo.gui.animationIsSupported()){e.addClass("jivo-fade-in")}else{e.css("opacity","1");e.show()}},sendRate:function(e){e.preventDefault();var t=e.currentTarget.id,i,n,o,a,s;function r(e){setTimeout(function(){chat_view_online.getMessagesView().evaluationMessageIsShow=false},e)}i=translate("lblEvaluate"+(t==="cancel"?"Please":"Thanks"));n=this.$(".evaluation-text");o=this.$(".evaluation-btn-container");a=this.$("#evaluation-popup #cancel");s=this.$("#evaluation-popup");n.find(".evaluation-text-inner").html(i);o.toggleClass("hidden visible");var l;if(t==="cancel"){if(this.evaluationTimeout){clearTimeout(this.evaluationTimeout)}n.show();s.removeClass("last-step");o.removeClass("negative");l=0}else if(t==="close-eval"){this.evaluationTimeout=setTimeout(underscore.bind(this.hideEvaluation,this),100);r(400);this.$("#positive, #negative, .evaluation-text-inner, #close-eval, #cancel").hide();o.removeClass("negative");return}else{this.evaluationTimeout=setTimeout(underscore.bind(this.hideEvaluation,this),15e3);r(15300);s.addClass("last-step");if(t==="positive"){a.addClass("hidden");l=1}else{n.hide();a.removeClass("hidden");o.addClass("negative");l=-1}}chat_view_online.getChatView().inputFocus();jivo.handle("gui_evaluation",l,cookie("sess_id"));e.preventDefault()},hideEvaluation:function(){var e=this.$("#evaluation-popup");if(jivo.gui.animationIsSupported()){e.removeClass("jivo-fade-in");e.addClass("jivo-fade-out")}else{e.css("opacity","0");e.hide()}e.find(".evaluation-text-inner").removeClass("last-step")}});var MessageModel=Jivo.Online.Models.Message=Backbone.Model.extend({defaults:function(){return{text:"",time:new Date,delivered:true,priority:0,color:config.bubble_color}},isAgent:function(){return underscore.indexOf([MessageModel.TYPE_AGENT,MessageModel.TYPE_COBROWSE_HIGHLIGHT,MessageModel.TYPE_RECEIVE_FILE],this.get("type"))>=0},isClient:function(){return this.get("type")===MessageModel.TYPE_CLIENT},isHistory:function(){return!!this.get("history")},isReceiveFile:function(){return this.get("type")===MessageModel.TYPE_RECEIVE_FILE},isSystem:function(){return this.get("type")===MessageModel.TYPE_SYSTEM},isConnectionError:function(){return this.get("type")===MessageModel.TYPE_CONNECTION_ERROR},isCall:function(){return this.get("type")===MessageModel.TYPE_CALL}},{TYPE_AGENT:"agentMessage",TYPE_CLIENT:"clientMessage",TYPE_SYSTEM:"systemMessage",TYPE_SYSTEM_EMAIL:"systemMessageEmail",TYPE_RECEIVE_FILE:"receiveFile",TYPE_CONNECTION_ERROR:"connectionError",TYPE_COBROWSE_HIGHLIGHT:"cobrowse_highlight",TYPE_CALL:"callMessage"});var MessagesCollection=Jivo.Online.Collections.Messages=Backbone.Collection.extend({model:MessageModel,addMessage:function(e,t){log("addMessage",e,t);if(jivo.state!=="OFFLINE"&&jivo.gui.state==="CHAT"&&!jivo.isMobileOrTablet()&&($(jivo.gui.jivoframecontainer.element).hasClass("jivo-chat-state-collapsed")||cookie("collapsed"))){chat_view_online.getChatView().avatarClick()}this.push(underscore.extend({},t,{type:e}))},addAgentMessage:function(e){return this.addMessage(MessageModel.TYPE_AGENT,{text:e})},addClientMessage:function(e){return this.addMessage(MessageModel.TYPE_CLIENT,{text:e})},addSystemMessage:function(e){return this.addMessage(MessageModel.TYPE_SYSTEM,{text:e})},addSystemMessageEmail:function(e){return this.addMessage(MessageModel.TYPE_SYSTEM_EMAIL,{text:e})},addConnectionError:function(e){return this.addMessage(MessageModel.TYPE_CONNECTION_ERROR,{text:e})},addReceiveFile:function(e){return this.addMessage(MessageModel.TYPE_RECEIVE_FILE,e)},addCobrowseHighlight:function(e){return this.addMessage(MessageModel.TYPE_COBROWSE_HIGHLIGHT,e)},addCallMessage:function(e,t){log("addCallMessage",e,t);return this.addMessage(MessageModel.TYPE_CALL,{text:e,icon:t})}});Jivo.Online.Views.Message=Backbone.View.extend({el:"#messages-div-inner",$lastMessage:null,$clearDiv:null,scrollBottomThreshold:20,messagesBeforeEvaluation:5,$parent:null,events:{"click .cobrowse-btn-container a":"openHighlight","click .cobrowse-btn-container":"openHighlight","click .receiveFile a":"declineFile","click .save-chat-email_button":"sendEmailInChat","keypress .save-chat-email_input":"sendEmailInChat"},evaluationMessageIsShow:false,initialize:function(){this.$lastMessage=this.$(".new-msg-container");this.$clearDiv=this.$("#messages-div-inner-clear");this.$parent=this.$el.parent();this.listenTo(this.collection,"add",this.handleAdd).listenTo(this.collection,"reset",this.handleReset)},render:function(){this.$parent.perfectScrollbar({topMargin:utils.showAd()?40:5});if(navigator.userAgent.indexOf("Opera")>=0){var e=this;setTimeout(function(){e.collection.add({type:"emptyMessage",time:new Date,history:false})},200)}},updateScrollBar:function(){this.$parent.perfectScrollbar("update")},getScrollBottom:function(){return $(this.el).css("bottom")},setScrollBottom:function(e,t){if(t){return}$(this.el).css({bottom:-e,top:"auto"});this.$parent.perfectScrollbar("scroll");this.updateScrollBar()},setScrollMobileBottom:function(){document.body.scrollTop=1e4;this.$parent.perfectScrollbar("scroll")},renderMessage:function(e){var t=e.get("type"),i=!e.isConnectionError()&&!e.isSystem()&&!e.isReceiveFile()&&!e.isCall(),n,o=this.$lastMessage;if(i&&o&&o.hasClass(t)){n=_templates.online.messageNode({type:t,text:e.get("text"),history:e.get("history")});o.find(".new-msg-body-inner").append(n);o.find(".new-time").text(dateFormat(e.get("time"),"H:MM"))}else{n=_templates.online[t](e.toJSON());o=this.$lastMessage=$(n).insertBefore(this.$clearDiv)}if(t==="systemMessageEmail"&&!cookie("email")){chat_view_online.getIntroducePopupView().close();this.$lastMessage.find("input").focus()}setTimeout(function(){if(!e.get("history")){if(t==="agentMessage"||t==="clientMessage"||t==="cobrowse_highlight"){o.find(".new-msg-text").each(function(){var e=$(this);e[0].style.height=e.find(".new-msg-text-inner")[0].clientHeight+"px";if(!css3AnimationIsSupported()){e[0].className+=" new-msg-text-history"}});o.addClass("new-msg-animate")}}},0)},isIntroduceRequired:function(){if(cookie("client_name")===null&&chat_view_online.getIntroduceView().fields.get("name").required()){return true}if(cookie("phone")===null&&chat_view_online.getIntroduceView().fields.get("phone").required()){return true}if(cookie("email")===null&&chat_view_online.getIntroduceView().fields.get("email").required()){return true}return!chat_view_online.getChatModel().introduced},isEvaluationRequired:function(){function e(e){return!e.isHistory()&&(e.isClient()||e.isAgent())}return config.show_rate_form&&config.options&64&&!this.evaluationMessageIsShow&&this.collection.filter(e).length>=this.messagesBeforeEvaluation},handleAdd:function(e){var t=e.get("type"),i;i=this.getScrollBottom();this.renderMessage(e);if(i==="auto"&&t!="agentMessage"){this.setScrollBottom(0);this.updateScrollBar()}this.trigger("message",this,e);if(e.isAgent()){jivo.soundPlayer.incomingMessage()}else if(e.isClient()&&this.isIntroduceRequired()&&config.contacts_ask<=0){chat_view_online.getIntroducePopupView().render()}var n=$("#introduce-popup");if(this.isEvaluationRequired()&&!(n.length&&n.is(":visible"))){this.evaluationMessageIsShow=true;chat_view_online.getEvaluationView().render()}},handleReset:function(e){var t=underscore.find(e.toJSON(),function(e){return e.type==="clientMessage"});this.$(".new-msg-container").remove();this.$lastMessage=this.$(".new-msg-container");e.each(function(e){e.set("history",true);this.renderMessage(e)},this);if(e.length&&this.isIntroduceRequired()&&t&&config.contacts_ask<=0){chat_view_online.getIntroducePopupView().render()}this.setScrollBottom(0);this.trigger("reset",this,e)},remove:function(e){},edit:function(e){},hideMessage:function(e,t){var i=this,n=this.getScrollBottom();function o(){$(this).remove();i.setScrollBottom(n)}if(t){e.each(o)}else{e.fadeOut("slow",o)}},declineFile:function(e){var t=$(e.currentTarget);e.preventDefault();if(t.attr("href")!=="#"){window.open(t.attr("href"));chat_view_online.fileReceive(t.attr("data-id"),t.attr("data-name"))}else{chat_view_online.fileDecline(t.attr("data-id"),t.attr("data-name"))}this.hideMessage(t.parents(".receiveFile"));chat_view_online.getChatView().inputFocus()},sendEmailInChat:function(e){var t=$(e.target);t.parent().removeClass("field-error");if(e.keyCode&&e.keyCode!=13){return}var i=t.parent().find("input").val();if(utils.isValidValue_email(i)){t.closest(".save-chat-email").addClass("emailSent");$(".save-chat-email p").html(translate("lblThanks")+"<br/>"+i);jivo.handle("gui_introduced",{email:i,isEmailSubmitted:true})}else{t.parent().addClass("field-error")}},openHighlight:function(e){var t=$(e.currentTarget);if(!t.attr("data-url"))t=t.find("a");chat_view_online.acceptCobrowse(t.attr("data-url"),t.attr("data-hash"));chat_view_online.getChatView().inputFocus();e.preventDefault()},hideInvitationMessage:function(){this.hideMessage(this.$(".agentMessage"),true);this.$lastMessage=null},hideConnectionError:function(){this.hideMessage(this.$(".connectionError"),true)}});Jivo.Online.Models.Name=Jivo.Model.Name.extend({required:function(){return this.show()&&config.contacts_settings[this.id].required}});Jivo.Online.Models.Message=Jivo.Model.Message.extend({defauts:{required:false},required:function(){return this.get("required")},show:function(){return this.get("required")}});Jivo.Online.Views.IntroduceForm=Jivo.View.Form.extend({el:"#jivosite-iframe-chat",tagName:"div",templateData:{nologo:!utils.showAd(),maxMessageLength:Jivo.Online.MAX_MESSAGE_LENGTH,link:translate("lblPwrBy").replace("_URL_","?utm_source="+encodeURIComponent(location.hostname)+"&utm_medium=link&utm_content=offline_form&utm_campaign=self_ad"),locale:getIconLocale()},validFields:["name","phone","email"]});Jivo.Online.Views.Introduce=Jivo.Online.Views.IntroduceForm.extend({template:_templates.online.introduceForm,previousStartedValue:false,events:{"click #submit":"submit","click #cancel":"cancel",'keydown #introduce-form input:text, #introduce-form input[type="tel"], #introduce-form input[type="email"], #introduce-form textarea':"onKeyDown","input  #message":"messageInput"},fields:new Backbone.Collection([new Jivo.Online.Models.Message({formId:"introduce-form"}),new Jivo.Model.Email({formId:"introduce-form"}),new Jivo.Model.Phone({formId:"introduce-form"}),new Jivo.Online.Models.Name({formId:"introduce-form"})]),render:function(e,t){var i=this.$("#introduce-form"),n,o,a;n=this.templateData;log(e,t);if(t){n.valueInputField=t;this.fields.get("message").set("required",true)}else{this.fields.get("message").set("required",e)}n.fields=this.fields;n.departments=e&&config.departments?config.departments:null;n.send=e?translate("lblSendBefore"):translate("lblSend");if(i.length>0&&this.previousStartedValue===e){i.show()}else{this.previousStartedValue=e;this.$("#introduce-form").remove();this.$el.append(this.template(n))}if(t||e){this.$("#message").show();this.$("#introduce-form").find(".buttons").addClass("single");if(e){this.$("#introduce-caption").hide();chat_view_online.getChatModel().set("agent.name",translate("lblIntroduceRequestBefore"))}}else{this.$("#message").hide();this.$("#introduce-form").find(".buttons").removeClass("single");this.$("#introduce-caption").show()}o=this.$("#introduce-avatar");o.removeClass("introduce-bg").css("height",0);if(jivo.isSeparateWindow()){document.documentElement.style.position="static"}else{var s=parseInt(jivo.gui.jivoframecontainer.getOnlineFormHeight(true));var r=this.$("#introduce-caption");var l=r.is(":visible")?r.outerHeight():0;var c=0;if(config.departments){c=e?0:-42}log("INTRODUCE_RENDER:",s,jivo.getChatHeight()-l-c);if(s<jivo.getChatHeight()-l-c){a=jivo.getChatHeight()-s-l-c;o.css("height",a);o.find("img").css({width:"auto",height:"100%"});log(a);if(a>30){o.addClass("introduce-bg")}else{o.css({height:13})}}if(utils.showAd()){this.$("#jivosite-adword").addClass("jivosite-adword-no-opacity")}setTimeout(function(){$("#introduce-form").find('input:text[value=""],input[type="tel"][value=""],input[type="email"][value=""],textarea:empty').first().focus()},0)}this.$("#introduce-form").find("input[placeholder], textarea[placeholder]").placeholder();this.$("#current-department").click(function(){$("#departments-list").toggle()});this.$("#departments-list>li").click(underscore.bind(this.onDepartmentSelect));if(utils.browser.msie&&utils.browser.mV<9){this.$("#message").on("keydown paste",underscore.bind(this.messageInput,this))}this.delegateEvents();log("introduce render update height");this.updateHeight(true);this.$("#introduce-form").css({top:utils.showAd()?100:70});chat_view_online.getChatView().disableDragging()},getHeight:function(){if(!jivo.isMobileOrTablet()){return parseInt(jivo.gui.jivoframecontainer.getOnlineFormHeight())}else{return $("#inner-chat").outerHeight()}},messageInput:function(e){setTimeout(underscore.bind(function(){var e=$(this).attr("maxlength");if($(this).val().length>e){$(this).val($(this).val().substring(0,e))}},e.currentTarget),0)},submit:function(){if(this.valid()){$("#jivo-chat").addClass("jivo-animate");if(!jivo.isMobileOrTablet()){jivo.gui.jivoframecontainer.setTransition(true)}var e={},t=this.validFields,i=true;underscore.each(t,function(t){var n=this.fields.get(t).value();if(n!==""){e[t]=n;i=false}},this);if(i&&config.contacts_ask<=0){this.close();return}chat_view_online.getChatModel().introduced=true;this.close();chat_view_online.getChatView().el.scrollTop=0;jivo.handle("gui_introduced",e);if(this.$("#current-department")){jivo.handle("gui_department",this.$("#current-department").attr("data-id"))}var n=chat_view_online.getChatModel().get("client");underscore.extend(n,e);var o=this.fields.get("message").value();if($.trim(o).length!==0){chat_view_online.setChatAttr("can_enter_phone",false);chat_view_online.sendMessage(o)}if(devicejs.ios()){chat_view_online.initSound()}chat_view_online.getChatView().inputFocus();if(!jivo.isMobileOrTablet()){jivo.gui.jivoframecontainer.setTransition(true)}}else{log("introduce form not valid");chat_view_online.getChatModel().introduced=false;if(!jivo.isMobileOrTablet()){jivo.gui.jivoframecontainer.setTransition(false)}$("#jivo-chat").removeClass("jivo-animate");this.updateHeight(true)}},cancel:function(e){this.close();e.preventDefault()},close:function(){this.$("#introduce-form").hide();this.collection.reset();chat_view_online.getChatView().enableDragging();if(chat_view_online.getChatModel().introduced&&!chat_view_online.getChatView().$el.find(".avatar").hasClass("connected")){chat_view_online.getChatView().updateCallMe()}if(jivo.isSeparateWindow()){document.documentElement.style.position="fixed"}else if(utils.showAd()){this.$("#jivosite-adword").removeClass("jivosite-adword-no-opacity")}this.undelegateEvents()},onDepartmentSelect:function(e){var t=$(e.currentTarget);$("#departments-list").hide();this.$("#current-department").html(t.html()).attr("data-id",t.attr("data-id"))}});Jivo.Online.Views.IntroducePopup=Jivo.Online.Views.IntroduceForm.extend({el:"#chat-body",template:_templates.online.introducePopup,popup:"#introduce-popup",popupContent:"#introduce-popup-content",events:{"click #submit":"submit","click #cancel":"cancel",'keydown #introduce-popup input:text, #introduce-popup input[type="tel"], #introduce-popup input[type="email"]':"onKeyDown","focus #introduce-popup input":"onInputFocus","blur #introduce-popup input":"onInputBlur"},fields:new Backbone.Collection([new Jivo.Model.Email({formId:"introduce-popup"}),new Jivo.Model.Phone({formId:"introduce-popup"}),new Jivo.Online.Models.Name({formId:"introduce-popup"})]),render:function(){var e;if($("#introduce-popup").length===0){e=this.templateData;e.fields=this.fields;e.send=translate("lblSend");this.$el.append(this.template(e));this.$("#introduce-popup").find("input[placeholder], textarea[placeholder]").placeholder();this.delegateEvents()}setTimeout(underscore.bind(function(){startPopupHeight="87px";if(jivo.isMobileOrTablet()){startPopupHeight="72px"}this.$("#introduce-popup").height(startPopupHeight)},this),3e3)},renderSpecific:function(e){this.onInputBlur(e,false)},cancel:function(e){e.preventDefault();this.close()},close:function(){this.$("#introduce-popup").fadeOut();chat_view_online.getChatView().enableDragging();this.undelegateEvents()},submit:function(e){if(e){e.target.focus()}if(this.valid()){var t={},i=this.validFields,n=true,o;underscore.each(i,function(e){var i=this.fields.get(e).value();if(i!==""){t[e]=i;n=false}},this);if(n&&config.contacts_ask<=0){this.close();return}this.$("#cancel, .text-field, .field-wrapper, .buttons").fadeOut();this.$(".icon-thx").fadeIn();this.$("#introduce-popup-content").addClass("thx-content");this.onInputBlurSpecific(e,true);setTimeout(underscore.bind(this.close,this),3e3);chat_view_online.getChatModel().introduced=true;jivo.handle("gui_introduced",t);var a=chat_view_online.getChatModel().get("client");underscore.extend(a,t);chat_view_online.getChatView().inputFocus()}},toggleError:function(e,t){if(t){this.$("#"+e).parent().addClass("error-field");this.$("#error-"+e).show()}else{this.$("#"+e).parent().removeClass("error-field");this.$("#error-"+e).hide()}},onInputFocus:function(){this.$("#introduce-popup").height(this.$("#introduce-popup-content").height())},onInputBlur:function(e,t){setTimeout(underscore.bind(this.onInputBlurSpecific,this),100)},onInputBlurSpecific:function(e,t){var i=0;if(t||!((this.$("input:text").length?this.$("input:text").val()!=="":false)||(this.$('input[type="tel"]').length?this.$('input[type="tel"]').val()!=="":false)||(this.$('input[type="email"]').length?this.$('input[type="email"]').val()!=="":false)||this.$('input[type="button"]').is(":focus")||this.$("input:text").is(":focus")||this.$('input[type="tel"]').is(":focus")||this.$('input[type="email"]').is(":focus"))){if(t){i=this.$(".icon-thx").outerHeight()}else{i="87px";if(jivo.isMobileOrTablet()){i="72px"}}this.$("#introduce-popup").height(i)}}});Jivo.Online.Views.Departments=Backbone.View.extend({el:"#inner-chat",tagName:"div",template:_templates.online.departments,templateData:{nologo:!utils.showAd()},events:{"click a.department":"onDepartmentSelect"},cacheAgentName:null,render:function(){var e=this.templateData;e.departments=config.departments;this.$el.append(this.template(this.templateData));this.cacheAgentName=chat_view_online.getChatModel().get("agent.name");chat_view_online.getChatModel().set("agent.name",translate("lblSelectDep"));this.$("#input-field").hide();this.fixSafariScroll()},close:function(e){log("Close department dialog");this.$("#input-field").show();this.$("#departments").remove();chat_view_online.getChatModel().set("agent.name",e?this.cacheAgentName:chat_view_online.getChatModel().get("agent.name"))},onDepartmentSelect:function(e){jivo.handle("gui_department",$(e.currentTarget).attr("data-id"));this.close(true);chat_view_online.chatMaximized();chat_view_online.getChatView().enableDragging()},fixSafariScroll:function(){this.$("#departments").mouseover(function(e){$(this).css("border","1px");$(this).css("border","none")})}});Jivo.Online.Views.ChatButton=Backbone.View.extend({el:"#inner-chat",tagName:"div",template:_templates.online.showChat,events:{"click #showchat":"showchat"},render:function(){this.$el.append(this.template)},show:function(){this.$("#showchat").show()},close:function(){this.$("#showchat").hide()},showchat:function(e){this.close();chat_view_online.getChatView().enableDragging();chat_view_online.getChatView().toolbarToggle("show");jivo.gui.jivoframecontaier.animate("expand")}});Jivo.Online.Views.Call=Backbone.View.extend({el:"#header-avatar",template:_templates.online.callButton,events:{"click #callme":"onCallClick"},initialize:function(){this.model.on("change:state",this.onStateChange,this);$("#phone_hint").html(translate("lblPhoneHint"))},render:function(){this.$el.append(this.template({}))},addMessage:function(e){chat_view_online.addSystemMessage(e)},micDisabled:function(){return this.model.get("state")==="WebPhoneMicDisabled"},idle:function(){return this.model.get("state")==="WebPhoneIdle"},connecting:function(){return this.model.get("state")==="WebPhoneConnecting"},progressing:function(){return this.model.get("state")==="WebPhoneProgressing"},joined:function(){return this.model.get("state")==="WebPhoneJoined"},authenticating:function(){return this.model.get("state")==="WebPhoneAuthenticating"},onStateChange:function(){if(this.model.calling()){$("#callme").addClass("hang-up");if(this.joined()){this.addMessage(translate("c_callConnected"))}else if(this.authenticating()){$("#web_phone").addClass("phone_hidden")}else if(this.connecting()){if(!this.model.rtcSupported()){$("#web_phone").removeClass("phone_hidden")}}else if(this.progressing()){$("#callme").show();$(".header-avatar-container").find(".title").css("width","75%")}}else{$("#callme").removeClass("hang-up");if(this.micDisabled()){$("#callme").hide()}else if(this.idle()){this.addMessage(translate("c_callDisconnected"))}chat_view_online.getCallModel().isInit=false}},onCallClick:function(e){log("onCallClick",jivo.state);var t=jivo.getCallWidget();if(t){if(jivo.state==="OFFLINE"){cookie("chat_call",false);if(t.state!=="CALL"){if(config.chat_mode==="online"){jivo.handle("cw_ping")}else{jivo.handle("gui_callwidget")}t.analyticsTitle="buttonClick"}else{chat_view_online.chatMinimized()}}else{chat_view_online.getCallBackView().toggleForm()}}else{if(this.model.calling()){this.model.hangup()}else{$("#callme").hide();this.addMessage(translate("c_callProcessing"));this.model.call()}}}});Jivo.Online.Models.Call=Backbone.Model.extend({isInit:false,defaults:{state:"WebPhoneUninitialized"},initialize:function(e){e.on("change:agent.vox_name",this.onVoxNameChange,this)},call:function(){this.getWebPhone().handle("call")},hangup:function(){this.getWebPhone().handle("hangup")},rtcSupported:function(){var e=false;if(!jivo.isMobileOrTablet()&&!(devicejs.chrome()&&document.location.protocol==="http:")){if(typeof webkitRTCPeerConnection!=="undefined"||typeof mozRTCPeerConnection!=="undefined"){if(typeof mozRTCPeerConnection!=="undefined"){try{e=true}catch(t){}}else{e=true}}}return e},getWebPhone:function(){if(this.webPhone===undefined){var e=["WebPhoneMicDisabled","WebPhoneInitializing","WebPhoneInitialized","WebPhoneConnecting","WebPhoneConnected","WebPhoneAuthenticating","WebPhoneIdle","WebPhoneProgressing","WebPhoneJoined"];this.webPhone=new WebPhone;for(var t in e){this.webPhone.on(e[t],underscore.bind(function(e){this.set("state",e.name)},this))}}return this.webPhone},onVoxNameChange:function(e){this.getWebPhone().setAgentId(e.changed["agent.vox_name"])},calling:function(){return underscore.contains(["WebPhoneInitializing","WebPhoneConnecting","WebPhoneAuthenticating","WebPhoneProgressing","WebPhoneJoined"],this.get("state"))}});Jivo.Online.Views.CallBack=Backbone.View.extend({el:"#inner-chat",template:_templates.callInChat,callForm:"#callme-form",callTabs:".call-tab",inputPhone:".call-tel",submitCall:"#callme-start-call",callTimer:false,events:{"click   #callme-start-call":"submit","click   .callme-close":"hideForm","focus   input.call-tel":"onInputFocus","blur    input.call-tel":"onInputBlur","keypress input.call-tel":"inputPhoneKeyPress","keyup input.call-tel":"inputPhoneKeyPress"},submit:function(){this.callTimer.setTimerNull();this.phone_number=this.phone.val();if(this.isValidPhone(this.phone_number)){cookie("chat_call",1);this.startCall(this.phone_number)}else{this.$el.find(this.submitCall).removeClass("can-call");this.$el.find(this.inputPhone).addClass("jivo-error")}},isValidPhone:function(e){e=e.replace(/\D/g,"");return e.length===10},inputPhoneKeyPress:function(e){if(this.isValidPhone(this.phone.val())){this.$el.find(this.submitCall).addClass("can-call");this.$el.find(this.inputPhone).removeClass("jivo-error");if(e.type=="keypress"&&(e.keycode==13||e.which==13)){this.submit()}}else{this.$el.find(this.submitCall).removeClass("can-call");this.$el.find(this.inputPhone).addClass("jivo-error")}},initPhone:function(){var e=this.phone=this.$el.find(this.inputPhone),t=cookie("phone");if(t){t=t.substring(2,12);e.val(t)}VMasker(e).maskPattern("999 999 9999");this.$el.find(this.inputPhone).removeClass("jivo-error")},initTimer:function(){this.callTimer=jivo.gui.callTimer;this.callTimer.callTimerText=this.$el.find(".callme-timer")[0];this.callTimer.seconds=config.callback_widget},startCall:function(e){var t=e.replace(/\D/g,"");cookie("phone","+7"+t);jivo.handle("cw_call",{tel:"+7"+t})},render:function(){if($(this.callForm).length===0){this.$el.append(this.template(this.templateData));this.initPhone();this.$el.find(".call-form").show();this.initTimer();
this.$el.find(".call-form").find(".jivo-text-time").text(this.callTimer.seconds);this.delegateEvents()}},showForm:function(){if(cookie("phone")&&this.$el.find(this.inputPhone).val()==""){var e=cookie("phone").replace(/\D+/g,"");if(e.length==11){e=e.substr(1,10)}this.$el.find(this.inputPhone).val(e)}this.$el.find(this.callForm).show()},hideForm:function(){this.$el.find(this.callForm).hide()},showClose:function(){this.$el.find(".callme-close").show()},hideClose:function(){this.$el.find(".callme-close").hide()},toggleForm:function(){var e=this.$el.find(this.callForm);if(e.is(":visible")){e.hide()}else{this.showForm();e.find(".call-tel").focus()}},showFormBox:function(){this.$el.find(this.callTabs).hide();this.$el.find(".call-form").show();this.showClose()},showPin:function(){$("#callme").show();this.$el.find(".pin").show()},hidePin:function(){this.$el.find(".pin").hide()},showWait:function(){this.showPin();this.$el.find(this.callTabs).hide();this.$el.find(".call-wait").show();this.$el.find(".call-wait").find(".callme-text").html(translate("cw_callAfter"));this.hideClose();this.callTimer.handle("start_timer")},showConnecting:function(){$("#callme").hide();this.hidePin();this.$el.find(this.callTabs).hide();this.$el.find(".call-connecting").show();this.$el.find(".call-connecting").find(".callme-text").html(translate("cw_connecting"));this.hideClose()},showError:function(e){log("cw_error reason",e);this.showPin();this.$el.find(this.callTabs).hide();this.$el.find(".call-form").show();this.$el.find(this.inputPhone).addClass("jivo-error");if(e){this.$el.find(this.callForm).find(".callme-text").html(translate(e))}else{this.$el.find(this.callForm).find(".callme-text").html(translate("cw_unableToConnect")+" "+translate("cw_errInfoText"))}},showCallEnd:function(){this.callTimer.setTimerNull();this.hideForm();this.showPin();this.showFormBox()},secOfNum:function(e){var t=[translate("cw_form_second"),translate("cw_form_seconds"),translate("cw_form_secondd")],i=[2,0,1,1,1,2];return t[e%100>4&&e%100<20?2:i[e%10<5?e%10:5]]},addMessage:function(e,t){chat_view_online.addCallMessage({message:e,type:t})}});var chat_view_online=Jivo.Online.Controller=new function(){var e,t,i,n,o,a,s,r,l,c,d,u;soundInited=false;underscore.defaults(config,{bubble_color:"green"});window.chat_view_online=this;this.getChatModel=function(){if(!e){e=new Jivo.Online.Models.Chat}return e};this.getMessagesCollection=function(){if(!t){t=new MessagesCollection}return t};this.getCallModel=function(){if(!i){i=new Jivo.Online.Models.Call(this.getChatModel())}return i};this.getChatView=function(){if(!o){o=new Jivo.Online.Views.Chat({model:this.getChatModel(),collection:this.getMessagesCollection()})}return o};this.getMessagesView=function(){if(!a){a=new Jivo.Online.Views.Message({collection:this.getMessagesCollection()})}return a};this.getIntroduceView=function(){if(!r){r=new Jivo.Online.Views.Introduce;r.undelegateEvents()}return r};this.getIntroducePopupView=function(){if(!l){l=new Jivo.Online.Views.IntroducePopup;l.undelegateEvents()}return l};this.getDepartmentsView=function(){if(!c){c=new Jivo.Online.Views.Departments}return c};this.getCallView=function(){if(!s){s=new Jivo.Online.Views.Call({model:this.getCallModel(),chatModel:this.getChatModel()})}return s};this.getCallBackView=function(){if(!d){d=new Jivo.Online.Views.CallBack({model:this.getCallModel(),chatModel:this.getChatModel()})}return d};this.getEvaluationView=function(){if(!n){n=new Jivo.Online.Views.Evaluation}return n};this.getChatButton=function(){if(!u){u=new Jivo.Online.Views.ChatButton}return u};var f=["addClientMessage","addAgentMessage","addSystemMessage","addSystemMessageEmail","addReceiveFile","addConnectionError","addCobrowseHighlight","addCallMessage"];underscore.each(f,function(e){this[e]=function(){return proxy(this.getMessagesCollection(),e,arguments)}},this);this.resetMessages=function(){return proxy(this.getMessagesCollection(),"reset",arguments)};var h=["hideConnectionError","hideInvitationMessage"];underscore.each(h,function(e){this[e]=function(){return proxy(this.getMessagesView(),e,arguments)}},this);this.setChatAttr=function(){return proxy(this.getChatModel(),"set",arguments)};this.getChatAttr=function(){return proxy(this.getChatModel(),"get",arguments)};this.create=function(e){this.getChatView().render();this.getMessagesView().render();this.getCallView().render();if(!jivo.isMobileOrTablet()){this.getCallBackView().render()}this.getChatButton().render()};this.sendMessage=function(e){if(e.length==0)return false;jivo.handle("gui_message",e)};this.onFocus=function(){jivo.handle("gui_msg_input_focus")};this.chatMinimized=function(){jivo.handle("gui_minimize")};this.chatMaximized=function(){this.onFocus();this.getChatView().inputFocus();this.getMessagesView().setScrollBottom(0)};this.typing=function(e){jivo.handle("gui_typing",e?1:0)};this.fileReceive=function(e,t){jivo.handle("gui_receive_file",e,t)};this.fileDecline=function(e,t){jivo.handle("gui_decline_file",e,t)};this.acceptCobrowse=function(e,t){jivo.handle("gui_accept_cobrowse",e,t)};this.getHeight=function(){return this.getChatModel().get("size.height")};this.initSound=function(){log("initSound for ios");if(!soundInited){jivo.soundPlayer.incomingMessage();jivo.soundPlayer.pause();soundInited=true}}};Jivo.Message.Models.Message=Backbone.Model.extend({defaults:{templateData:{link:translate("lblPwrBy").replace("_URL_","?utm_source="+encodeURIComponent(location.hostname)+"&utm_medium=link&utm_content=offline_form&utm_campaign=self_ad"),nologo:!utils.showAd(),locale:getIconLocale()},buttons:[],msg:translate("lblNoOperators"),header:translate("lblChatEnded")}});Jivo.Message.Views.Message=Backbone.View.extend({el:"#inner-chat",submited:false,tagName:"div",template:_templates.message.message,initialize:function(){},render:function(){this.$el.html(this.template(this.model.toJSON()));this.$el.addClass("offline");if($("jivo-chat")){$("jivo-chat").addClass("jivo-offline").removeClass("jivo-online")}var e=this.$el.find("#buttons"),t=this.model.get("buttons");underscore.each(t,function(t,i){e.append($("<input/>",{type:"button",value:t.title,"class":"jivoBtn accept"}).click(function(e){return function(){jivo.handle(e)}}(t.event)))});setTimeout($.proxy(function(){this.$el.find("#report-message-inner").css({top:(this.$el.find("#report-message").outerHeight()-this.$el.find("#report-message-inner").outerHeight())/2})},this),10);setTimeout(function(){$("#header-animate-container").addClass("header-animate")},0);if(jivo.isSeparateWindow()){$("#jivo_action #jivo_close_button").on("click",function(e){chat_view_offline.chatMinimized()})}return this}});var chat_view_msg=Jivo.Message.Controller=new function(){this.instance={models:{message:new Jivo.Message.Models.Message},views:{message:false}};this.create=function(e,t){this.instance.views.message=new Jivo.Message.Views.Message({model:this.instance.models.message});this.instance.views.message.render()};this._parent=function(e){if($(window.parent.document.getElementById(e)))return $(window.parent.document.getElementById(e));else return false}};var soundPlayer={_divId:"sound_player",_playOnReady:false,initialize:function(e){if(jivo.isMobileOrTablet()&&jivo.isSeparateWindow()){this.audio=document.getElementById(this._divId)}else{if(ie8||ie9){this.audio=document.createElement("embed");this.audio.setAttribute("src",staticUrl("/sounds/incoming_message.wav"));this.audio.setAttribute("autostart",false);this.audio.setAttribute("loop",false);this.audio.setAttribute("width",0);this.audio.setAttribute("height",0)}else{this.audio=document.createElement("audio")}this.audio.setAttribute("id",this._divId);e.appendChild(this.audio)}},incomingMessage:function(){if(jivo.isMobileOrTablet()&&jivo.isSeparateWindow()){this.audio=document.getElementById("jivo_sound_player")}if(!this._playOnReady&&!ie8&&!ie9&&!jivo.isSeparateWindow()){this.audio.innerHTML=_templates.sound_player({mp3:staticUrl("/sounds/incoming_message.mp3",true),ogg:staticUrl("/sounds/incoming_message.ogg",true),wav:staticUrl("/sounds/incoming_message.wav",true)});this._playOnReady=true}this.play()},pause:function(){if(typeof this.audio.pause!=="undefined"){this.audio.pause()}},play:function(){if(typeof this.audio.play!=="undefined"){this.audio.play()}}};var widgetContainer,widgetLoaded;if(jivo.isMobile()){widgetLoaded=function(){widgetContainer=document.getElementById("jivo_top_wrap");if(widgetContainer&&!hasClass(widgetContainer,"mobile-version")&&!jivo.ignore_viewport){addClass(widgetContainer,"mobile-version");document.getElementById("jivo-label").style["right"]="auto";document.getElementById("jivo-label").style["opacity"]=1;document.getElementById("jivo-label").style["width"]="auto";jivoMobileLabel()}else{setTimeout(widgetLoaded,100)}};widgetLoaded()}else if(jivo.isTablet()){widgetLoaded=function(){widgetContainer=document.getElementById("jivo_top_wrap");if(widgetContainer){addClass(widgetContainer,"tablet-version")}else{setTimeout(widgetLoaded,100)}};widgetLoaded()}function jivoMobileLabel(){var e=window.parent.window,t=window.parent.document;log("jivoMobileLabel");if(!t.querySelector("meta[name=viewport]")){var i=t.createElement("meta");i.id="viewport";i.name="viewport";i.content="width=device-width, height=device-height, initial-scale=0.33, maximum-scale=1.2";t.getElementsByTagName("head")[0].appendChild(i)}else{var n=t.querySelector("meta[name=viewport]").getAttribute("content").split(","),o,a=false;for(var s=0;s<n.length;s++){n[s]=n[s].replace(/^\s+/,"");var r=n[s].split("=");if(r[0]=="maximum-scale"){a=true;if(r[1]>1){r[1]="1.2"}}n[s]=r[0]+"="+r[1]}if(!a){n.push("maximum-scale=1.2")}o=n.join(", ");t.querySelector("meta[name=viewport]").setAttribute("content",o)}var l=document.getElementById("jivo-label"),c=t.getElementById("jivo-iframe-container"),d=290,u=500,f=t.documentElement.clientWidth,h=e.matchMedia,g,p,m,v=e.pageYOffset,_=e.pageXOffset,w,b=false;addClass(c,"jivo-c-mobile");function y(){var t=(f/d).toFixed(3);if(h&&h("(orientation: landscape)").matches||Math.abs(e.orientation)===90){t=(f/u).toFixed(3)}return t}function C(){return p>m/1.5}function j(){if(l){f=e.innerWidth||e.pageXOffset||t.documentElement.clientWidth;p=y();if(p!==0){if(p<1)p=1;if(C()){removeClass(c,"jivo-c-mobile-absolute");c.style["left"]="0";c.style["bottom"]="0";c.style["opacity"]=1}else{addClass(c,"jivo-c-mobile-absolute");g=Math.max(t.body.scrollHeight,t.documentElement.scrollHeight,t.body.offsetHeight,t.documentElement.offsetHeight,t.body.clientHeight,t.documentElement.clientHeight);c.style["left"]=e.pageXOffset/p+"px";if(g>e.pageYOffset+e.innerHeight){c.style["bottom"]=(t.documentElement.clientHeight-(e.pageYOffset+e.innerHeight))/p+"px"}}l.style["zoom"]=p;c.style["zoom"]=p}}}function x(){if(!C()){removeClass(c,"jivo-transition-opacity");c.style["opacity"]=0}}function E(){if(!C()&&!b&&c.style["opacity"]==="0"){addClass(c,"jivo-transition-opacity");c.style["opacity"]=1}}var k=(new Date).getTime();var T=(new Date).getTime();function I(){b=(e.pageYOffset!==v||e.pageXOffset!==_)&&w===p;if(!C()){if(b){k=(new Date).getTime();x()}else{T=(new Date).getTime();if(T-k>200){E()}}}v=e.pageYOffset;_=e.pageXOffset;w=p;setTimeout(I,1)}addListener(e,"resize",j);addListener(e,"scroll",j);addListener(e,"orientationchange",j);m=w=y();j();I()}